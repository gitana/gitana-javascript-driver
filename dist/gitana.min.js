!function(t){const n=t.Gitana;n.AbstractMap=n.AbstractPersistable.extend({constructor:function(t,e){this.__keys=function(){const t=[];return function(e){if(!n.isUndefined(e))if("empty"===e)for(;t.length>0;)t.shift();else if(!e&&e.length)for(let n=0;n<e.length;n++)t.push(e[n]);else t.push(e);return t}}(),this.__totalRows=function(){let t=null;return function(e){return n.isUndefined(e)||(t=e),t}}(),this.__size=function(){let t=null;return function(e){return n.isUndefined(e)||(t=e),t}}(),this.__offset=function(){let t=0;return function(e){return!n.isUndefined(e)&&e>=0&&(t=e),t}}(),this.base(t,e),e&&this.chainCopyState(e)},refs:function(){const t=[];for(let n=0;n<this.__keys().length;n++){const e=this[this.__keys()[n]];e.ref&&t.push(e.ref())}return t},chainCopyState:function(t){if(this.base(t),t.__keys){this.__keys("empty");for(let n=0;n<t.__keys().length;n++){const e=t.__keys()[n];this.__keys().push(e)}}t.__totalRows&&this.__totalRows(t.__totalRows()),t.__size&&this.__size(t.__size()),t.__offset&&this.__offset(t.__offset())},clear:function(){n.deleteProperties(this,!1),this.__keys("empty")},handleResponse:function(t){if(this.clear(),t)if(t.totalRows&&t.size&&t.offset?(this.__totalRows(t.totalRows()),this.__size(t.size()),this.__offset(t.offset())):(this.__totalRows(t.total_rows),this.__size(t.size),this.__offset(t.offset)),t.rows){if(n.isArray(t.rows))for(let n=0;n<t.rows.length;n++){const e=this.buildObject(t.rows[n]);this[e.getId()]=e,this.__keys().push(e.getId())}else for(let e in t.rows)if(t.rows.hasOwnProperty(e)&&!n.isFunction(t.rows[e])){const n=t.rows[e],i=this.buildObject(n);let o=i.getId&&i.getId();o||(o=e),this[o]=i,this.__keys().push(o)}this.__size(this.__keys().length)}else{for(let e in t)if(t.hasOwnProperty(e)&&!n.isFunction(t[e])){const n=t[e],i=this.buildObject(n);let o=i.getId&&i.getId();o||(o=e),this[o]=i,this[o]=i,this.__keys().push(o)}this.__size(this.__keys().length)}},buildObject:function(t){},get:function(t){return this[t]},asArray:function(){const t=[];for(let n=0;n<this.__keys().length;n++){const e=this.__keys()[n];t.push(this[e])}return t},size:function(t){return t?this.then(function(){t.call(this,this.__size())}):this.__size()},offset:function(t){return t?this.then(function(){t.call(this,this.__offset())}):this.__offset()},totalRows:function(t){return t?this.then(function(){t.call(this,this.__totalRows())}):this.__totalRows()},each:function(t){return this.then(function(){for(let e=0;e<this.__keys().length;e++){const i=this.__keys()[e],o=this[i],s=function(t,e,i,o){return function(){t.call(this,e,this,i),n.deleteProperties(o[e]),n.copyInto(o[e],this)}}(t,i,e,this);this.subchain(o).then(s)}return this})},eachX:function(t){return this.then(function(){const n=[];for(let e=0;e<this.__keys().length;e++){const i=this.__keys()[e],o=this[i],s=function(t,n,e,i){return function(){this.subchain(e).then(function(){t.call(this,n,this,i)})}}(t,i,o,e);n.push(s)}return this.then(n)})},filter:function(t){return this.then(function(){const n=[],e=[];for(let i=0;i<this.__keys().length;i++){const o=this.__keys()[i],s=this[o];t.call(s)?n.push(o):e.push(o)}for(let t=0;t<e.length;t++)delete this[e[t]];this.__keys("empty");for(let t=0;t<n.length;t++)this.__keys().push(n[t])})},sort:function(t){return this.then(function(){const n=[];for(let t=0;t<this.__keys().length;t++){const e=this.__keys()[t];n.push(this[e])}n.sort(t),this.__keys("empty");for(let t=0;t<n.length;t++)this.__keys().push(n[t].getId())})},limit:function(t){return this.then(function(){const n=[];if(!(t>this.__keys().length)){for(let e=0;e<this.__keys().length;e++)e>=t&&n.push(this.__keys()[e]);for(;this.__keys().length>t;)this.__keys().pop();for(let t=0;t<n.length;t++)delete this[n[t]];this.__size(this.__keys().length)}})},paginate:function(t){return this.then(function(){const n=t.skip,e=t.limit,i=[];for(let t=0;t<this.__keys().length;t++)(t<n||t>=n+e)&&i.push(this.__keys()[t]);for(;this.__keys().length>e+n;)this.__keys().pop();for(let t=0;t<i.length;t++)delete this[i[t]];this.__size(this.__keys().length)})},count:function(t){return t?this.then(function(){t.call(this,this.__keys().length)}):this.__keys().length},keepOne:function(t){const e=this;let i={};this.__keys().length>0&&(i=this[this.__keys()[0]]);const o=this.buildObject(i);return this.subchain(o).then(function(){const i=this;this.subchain(e).then(function(){if(!(this.__keys().length>0)){const i=new n.Error;return i.name="Empty Map",i.message="The map doesn't have any elements in it",t?t.call(e,i):this.error(i),!1}{const t=this[this.__keys()[0]];i.loadFrom?i.loadFrom(t):i.handleResponse(t)}})})},select:function(t){const e=this;let i={};this[t]&&(i=this[t]);const o=this.subchain(this.buildObject(i));return o.then(function(){const i=this;this.subchain(e).then(function(){const e=this[t];if(!e){const e=new n.Error;return e.name="No element with key: "+t,e.message=e.name,this.error(e),!1}o.loadFrom?i.loadFrom(e):i.handleResponse(e)})})}})}(window),function(t){const n=t.Gitana;n.AbstractObject=n.AbstractPersistable.extend({constructor:function(t,e){this.__system=function(){const t=new n.SystemMetadata;return function(e){return n.isUndefined(e)||t.updateFrom(e),t}}(),this.chainDelete=function(t,e,i){const o=this;return this.subchain(t).then(function(){const t=this;return n.isFunction(e)&&(e=e.call(o)),t.getDriver().gitanaDelete(e,i,function(){t.next()},function(t){o.httpError(t)}),!1})},this.chainReload=function(t,e,i){const o=this;return this.subchain(t).then(function(){const t=this;return n.isFunction(e)&&(e=e.call(o)),t.getDriver().gitanaGet(e,i,{},function(n){t.handleResponse(n),t.next()},function(t){o.httpError(t)}),!1})},this.chainUpdate=function(t,e,i){const o=this;return this.subchain(t).then(function(){const t=this;return n.isFunction(e)&&(e=e.call(o)),t.getDriver().gitanaPut(e,i,t,function(){t.getDriver().gitanaGet(e,i,{},function(n){t.handleResponse(n),t.next()},function(t){o.httpError(t)})},function(t){o.httpError(t)}),!1})},this.chainPatch=function(e,i,o,s){const r=this;return this.subchain(e).then(function(){const e=this;return n.isFunction(i)&&(i=i.call(r)),t.gitanaPatch(i,o,s,function(t){e.handleResponse(t),e.next()},function(t){r.httpError(t)}),!1})},this.base(t,e)},chainCopyState:function(t){this.base(t),t.__system&&this.__system(t.__system())},getUri:function(){return null},getType:function(){return null},ref:function(){return null},getProxiedUri:function(){return this.getDriver().baseURL+this.getUri()},get:function(t){return this[t]},set:function(t,n){this[t]=n},getId:function(){return this.get("_doc")},getSystemMetadata:function(){return this.__system()},getTitle:function(){return this.get("title")},getDescription:function(){return this.get("description")},replacePropertiesWith:function(t){const e={};n.copyInto(e,t);const i={};i._doc=this._doc,delete e._doc,i._type=this._type,delete e._type,i._qname=this._qname,delete e._qname,n.deleteProperties(this,!1),this._doc=i._doc,this._type=i._type,this._qname=i._qname,n.copyInto(this,e)},handleSystemProperties:function(t){if(this.base(t),this._system){const t=this._system;delete this._system,this.__system().updateFrom(t)}},stringify:function(t){return n.stringify(this,t)},loadFrom:function(t){this.handleResponse(t)}})}(window),function(t){const n=t.Gitana;n.AbstractPersistable=n.Chainable.extend({constructor:function(t,n){this.base(t),n&&this.handleResponse.call(this,n)},handleResponse:function(t){n.deleteProperties(this,!1),t._ref&&delete t._ref,n.copyInto(this,t),this.handleSystemProperties(t)},handleSystemProperties:function(t){this.chainCopyState(t)},json:function(){return JSON.parse(JSON.stringify(this))}})}(window),function(t){const n=t.Gitana;n.AbstractSelfableACLObject=n.AbstractSelfableObject.extend({constructor:function(t,n){this.base(t,n)},loadACL:function(t){const n=this;return this.chainGetResponse(this,function(){return n.getUri()+"/acl/list"}).then(function(n){t.call(this,n)})},listAuthorities:function(t,n){const e=this.extractPrincipalDomainQualifiedId(t),i=this;return this.chainGetResponseRows(this,function(){return i.getUri()+"/acl?id="+e}).then(function(t){n.call(this,t)})},checkAuthority:function(t,n,e){const i=this.extractPrincipalDomainQualifiedId(t),o=this;return this.chainPostResponse(this,function(){return o.getUri()+"/authorities/"+n+"/check?id="+i}).then(function(t){e.call(this,t.check)})},grantAuthority:function(t,n){const e=this.extractPrincipalDomainQualifiedId(t),i=this;return this.chainPostEmpty(null,function(){return i.getUri()+"/authorities/"+n+"/grant?id="+e})},revokeAuthority:function(t,n){const e=this.extractPrincipalDomainQualifiedId(t),i=this;return this.chainPostEmpty(null,function(){return i.getUri()+"/authorities/"+n+"/revoke?id="+e})},revokeAllAuthorities:function(t){return this.revokeAuthority(t,"all")},loadAuthorityGrants:function(t,n){t||(t=[]);const e={principals:t};return this.chainPostResponse(this,this.getUri()+"/authorities",{},e).then(function(t){n.call(this,t)})},checkPermission:function(t,n,e){const i=this.extractPrincipalDomainQualifiedId(t);return this.chainPostResponse(this,function(){return self.getUri()+"/permissions/"+n+"/check?id="+i}).then(function(t){e.call(this,t.check)})}})}(window),function(t){const n=t.Gitana;n.AbstractSelfableObject=n.AbstractObject.extend({constructor:function(t,n){this.base(t,n)},del:function(){const t=this;return this.chainDelete(this.getPlatform(),function(){return t.getUri()})},reload:function(){const t=this;return this.chainReload(null,function(){return t.getUri()})},update:function(){const t=this;return this.chainUpdate(null,function(){return t.getUri()})}})}(window),function(t){const n=t.Gitana;n.Activity=n.AbstractObject.extend({constructor:function(t,n){this.base(t.getDriver(),n),this.objectType=function(){return"Gitana.Activity"},this.getDataStore=function(){return t}},getUri:function(){return this.getDataStore().getUri()+"/activities/"+this.getId()},clone:function(){return new n.Activity(this.getDataStore(),this)},del:function(){return this.chainDelete(this.getDataStore(),function(){return this.getUri()})},reload:function(){return this.chainReload(null,function(){return this.getUri()})},update:function(){return this.chainUpdate(null,function(){return this.getUri()})},getType:function(){return this.get("type")},getTimestamp:function(){return this.get("timestamp")},getUserDomainId:function(){return this.get("userDomainId")},getUserId:function(){return this.get("userId")},getUserTitle:function(){return this.get("userTitle")},getUserEmail:function(){return this.get("userEmail")},getUserName:function(){return this.get("userName")},getObjectDataStoreTypeId:function(){return this.get("objectDatastoreTypeId")},getObjectDataStoreId:function(){return this.get("objectDatastoreId")},getObjectDataStoreTitle:function(){return this.get("objectDatastoreTitle")},getObjectTypeId:function(){return this.get("objectTypeId")},getObjectId:function(){return this.get("objectId")},getObjectTitle:function(){return this.get("objectTitle")},getOtherDataStoreTypeId:function(){return this.get("otherDatastoreTypeId")},getOtherDataStoreId:function(){return this.get("otherDatastoreId")},getOtherDataStoreTitle:function(){return this.get("otherDatastoreTitle")},getOtherTypeId:function(){return this.get("otherTypeId")},getOtherId:function(){return this.get("otherId")},getOtherTitle:function(){return this.get("otherTitle")}})}(window),function(t){const n=t.Gitana;n.ActivityMap=n.AbstractMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.ActivityMap"},this.getDataStore=function(){return t},this.base(t.getDriver(),n)},clone:function(){return this.getFactory().activityMap(this.getDataStore(),this)},buildObject:function(t){return this.getFactory().activity(this.getDataStore(),t)}})}(window),function(t){const n=t.Gitana;n.AppHelper=n.AbstractObject.extend({constructor:function(t,e){this.objectType=function(){return"Gitana.AppHelper"},this.base(t.getDriver()),this.getPlatform=function(){return t},this.getPlatformId=function(){return t.getId()},this.getApplicationId=function(){return e.application},this.cache=n.MemoryCache(),this.chainedCacheItem=function(t){let n=null;return this.cache(t)&&(n=Chain(this.cache(t))),n}},init:function(t){const e=this,i=function(n){const i=n.projectId;i?Chain(e.getPlatform()).trap(function(){t()}).readProject(i).then(function(){e.cache("project",this),t()}):t()};Chain(e.getPlatform()).trap(function(n){t(n)}).readApplication(e.getApplicationId()).then(function(){e.cache("application",this);const t=this;this.subchain(e.getPlatform()).trap(function(){i(t)}).findStackForDataStore(n.TypedIDConstants.TYPE_APPLICATION,e.getApplicationId()).then(function(){e.cache("stack",this),this.listDataStores().each(function(t){this._doc=this.datastoreId,delete this.datastoreTypeId,e.cache("stack.datastore."+t,this)}),this.then(function(){i(t)})})})},platform:function(){return Chain(this.getPlatform())},application:function(){return this.chainedCacheItem("application")},stack:function(){return this.chainedCacheItem("stack")},datastore:function(t){return this.chainedCacheItem("stack.datastore."+t)},project:function(){return this.chainedCacheItem("project")}})}(window),function(t){const n=t.Gitana;n.AbstractApplicationObject=n.AbstractPlatformObject.extend({constructor:function(t,n){this.base(t.getPlatform(),n),this.getApplication=function(){return t},this.getApplicationId=function(){return t.getId()}},ref:function(){return this.getType()+"://"+this.getPlatformId()+"/"+this.getApplicationId()+"/"+this.getId()}})}(window),function(t){const n=t.Gitana;n.Application=n.AbstractPlatformDataStore.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.Application"},this.base(t,n)},getUri:function(){return"/applications/"+this.getId()},getType:function(){return n.TypedIDConstants.TYPE_APPLICATION},clone:function(){return this.getFactory().application(this.getPlatform(),this)},listAutoClientMappingObjects:function(t,e){const i=this,o={};return e&&n.copyInto(o,e),this.chainGetResponse(this,function(){return i.getUri()+"/autoclientmappings"},o).then(function(n){t.call(this,n.rows)})},listTrustedDomainMappingObjects:function(t,e){const i=this,o={};return e&&n.copyInto(o,e),this.chainGetResponse(this,function(){return i.getUri()+"/trusteddomainmappings"},o).then(function(n){t.call(this,n.rows)})},createSettings:function(t){const n=this;null==t.settings&&(t.settings={});const e=this.getFactory().settings(this);return this.chainCreate(e,t,function(){return n.getUri()+"/settings"})},listSettings:function(t){const e=this,i={};t&&n.copyInto(i,t);const o=this.getFactory().settingsMap(this);return this.chainGet(o,function(){return e.getUri()+"/settings"},i)},readSettings:function(t){const n=this,e=this.getFactory().settings(this);return this.chainGet(e,function(){return n.getUri()+"/settings/"+t})},querySettings:function(t,e){const i=this,o={};e&&n.copyInto(o,e);const s=this.getFactory().settingsMap(this);return this.chainPost(s,function(){return i.getUri()+"/settings/query"},o,t)},readApplicationSettings:function(t,e){const i=this;null==t&&(t="application"),null==e&&(e="application");const o={scope:t,key:e};return this.subchain(new n.Settings(this,o)).then(function(){const t=this,e=i.getDriver(),s=i.getUri()+"/settings",r=i.getUri()+"/settings/query";return e.gitanaPost(r,{},o,function(r){const c=new n.SettingsMap(i);if(c.handleResponse(r),c.__keys().length>0){const n=c[c.__keys()[0]];t.loadFrom(n),t.next()}else o.settings={},e.gitanaPost(s,null,o,function(n){e.gitanaGet(s+"/"+n.getId(),null,{},function(n){t.handleResponse(n),t.next()},function(t){i.httpError(t)})},function(t){i.httpError(t)})},function(t){i.httpError(t)}),!1})},readApplicationPrincipalSettings:function(){const t=n.makeArray(arguments);if(1===t.length){const n=t.shift();return this.readApplicationSettings("principal",n.getDomainQualifiedId())}if(2===t.length){const n=t.shift(),e=t.shift();return this.readApplicationSettings("principal",n+"/"+e)}},checkSettingPermissions:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/settings/permissions/check"},{},i).then(function(t){n.call(this,t.results)})},checkSettingAuthorities:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/settings/authorities/check"},{},i).then(function(t){n.call(this,t.results)})},createRegistration:function(t){const n=this,e=this.getFactory().registration(this);return this.chainCreate(e,t,function(){return n.getUri()+"/registrations"})},listRegistrations:function(t){const e=this,i={};t&&n.copyInto(i,t);const o=this.getFactory().registrationMap(this);return this.chainGet(o,function(){return e.getUri()+"/registrations"},i)},readRegistration:function(t){const n=this,e=this.getFactory().registration(this);return this.chainGet(e,function(){return n.getUri()+"/registrations/"+t})},queryRegistrations:function(t,e){const i=this,o={};e&&n.copyInto(o,e);const s=this.getFactory().registrationMap(this);return this.chainPost(s,function(){return i.getUri()+"/registrations/query"},o,t)},checkRegistrationPermissions:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/registrations/permissions/check"},{},i).then(function(t){n.call(this,t.results)})},checkRegistrationAuthorities:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/registrations/authorities/check"},{},i).then(function(t){n.call(this,t.results)})},createPageRendition:function(t,n){const e=this,i=this.getFactory().pageRendition(this,t);return this.chainCreate(i,n,function(){return e.getUri()+"/deployments/"+t+"/pagerenditions"})},listPageRenditions:function(t,e){const i=this,o={};e&&n.copyInto(o,e);const s=this.getFactory().pageRenditionMap(this,t);return this.chainGet(s,function(){return i.getUri()+"/deployments/"+t+"/pagerenditions"},o)},readPageRendition:function(t,n){const e=this,i=this.getFactory().pageRendition(this,t);return this.chainGet(i,function(){return e.getUri()+"/deployments/"+t+"/pagerenditions/"+n})},queryPageRenditions:function(t,e,i){const o=this,s={};i&&n.copyInto(s,i);const r=this.getFactory().pageRenditionMap(this,t);return this.chainPost(r,function(){return o.getUri()+"/deployments/"+t+"/pagerenditions/query"},s,e)},checkPageRenditionPermissions:function(t,n,e){const i=this,o={checks:n};return this.chainPostResponse(this,function(){return i.getUri()+"/deployments/"+t+"/pagerenditions/permissions/check"},{},o).then(function(t){e.call(this,t.results)})},checkPageRenditionAuthorities:function(t,n,e){const i=this,o={checks:n};return this.chainPostResponse(this,function(){return i.getUri()+"/deployments/"+t+"/pagerenditions/authorities/check"},{},o).then(function(t){e.call(this,t.results)})},createEmailProvider:function(t){const n=this,e=this.getFactory().emailProvider(this);return this.chainCreate(e,t,function(){return n.getUri()+"/emailproviders"})},listEmailProviders:function(t){const e=this,i={};t&&n.copyInto(i,t);const o=this.getFactory().emailProviderMap(this);return this.chainGet(o,function(){return e.getUri()+"/emailproviders"},i)},readEmailProvider:function(t){const n=this,e=this.getFactory().emailProvider(this);return this.chainGet(e,function(){return n.getUri()+"/emailproviders/"+t})},queryEmailProviders:function(t,e){const i=this,o={};e&&n.copyInto(o,e);const s=this.getFactory().emailProviderMap(this);return this.chainPost(s,function(){return i.getUri()+"/emailproviders/query"},o,t)},checkEmailProviderPermissions:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/emailproviders/permissions/check"},{},i).then(function(t){n.call(this,t.results)})},checkEmailProviderAuthorities:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/emailproviders/authorities/check"},{},i).then(function(t){n.call(this,t.results)})},createEmail:function(t){const n=this,e=this.getFactory().email(this);return this.chainCreate(e,t,function(){return n.getUri()+"/emails"})},listEmails:function(t){const e=this,i={};t&&n.copyInto(i,t);const o=this.getFactory().emailMap(this);return this.chainGet(o,function(){return e.getUri()+"/emails"},i)},readEmail:function(t){const n=this,e=this.getFactory().email(this);return this.chainGet(e,function(){return n.getUri()+"/emails/"+t})},queryEmails:function(t,e){const i=this,o={};e&&n.copyInto(o,e);const s=this.getFactory().emailMap(this);return this.chainPost(s,function(){return i.getUri()+"/emails/query"},o,t)},checkEmailPermissions:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/emails/permissions/check"},{},i).then(function(t){n.call(this,t.results)})},checkEmailAuthorities:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/emails/authorities/check"},{},i).then(function(t){n.call(this,t.results)})},deploy:function(t){const e=this,i=new n.WebHost(this.getPlatform()),o=this.getFactory().deployedApplication(i);return this.chainPost(o,function(){return e.getUri()+"/deploy/"+t}).then(function(){const n=e.deployments[t].webhost;this.subchain(this.getPlatform()).readWebHost(n).then(function(){i.loadFrom(this)})})},undeploy:function(t){const n=this;return this.chainPost(this,function(){return n.getUri()+"/undeploy/"+t})},findDeployedApplication:function(t){const e=this,i=new n.WebHost(this.getPlatform()),o=this.getFactory().deployedApplication(i);return this.chainGet(o,function(){return e.getUri()+"/deployed/"+t}).then(function(){const n=e.deployments[t].webhost;this.subchain(this.getPlatform()).readWebHost(n).then(function(){i.loadFrom(this)})})},loadDeploymentInfo:function(t,n){const e=this;return this.chainGetResponse(this,function(){return e.getUri()+"/deployed/"+t+"/info"},{}).then(function(t){n(t.info)})},refreshDeploymentKeys:function(t){const n=this;return this.then(function(){const e=this,i=n.getUri()+"/deployments/"+t+"/refreshkeys";return n.getDriver().gitanaPost(i,null,{},function(){e.next()}),!1})},invalidateAllPageRenditions:function(t){const n=this;return this.chainPostEmpty(this,function(){return n.getUri()+"/deployments/"+t+"/pagerenditions/invalidateall"})},createMessage:function(t){const n=this,e=this.getFactory().message(this);return this.chainCreate(e,t,function(){return n.getUri()+"/messages"})},listMessages:function(t){const e=this,i={};t&&n.copyInto(i,t);const o=this.getFactory().messageMap(this);return this.chainGet(o,function(){return e.getUri()+"/messages"},i)},readMessage:function(t){const n=this,e=this.getFactory().message(this);return this.chainGet(e,function(){return n.getUri()+"/messages/"+t})},queryMessages:function(t,e){const i=this,o={};e&&n.copyInto(o,e);const s=this.getFactory().messageMap(this);return this.chainPost(s,function(){return i.getUri()+"/messages/query"},o,t)},checkMessagePermissions:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/messages/permissions/check"},{},i).then(function(t){n.call(this,t.results)})},checkMessageAuthorities:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/messages/authorities/check"},{},i).then(function(t){n.call(this,t.results)})}})}(window),function(t){const n=t.Gitana;n.ApplicationMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.ApplicationMap"},this.base(t,n)},clone:function(){return this.getFactory().applicationMap(this.getPlatform(),this)},buildObject:function(t){return this.getFactory().application(this.getPlatform(),t)}})}(window),function(t){const n=t.Gitana;n.Email=n.AbstractApplicationObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.Email"}},clone:function(){return new n.Email(this.getApplication(),this)},getType:function(){return n.TypedIDConstants.TYPE_EMAIL},getUri:function(){return"/applications/"+this.getApplicationId()+"/emails/"+this.getId()},send:function(t){return this.then(function(){this.subchain(t).send(this)})}})}(window),function(t){const n=t.Gitana;n.EmailMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.EmailMap"},this.getApplication=function(){return t},this.getApplicationId=function(){return t.getId()},this.base(t.getPlatform(),n)},clone:function(){return this.getFactory().emailMap(this.getApplication(),this)},buildObject:function(t){return this.getFactory().email(this.getApplication(),t)}})}(window),function(t){const n=t.Gitana;n.EmailProvider=n.AbstractApplicationObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.EmailProvider"}},clone:function(){return new n.EmailProvider(this.getApplication(),this)},getType:function(){return n.TypedIDConstants.TYPE_EMAIL_PROVIDER},getUri:function(){return"/applications/"+this.getApplicationId()+"/emailproviders/"+this.getId()},send:function(t,e){const i=this;e||(e={});let o=null;return o=n.isString(t)?t:t.getId(),this.chainPostEmpty(null,function(){return i.getUri()+"/send?email="+o},{},e)},test:function(t,n){const e=this;return this.chainPostEmpty(null,function(){return e.getUri()+"/test?from="+t+"&to="+n})},sendForExport:function(t,n,e){const i={applicationId:this.getApplicationId(),emailProviderId:this.getId(),email:n};return this.chainPostResponse(this,function(){return"/ref/exports/"+t+"/email"},{},i).then(function(t){e(t)})}})}(window),function(t){const n=t.Gitana;n.EmailProviderMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.EmailProviderMap"},this.getApplication=function(){return t},this.getApplicationId=function(){return t.getId()},this.base(t.getPlatform(),n)},clone:function(){return this.getFactory().emailProviderMap(this.getApplication(),this)},buildObject:function(t){return this.getFactory().emailProvider(this.getApplication(),t)}})}(window),function(t){const n=t.Gitana;n.Message=n.AbstractApplicationObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.Message"}},clone:function(){return new n.Message(this.getApplication(),this)},getType:function(){return n.TypedIDConstants.TYPE_MESSAGE},getUri:function(){return"/applications/"+this.getApplicationId()+"/messages/"+this.getId()}})}(window),function(t){const n=t.Gitana;n.MessageMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.MessageMap"},this.getApplication=function(){return t},this.getApplicationId=function(){return t.getId()},this.base(t.getPlatform(),n)},clone:function(){return this.getFactory().messageMap(this.getApplication(),this)},buildObject:function(t){return this.getFactory().message(this.getApplication(),t)}})}(window),function(t){const n=t.Gitana;n.PageRendition=n.AbstractApplicationObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.PageRendition"}},clone:function(){return new n.PageRendition(this.getApplication(),this)},getType:function(){return n.TypedIDConstants.TYPE_PAGE_RENDITION},getUri:function(){return"/applications/"+this.getApplicationId()+"/deployments/"+this.deploymentKey+"/pagerenditions/"+this.key},invalidate:function(){const t=this;return this.chainPostEmpty(this,function(){return t.getUri()+"/invalidate"})}})}(window),function(t){const n=t.Gitana;n.PageRenditionMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.PageRenditionMap"},this.getApplication=function(){return t},this.getApplicationId=function(){return t.getId()},this.base(t.getPlatform(),n)},clone:function(){return this.getFactory().pageRenditionMap(this.getApplication(),this)},buildObject:function(t){return this.getFactory().pageRendition(this.getApplication(),t)}})}(window),function(t){const n=t.Gitana;n.Registration=n.AbstractApplicationObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.Registration"}},clone:function(){return new n.Registration(this.getApplication(),this)},getType:function(){return n.TypedIDConstants.TYPE_REGISTRATION},getUri:function(){return"/applications/"+this.getApplicationId()+"/registrations/"+this.getId()},sendConfirmationEmail:function(){const t=this;return this.chainPostEmpty(this,function(){return t.getUri()+"/send/confirmation"},{},this)},sendWelcomeEmail:function(){const t=this;return this.chainPostEmpty(this,function(){return t.getUri()+"/send/welcome"},{},this)},confirm:function(t,n){n||(n={});const e={password:t},i=this;return this.chainPostEmpty(this,function(){return i.getUri()+"/confirm"},e,n)}})}(window),function(t){const n=t.Gitana;n.RegistrationMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.RegistrationMap"},this.getApplication=function(){return t},this.getApplicationId=function(){return t.getId()},this.base(t.getPlatform(),n)},clone:function(){return this.getFactory().registrationMap(this.getApplication(),this)},buildObject:function(t){return this.getFactory().registration(this.getApplication(),t)}})}(window),function(t){const n=t.Gitana;n.Settings=n.AbstractApplicationObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.Settings"}},clone:function(){return new n.Settings(this.getApplication(),this)},getType:function(){return n.TypedIDConstants.TYPE_SETTINGS},getUri:function(){return"/applications/"+this.getApplicationId()+"/settings/"+this.getId()},getSettings:function(){return this.settings},getSetting:function(t){return this.getSettings()?this.getSettings()[t]:null},setSetting:function(t,n){this.getSettings()||(this.settings={}),this.settings[t]=n},listAttachments:n.Methods.listAttachments(),attachment:function(t){return this.listAttachments().select(t)},attach:n.Methods.attach(),unattach:n.Methods.unattach(),getPreviewUri:n.Methods.getPreviewUri()})}(window),function(t){const n=t.Gitana;n.SettingsMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.SettingsMap"},this.getApplication=function(){return t},this.getApplicationId=function(){return t.getId()},this.base(t.getPlatform(),n)},clone:function(){return this.getFactory().settingsMap(this.getApplication(),this)},buildObject:function(t){return this.getFactory().settings(this.getApplication(),t)}})}(window),function(t){const n=t.Gitana,e=function(t,n){for(let e=0;e<n.length;e++){const o=n[e];i(t,o)}},i=function(t,n){setTimeout(n.bind(null,t),0)},o=function(){this.promise=new n.Promise(this),this.status="unresolved",this.successCallbacks=[],this.errorCallbacks=[],this.resolve=function(t){this.isUnresolved()&&(this.status="resolved",this.val=t,e(t,this.successCallbacks),delete this.successCallbacks,delete this.errorCallbacks)}.bind(this),this.reject=function(t){this.isUnresolved()&&(this.status="rejected",this.val=t,e(t,this.errorCallbacks),delete this.successCallbacks,delete this.errorCallbacks)}.bind(this)};o.prototype.push=function(t,n){this.isUnresolved()?("function"==typeof t&&this.successCallbacks.push(t),"function"==typeof n&&this.errorCallbacks.push(n)):this.isResolved()?i(this.val,t):this.isRejected()&&i(this.val,n)},o.prototype.isUnresolved=function(){return"unresolved"===this.status},o.prototype.isResolved=function(){return"resolved"===this.status},o.prototype.isRejected=function(){return"rejected"===this.status},o.all=function(t){if(void 0===t)return n.Promise.resolved();n.isArray(t)||(t=arguments);const e=new o;let i=t.length;const s=[];for(let n=0;n<t.length;n++){const o=t[n];!function(t){o.then(function(n){i--,s[t]=n,i<=0&&e.resolve(s)},e.reject)}(n)}return e.promise},n.Defer=o}(window),function(t){const n=t.Gitana,e=function(t,n){this.push(t,n)},i=function(t){this.then=e.bind(t),this.success=function(t){e.call(this,t)}.bind(t),this.fail=function(t){e.call(this,void 0,t)}.bind(t),this.complete=function(t){e.call(this,t,t)}.bind(t),this.status=function(){return t.status}};i.resolved=function(t){const e=new n.Defer;return e.resolve(t),e.promise},n.Promise=i}(window),function(t){const n=t.Gitana,e=function(t){this.concurrency=t||1,this.work=[]};e.prototype.add=function(t){this.work.push(t)},e.prototype.go=function(){const t=new n.Defer,e=function(t,n){const e=[];for(let i=0;i<t.length;i+=n)e.push(t.slice(i,i+n));return e}(this.work,this.concurrency),i=[];return function o(s){s.then(function(s){if(i.push.apply(i,s),e.length>0){const t=e.shift(),i=[];for(let n=t.length-1;n>=0;n--){const e=(0,t[n])();i.push(e)}o(n.Defer.all(i))}else t.resolve(i)},t.reject)}(n.Promise.resolved([])),t.promise},n.Queue=e}(window),function(t){const n=t.Gitana;n.AuthInfo=Base.extend({constructor:function(t){n.copyInto(this,t)},getPrincipalId:function(){return this.principalId},getPrincipalDomainId:function(){return this.principalDomainId},getPrincipalName:function(){return this.principalName},getTenantId:function(){return this.tenantId},getTenantTitle:function(){return this.tenantTitle},getTenantDescription:function(){return this.tenantDescription},getClientId:function(){return this.clientId},getTicket:function(){return this.ticket}})}(window),function(t){const n=t.Gitana;n.BinaryAttachment=n.AbstractPersistable.extend({constructor:function(t,n){this.base(t.getDriver(),n),this.objectType=function(){return"Gitana.BinaryAttachment"},this.persistable=function(){return t}},getId:function(){return this.attachmentId},getLength:function(){return this.length},getContentType:function(){return this.contentType},getFilename:function(){return this.filename},getUri:function(){return this.persistable().getUri()+"/attachments/"+this.getId()},getDownloadUri:function(){return this.getDriver().baseURL+this.getUri()},getPreviewUri:function(t,n){return n||(n={}),n.attachment=this.attachmentId,this.persistable().getPreviewUri(t,n)},del:function(){const t=this,n=this.subchain(this.persistable());return n.subchain(t).then(function(){const n=this;return this.getDriver().gitanaDelete(this.getUri(),null,function(){n.next()},function(n){t.httpError(n)}),!1}),n},download:function(t){const n=this;return this.then(function(){const e=this;return this.getDriver().gitanaDownload(this.getUri(),null,function(i){t.call(n,i),e.next()},function(t){n.httpError(t)}),!1})},stream:function(t){if(!n.streamDownload)throw new Error("XHR streaming not supported - this method will only work when running in Node.js");n.streamDownload(this,function(n,e){t(n,e)})}})}(window),function(t){const n=t.Gitana;n.BinaryAttachmentMap=n.AbstractMap.extend({constructor:function(t,e){this.objectType=function(){return"Gitana.BinaryAttachmentMap"},this.__persistable=function(){let e=t;return function(t){return n.isUndefined(t)||(e=t),e}}(),e||(e=this.__persistable().getSystemMetadata().attachments),this.base(this.__persistable().getDriver(),e)},chainCopyState:function(t){this.base(t),t.__persistable&&this.__persistable(t.__persistable())},clone:function(){return new n.BinaryAttachmentMap(this.__persistable(),this)},buildObject:function(t){return new n.BinaryAttachment(this.__persistable(),t)}})}(window),function(t){Chain=function(n,i){n||(n={});const o=Chain.proxy(n);return o.__queue=function(){let t=[];return function(n){return n&&("empty"===n?t=[]:t.push(n)),t}}(),o.__response=function(){let t=null;return function(n){return Gitana.isUndefined(n)||(t=n||null),t}}(),o.__waiting=function(){let t=!1;return function(n){return Gitana.isUndefined(n)||(t=n),t}}(),o.__parent=function(){let t=null;return function(n){return Gitana.isUndefined(n)||(t=n||null),t}}(),o.__id=function(){let t=Chain.idCount;return Chain.idCount++,function(){return t}}(),o.__helper=function(){let t=null;return function(n){return n&&(t=n),t}}(),o.__transparent=function(){let t=!1;return function(n){return Gitana.isUndefined(n)||(t=n),t}}(),o.__copyState||(o.__copyState=function(t){Gitana.copyInto(this,t)}),o.then=function(n,e){const i=this;let o=!1;if(Gitana.isArray(n)){const o=n,s=function(){const n=[];for(let t=0;t<o.length;t++){const e=function(t){return function(n){const e=Chain();e.__waiting(!0),e.subchain(i).then(function(){t.call(this)}),e.then(function(){n()}),e.__waiting(!1),e.run()}}(o[t]);n.push(e)}let e=0;const s=n.length;for(let o=0;o<n.length;o++)t.setTimeout(function(t){return function(){t(function(){++e===s&&i.next()})}}(n[o]));return!1},r=this.subchain(null,!0);r.__queue(s),e&&r.__helper(e),n=r}else if(Gitana.isFunction(n)){const t=this.subchain(null,!0);t.__queue(n),e&&t.__helper(e),n=t,o=!0}if(this.__queue(n),o&&!this.__waiting()){let t=this;for(;t.__parent();)t=t.__parent();t.__waiting()||t.run()}return this},o.run=function(){const n=this;if(0===this.__queue().length||this.__waiting())return this;this.__waiting(!0);const e=this.__queue().shift();if(Gitana.isFunction(e)){const i=e;let o=null,s=null;this.__parent()&&(o=this.__parent().__response(),this.__parent().__parent()&&(s=this.__parent().__parent().__response())),t.setTimeout(function(){Chain.log(n,(n.__helper()?n.__helper()+" ":"")+"> "+e.toString());const t=i.call(n,o,s);!1!==t&&n.next(t)},0)}else{const t=e;t.__response(this.__response()),t.__transparent()&&t.__copyState(this),t.beforeChainRun&&t.beforeChainRun.call(t),t.run()}return this},o.subchain=function(t,n){let e=!1;t||(e=!0),t||(t=this);const i=Chain(t,!0);return i.__parent(this),i.beforeChainRun&&i.beforeChainRun.call(i),n||this.then(i),i.__transparent(e),i},o.next=function(t){if(void 0!==t&&this.__response(t),this.__waiting(!1),0===this.__queue().length){if(this.__parent()){const t=this.__response();this.__parent().__response(t),this.__response(null),this.__transparent()&&(Gitana.deleteProperties(this.__parent()),this.__parent().__copyState(this)),this.__parent().next()}this.__parent(null),this.__queue("empty")}else this.run()},o.wait=function(n){return this.then(function(){const e=(i=this,function(){i.next()});var i;return t.setTimeout(e,n),!1})},o.trap=function(t){return this.errorHandler=t,this},o.error=function(t){let n=null,e=this;for(;e&&!n;)(n=e.errorHandler)||(e=e.__parent());this.__queue("empty"),this.__response(null),this.__parent()&&(this.__parent().__queue("empty"),this.__parent().__waiting(!1)),n||(n=Gitana.defaultErrorHandler),!1!==n.call(this,t)&&this.next()},o.done=function(){return this.__parent()},o.chain=function(){return Chain(this,!0).then(function(){})},o.clone||(o.clone=function(){return Chain.clone(this)}),!i&&e()&&o.trap(e()),o},Chain.proxy=function(t){t.__original&&t.__original()&&delete t.__original;let n=null;return(n=t.clone?t.clone():Chain.clone(t)).__original=function(){return t},n},Chain.unproxy=function(t){let n=null;return t.__original&&t.__original()&&(n=t.__original()),n},Chain.debug=!1,Chain.log=function(t,n){if(Chain.debug&&!Gitana.isUndefined(console)){const e=function(){let t=this.__id();return this.__transparent()&&(t+="[t]"),this.__parent()?e.call(this.__parent())+" > "+t:t},i=e.call(t);console.log("Chain["+i+"] "+n)}},Chain.clone=function(t){function n(){}n.prototype=t;const e=new n;return Gitana.copyInto(e,t),e};let n=null;const e=Chain.autoTrap=function(t){return t&&(n=t),n};Chain.idCount=0}(window),function(t){const n=t.Gitana;n.Chainable=Base.extend({constructor:function(t){this.base(),this.__copyState=function(t){n.copyInto(this,t),this.chainCopyState(t)},this.getDriver=function(){return t},this.getFactory=function(){return new n.ObjectFactory},this.httpError=function(t){const e=new n.Error;if(e.name="Http Error",e.message=t.message,e.status=t.status,e.statusText=t.statusText,t.errorType&&(e.errorType=t.errorType),t.stacktrace&&(e.stacktrace=t.stacktrace),t.info&&(e.info=t.info),t.response&&t.response.text){e.responseText=t.response.text;try{e.responseData=JSON.parse(e.responseText)}catch(t){}}return this.error(e),!1},this.missingNodeError=function(t){const e=new n.Error;return e.name="Missing Node error",e.message="The node: "+t+" could not be found",this.error(e),!1},this.chainGet=function(e,i,o){const s=this;return this.subchain(e).then(function(){const e=this;return n.isFunction(i)&&(i=i.call(s)),t.gitanaGet(i,o,{},function(t){e.handleResponse(t),e.next()},function(t){s.httpError(t)}),!1})},this.chainCreate=function(e,i,o,s){const r=this;return this.subchain(e).then(function(){const e=this;return n.isFunction(o)&&(o=o.call(r)),t.gitanaPost(o,s,i,function(n){t.gitanaGet(o+"/"+n.getId(),null,{},function(t){e.handleResponse(t),e.next()},function(t){r.httpError(t)})},function(t){r.httpError(t)}),!1},"chainCreate")},this.chainCreateEx=function(e,i,o,s){const r=this;return this.subchain(e).then(function(){const e=this;return n.isFunction(o)&&(o=o.call(r)),t.gitanaPost(o,null,i,function(i){n.isFunction(s)&&(s=s.call(r,i)),t.gitanaGet(s,null,{},function(t){e.handleResponse(t),e.next()},function(t){r.httpError(t)})},function(t){r.httpError(t)}),!1})},this.chainPost=function(e,i,o,s,r){const c=this;return this.subchain(e).then(function(){const e=this;return n.isFunction(i)&&(i=i.call(c)),t.gitanaPost(i,o,s,function(t){r?r(e,t):e.handleResponse(t),e.next()},function(t){c.httpError(t)}),!1})},this.chainPostEmpty=function(e,i,o,s,r){const c=this;return!s&&r&&(r.indexOf("text/")>-1?s="":"application/json"===r&&(s={})),this.subchain(e).then(function(){const e=this;return n.isFunction(i)&&(i=i.call(c)),t.gitanaPost(i,o,s,function(){e.next()},function(t){c.httpError(t)}),!1})},this.chainUpload=function(e,i,o,s,r){const c=this;return!r&&s&&(s.indexOf("text/")>-1?r="":"application/json"===s&&(r={})),this.subchain(e).then(function(){const e=this;return n.isFunction(i)&&(i=i.call(c)),t.gitanaUpload(i,o,s,r,function(){e.next()},function(t){c.httpError(t)}),!1})},this.chainGetResponse=function(e,i,o){const s=this;return this.subchain(e).then(function(){const e=this;return n.isFunction(i)&&(i=i.call(s)),t.gitanaGet(i,o,{},function(t){e.next(t)},function(t){s.httpError(t)}),!1})},this.chainGetResponseText=function(e,i,o){const s=this;return this.subchain(e).then(function(){const e=this;return n.isFunction(i)&&(i=i.call(s)),t.gitanaRequest("GET",i,o,"text/plain",null,{},function(t){e.next(t)},function(t){s.httpError(t)}),!1})},this.chainGetResponseRows=function(t,n,e){return this.chainGetResponse(t,n,e).then(function(t){return t.rows})},this.chainHasResponseRow=function(t,n,e){return this.chainGetResponse(t,n).then(function(t){let n=!1;for(let i=0;i<t.rows.length;i++)t.rows[i].toLowerCase()===e.toLowerCase()&&(n=!0);return n})},this.chainPostResponse=function(e,i,o,s){const r=this;return this.subchain(e).then(function(){const e=this;return n.isFunction(i)&&(i=i.call(r)),t.gitanaPost(i,o,s,function(t){e.next(t)},function(t){r.httpError(t)}),!1})},this.extractPrincipalDomainQualifiedId=function(t,n){const e=this.extractPrincipalIdentifiers(t,n);return e.domain+"/"+e.principal},this.extractPrincipalIdentifiers=function(t,e){const i={};if(e||(e="default"),n.isString(t)){const n=t.indexOf("/");n>-1?(i.domain=t.substring(0,n),i.principal=t.substring(n+1)):(i.domain=e,i.principal=t)}else t.objectType&&"Gitana.DomainPrincipal"===t.objectType()?(i.domain=t.getDomainId(),i.principal=t.getId()):t.objectType&&"Gitana.TeamMember"===t.objectType()?(i.domain=t.domainId,i.principal=t._doc):t._doc?(i.domain=e,i.principal=t._doc):t.name&&(i.domain=e,i.principal=t.name);return i}},chainCopyState:function(t){}})}(window),function(t){const n=t.Gitana;n.AbstractClusterObject=n.AbstractObject.extend({constructor:function(t,n){this.base(t.getDriver(),n),this.objectType=function(){return"Gitana.Job"},this.getCluster=function(){return t}},ref:function(){return this.getType()+"://"+this.getId()}})}(window),function(t){const n=t.Gitana;n.Cluster=n.DataStore.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.Cluster"},this.base(t,n)},getUri:function(){return""},getType:function(){return n.TypedIDConstants.TYPE_CLUSTER},clone:function(){return new n.Cluster(this.getDriver(),this)},loadContainedTypes:function(t,n){return this.chainPostResponse(this,function(){return"/tools/types/contained/"+t}).then(function(t){n.call(this,t.types)})},queryJobs:function(t,e){const i=this.getFactory().jobMap(this),o={};return e&&n.copyInto(o,e),this.chainPost(i,"/jobs/query",o,t)},readJob:function(t){const n=this.getFactory().job(this);return this.chainGet(n,"/jobs/"+t)},killJob:function(t){return this.chainPostEmpty(null,"/jobs/"+t+"/kill")},queryUnstartedJobs:function(t,e){const i=this.getFactory().jobMap(this),o={};return e&&n.copyInto(o,e),this.chainPost(i,"/jobs/unstarted/query",o,t)},queryRunningJobs:function(t,e){const i=this.getFactory().jobMap(this),o={};return e&&n.copyInto(o,e),this.chainPost(i,"/jobs/running/query",o,t)},queryFailedJobs:function(t,e){const i=this.getFactory().jobMap(this),o={};return e&&n.copyInto(o,e),this.chainPost(i,"/jobs/failed/query",o,t)},queryWaitingJobs:function(t,e){const i=this.getFactory().jobMap(this),o={};return e&&n.copyInto(o,e),this.chainPost(i,"/jobs/waiting/query",o,t)},queryFinishedJobs:function(t,e){const i=this.getFactory().jobMap(this),o={};return e&&n.copyInto(o,e),this.chainPost(i,"/jobs/finished/query",o,t)},waitForJobCompletion:function(e,i,o){const s=this,r=function(){t.setTimeout(function(){Chain(s).readJob(e).then(function(){"FINISHED"===this.state?(i(this),s.next()):"ERROR"===this.state?(i(this),s.next()):o&&n.isFunction(o)?o(r):r()})},1e3)};r()}})}(window),function(t){const n=t.Gitana;n.CopyJob=n.Job.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.CopyJob"}},clone:function(){return new n.CopyJob(this.getCluster(),this)},getImports:function(){const t=[],n=this.get("imports");for(let e=0;e<n.length;e++){const i=n[e],o={sources:i.sources,targets:i.targets,getType:function(){return this.targets[this.targets.length-1].typeId},getSourceId:function(){return this.sources[this.sources.length-1].id},getTargetId:function(){return this.targets[this.targets.length-1].id}};t.push(o)}return t},getSingleImportTargetId:function(){let t=null;const n=this.getImports();return n.length>0&&(t=n[0].getTargetId()),t}})}(window),function(t){const n=t.Gitana;n.Job=n.AbstractClusterObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.Job"}},clone:function(){return new n.Job(this.getCluster(),this)},getType:function(){return this.get("type")},getRunAsPrincipalId:function(){return this.get("runAsPrincipal")},getRunAsPrincipalDomainId:function(){return this.get("runAsPrincipalDomain")},getState:function(){return this.get("state")},getPlatformId:function(){return this.get("platformId")},getPriority:function(){return this.get("priority")},getAttempts:function(){return this.get("attempts")},getScheduledStartTime:function(){return this.get("schedule_start_ms")},getLogEntries:function(){return this.get("log_entries")},getCurrentThread:function(){return this.get("current_thread")},getCurrentServer:function(){return this.get("current_server")},getCurrentServerTimeStamp:function(){return this.get("current_server_timestamp")},getSubmittedBy:function(){return this.get("submitted_by")},getSubmittedTimestamp:function(){return this.get("submitted_timestamp")},getStarted:function(){return this.get("started")},getStartedBy:function(){return this.get("started_by")},getStartedTimestamp:function(){return this.get("started_timestamp")},getStopped:function(){return this.get("stopped")},getStoppedTimestamp:function(){return this.get("stopped_timestamp")},getPaused:function(){return this.get("paused")},getPausedBy:function(){return this.get("paused_by")},getPausedTimestamp:function(){return this.get("paused_timestamp")}})}(window),function(t){const n=t.Gitana;n.JobMap=n.AbstractMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.JobMap"},this.getCluster=function(){return t},this.base(t.getDriver(),n)},clone:function(){return this.getFactory().jobMap(this.getCluster(),this)},buildObject:function(t){return this.getFactory().job(this.getCluster(),t)}})}(window),function(t){const n=t.Gitana;n.LogEntry=n.AbstractObject.extend({constructor:function(t,n){this.base(t.getDriver(),n),this.objectType=function(){return"Gitana.LogEntry"},this.getPlatform=function(){return t}},clone:function(){return new n.LogEntry(this.getPlatform(),this)},getType:function(){return n.TypedIDConstants.TYPE_LOG_ENTRY},getPrincipalId:function(){return this.get("principalId")},getRepositoryId:function(){return this.get("repositoryId")},getBranchId:function(){return this.get("branchId")},getLevel:function(){return this.get("level")},getThread:function(){return this.get("thread")},getTimestamp:function(){return this.get("timestamp")},getMessage:function(){return this.get("message")},getFilename:function(){return this.get("filename")},getMethod:function(){return this.get("method")},getLineNumber:function(){return this.get("line")},getClassDescriptor:function(){return this.get("class")},getThrowables:function(){return this.get("throwables")}})}(window),function(t){const n=t.Gitana;n.LogEntryMap=n.AbstractMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.LogEntryMap"},this.getPlatform=function(){return t},this.base(t.getDriver(),n)},clone:function(){return this.getFactory().logEntryMap(this.getPlatform(),this)},buildObject:function(t){return this.getFactory().logEntry(this.getPlatform(),t)}})}(window),function(t){const n=t.Gitana;n.TransferExportJob=n.Job.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.TransferExportJob"}},clone:function(){return new n.TransferExportJob(this.getCluster(),this)},getImports:function(){const t=[],n=this.get("imports");for(let e=0;e<n.length;e++){const i=n[e],o={sources:i.sources,targets:i.targets,getType:function(){return this.targets[this.targets.length-1].typeId},getSourceId:function(){return this.sources[this.sources.length-1].id},getTargetId:function(){return this.targets[this.targets.length-1].id}};t.push(o)}return t},getSingleImportTargetId:function(){let t=null;const n=this.getImports();return n.length>0&&(t=n[0].getTargetId()),t}})}(window),function(t){const n=t.Gitana;n.TransferImportJob=n.Job.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.TransferImportJob"}},clone:function(){return new n.TransferExportJob(this.getCluster(),this)},getImports:function(){const t=[],n=this.get("imports");for(let e=0;e<n.length;e++){const i=n[e],o={sources:i.sources,targets:i.targets,getType:function(){return this.targets[this.targets.length-1].typeId},getSourceId:function(){return this.sources[this.sources.length-1].id},getTargetId:function(){return this.targets[this.targets.length-1].id}};t.push(o)}return t},getSingleImportTargetId:function(){let t=null;const n=this.getImports();return n.length>0&&(t=n[0].getTargetId()),t}})}(window),"undefined"==typeof window&&(window={setTimeout:function(t,n){setTimeout(t,n)}}),function(t){const n=t.Gitana;n.ContainedDataStore=n.DataStore.extend({constructor:function(t,n){this.base(t.getDriver(),n),this.getContainer=function(){return t},this.getContainerId=function(){return t.getId()}},del:function(){return this.chainDelete(this.getContainer(),function(){return this.getUri()})},reload:function(){return this.chainReload(null,function(){return this.getUri()})},update:function(){return this.chainUpdate(null,function(){return this.getUri()})},exportArchive:function(t){const e=this;let i=t.vault;n.isString(i)||(i=i.getId());const o=t.group,s=t.artifact,r=t.version,c=t.configuration?t.configuration:{},a=!t.async,u=t.title,h=t.description,f=t.published,l=this.getFactory().job(this.getCluster(),"export");return this.subchain(l).then(function(){const t=this,l={};return l.vault=i,l.group=o,l.artifact=s,l.version=r,l.schedule="ASYNCHRONOUS",u&&(l.title=u),h&&(l.description=h),f&&(l.published=f),this.getDriver().gitanaPost(e.getUri()+"/export",l,c,function(i){n.handleJobCompletion(t,e.getCluster(),i.getId(),a)},function(t){e.httpError(t)}),!1})},importArchive:function(t,e){const i=this;let o=t.vault;n.isString(o)||(o=o.getId());const s=t.group,r=t.artifact,c=t.version,a=t.configuration?t.configuration:{},u=!t.async,h=this.getFactory().job(this.getCluster(),"import");return this.subchain(h).then(function(){const t=this;return this.getDriver().gitanaPost(i.getUri()+"/import?vault="+o+"&group="+s+"&artifact="+r+"&version="+c+"&schedule=ASYNCHRONOUS",{},a,function(o){n.handleJobCompletion(t,i.getCluster(),o.getId(),u,e)},function(t){i.httpError(t)}),!1})}})}(window),function(t){const n=t.Gitana;n.Context=n.Chainable.extend({constructor:function(t){this.base(new n(t.driver?t.driver:{})),this.cache||(this.cache={}),this.cache.repository=null,this.cache.branch=null,this.cache.platform=null,this.getConfigs=function(){return t},this.getRepositoryConfigs=function(){let n=t.repository;return"string"==typeof n&&(n={repository:n}),n},this.getBranchConfigs=function(){let n=t.branch?t.branch:"master";return"string"==typeof n&&(n="master"===n?{type:"MASTER"}:{_doc:n}),n},this.getUserConfigs=function(){return t.user},this.getDriverConfigs=function(){return t.driver}},platform:function(t){return(t||null===t)&&(this.cache.platform=t),this.cache.platform?Chain(this.cache.platform):null},repository:function(t){return(t||null===t)&&(this.cache.repository=t),this.cache.repository?Chain(this.cache.repository):null},branch:function(t){return(t||null===t)&&(this.cache.branch=t),this.cache.branch?Chain(this.cache.branch):null},init:function(){const t=this,n=function(n,i){t.repository()?e(n,i):t.platform().trap(function(t){i&&i({message:"Failed to get repository",error:t})}).queryRepositories(t.getRepositoryConfigs()).count(function(t){i&&(0===t&&i({message:"Cannot find any repository"}),t>1&&i({message:"Found more than one repository"}))}).keepOne().then(function(){t.repository(this),e(n,i)})},e=function(n,e){t.branch()?n.call():t.repository().trap(function(t){e&&e({message:"Failed to get branch",error:t})}).queryBranches(t.getBranchConfigs()).count(function(t){e&&(0===t&&e({message:"Cannot find any branch"}),t>1&&e({message:"Found more than one branch"}))}).keepOne().then(function(){t.branch(this),n.call()})};return Chain(this).subchain().then(function(){const e=this;return function(e,i){if(t.platform())n(e,i);else{const o=t.getConfigs().authentication;t.getDriver().authenticate(o,function(t){i&&i({message:"Failed to login Gitana.",reason:"INVALID_LOGIN",error:t})}).then(function(){t.platform(this),n(e,i)})}}(function(){e.next()},function(n){const e=t.getConfigs().error;e&&e.call(t,n)}),!1})}}),n.Context.create=function(t){return new n.Context(t).init()}}(window),function(t){const n=t.Gitana;n.DataStore=n.AbstractObject.extend({constructor:function(t,n){this.base(t,n)},getUri:function(){return null},getType:function(){return null},ref:function(){return this.getType()+"://"+this.getId()},loadACL:function(t){return this.chainGetResponse(this,function(){return this.getUri()+"/acl/list"}).then(function(n){t.call(this,n)})},listAuthorities:function(t,n){const e=this.extractPrincipalDomainQualifiedId(t);return this.chainGetResponseRows(this,function(){return this.getUri()+"/acl?id="+e}).then(function(t){n.call(this,t)})},checkAuthority:function(t,n,e){const i=this.extractPrincipalDomainQualifiedId(t);return this.chainPostResponse(this,function(){return this.getUri()+"/authorities/"+n+"/check?id="+i}).then(function(t){e.call(this,t.check)})},grantAuthority:function(t,n){const e=this.extractPrincipalDomainQualifiedId(t);return this.chainPostEmpty(null,function(){return this.getUri()+"/authorities/"+n+"/grant?id="+e})},revokeAuthority:function(t,n){const e=this.extractPrincipalDomainQualifiedId(t);return this.chainPostEmpty(null,function(){return this.getUri()+"/authorities/"+n+"/revoke?id="+e})},revokeAllAuthorities:function(t){return this.revokeAuthority(t,"all")},loadAuthorityGrants:function(t,n){t||(t=[]);const e={principals:t};return this.chainPostResponse(this,this.getUri()+"/authorities",{},e).then(function(t){n.call(this,t)})},checkPermission:function(t,n,e){const i=this.extractPrincipalDomainQualifiedId(t);return this.chainPostResponse(this,function(){return this.getUri()+"/permissions/"+n+"/check?id="+i}).then(function(t){e.call(this,t.check)})},readTeam:function(t){const n=this.getFactory().team(this.getPlatform(),this);return this.chainGet(n,function(){return this.getUri()+"/teams/"+t})},listTeams:function(){const t=this.getFactory().teamMap(this.getCluster(),this);return this.chainGet(t,function(){return this.getUri()+"/teams"})},createTeam:function(t,n){n||(n={});const e=this,i=this.getFactory().team(this.getPlatform(),this);return this.chainPostResponse(i,function(){return this.getUri()+"/teams?key="+t},{},n).then(function(){const n=this;return Chain(e).readTeam(t).then(function(){n.handleResponse(this),n.next()}),!1})},readOwnersTeam:function(){return this.readTeam("owners")},listActivities:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().activityMap(this);return this.chainGet(i,"/activities",e)},readActivity:function(t){const n=this.getFactory().activity(this);return this.chainGet(n,"/activities/"+t)},queryActivities:function(t,e){const i=this.getFactory().activityMap(this),o={};return e&&n.copyInto(o,e),this.chainPost(i,"/activities/query",o,t)},readRole:function(t,n){const e={};n&&(e.inherited=!0);const i=this.getFactory().role(this.getCluster(),this);return this.chainGet(i,function(){return this.getUri()+"/roles/"+t},e)},listRoles:function(t){const n={};t&&(n.inherited=!0);const e=this.getFactory().roleMap(this.getCluster(),this);return this.chainGet(e,function(){return this.getUri()+"/roles"},n)},createRole:function(t,e){e||(e={}),e.roleKey=t;const i=this,o=this.getFactory().role(this.getPlatform(),this,t);return this.chainPostResponse(o,function(){return this.getUri()+"/roles"},{},e).then(function(){this.subchain(i).readRole(t).then(function(){n.copyInto(o,this)})})},getMaxSize:function(){return this.get("maxSize")},getSize:function(){return this.get("size")},getObjectCount:function(){return this.get("objectcount")}})}(window),function(t){const n=t.Gitana;n.AbstractDirectoryObject=n.AbstractPlatformObject.extend({constructor:function(t,n){this.base(t.getPlatform(),n),this.objectType=function(){return"Gitana.Connection"},this.getDirectory=function(){return t},this.getDirectoryId=function(){return t.getId()}},ref:function(){return this.getType()+"://"+this.getPlatformId()+"/"+this.getDirectoryId()+"/"+this.getId()}})}(window),function(t){const n=t.Gitana;n.Connection=n.AbstractDirectoryObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.Connection"}},getType:function(){return n.TypedIDConstants.TYPE_CONNECTION},getUri:function(){return"/directories/"+this.getDirectoryId()+"/connections/"+this.getId()},clone:function(){return this.getFactory().connection(this.getDirectory(),this)}})}(window),function(t){const n=t.Gitana;n.ConnectionMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.ConnectionMap"},this.getDirectory=function(){return t},this.getDirectoryId=function(){return t.getId()},this.base(t.getPlatform(),n)},clone:function(){return this.getFactory().connectionMap(this.getDirectory(),this)},buildObject:function(t){return this.getFactory().connection(this.getDirectory(),t)}})}(window),function(t){const n=t.Gitana;n.Directory=n.AbstractPlatformDataStore.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.Directory"},this.base(t,n)},getUri:function(){return"/directories/"+this.getId()},getType:function(){return n.TypedIDConstants.TYPE_DIRECTORY},clone:function(){return this.getFactory().directory(this.getPlatform(),this)},readIdentity:function(t){const n=this,e=this.getFactory().identity(this);return this.chainGet(e,function(){return n.getUri()+"/identities/"+t})},listIdentities:function(t){const e=this,i={};t&&n.copyInto(i,t);const o=this.getFactory().identityMap(this);return this.chainGet(o,function(){return e.getUri()+"/identities"},i)},queryIdentities:function(t,e){const i=this,o={};e&&n.copyInto(o,e);const s=this.getFactory().identityMap(this);return this.chainPost(s,function(){return i.getUri()+"/identities/query"},o,t)},checkIdentityPermissions:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/identities/permissions/check"},{},i).then(function(t){n.call(this,t.results)})},checkIdentityAuthorities:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/identities/authorities/check"},{},i).then(function(t){n.call(this,t.results)})},readConnection:function(t){const n=this,e=this.getFactory().connection(this);return this.chainGet(e,function(){return n.getUri()+"/connections/"+t})},createConnection:function(t){const n=this;t||(t={});const e=this.getFactory().connection(this,t);return this.chainCreate(e,t,function(){return n.getUri()+"/connections"})},listConnections:function(t){const e=this,i={};t&&n.copyInto(i,t);const o=this.getFactory().connectionMap(this);return this.chainGet(o,function(){return e.getUri()+"/connections"},i)},queryConnections:function(t,e){const i=this,o={};e&&n.copyInto(o,e);const s=this.getFactory().connectionMap(this);return this.chainPost(s,function(){return i.getUri()+"/connections/query"},o,t)},checkConnectionPermissions:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/connections/permissions/check"},{},i).then(function(t){n.call(this,t.results)})},checkConnectionAuthorities:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/connections/authorities/check"},{},i).then(function(t){n.call(this,t.results)})}})}(window),function(t){const n=t.Gitana;n.DirectoryMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.DirectoryMap"},this.base(t,n)},clone:function(){return this.getFactory().directoryMap(this.getPlatform(),this)},buildObject:function(t){return this.getFactory().directory(this.getPlatform(),t)}})}(window),function(t){const n=t.Gitana;n.Identity=n.AbstractDirectoryObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.Identity"}},getType:function(){return n.TypedIDConstants.TYPE_IDENTITY},getUri:function(){return"/directories/"+this.getDirectoryId()+"/identities/"+this.getId()},clone:function(){return this.getFactory().identity(this.getDirectory(),this)},changePassword:function(t,n){const e={password:t,verifyPassword:n};return this.chainPostEmpty(null,this.getUri()+"/changepassword",{},e)},findPolicyUsers:function(t){const e=this,i=new n.Domain(this.getPlatform()),o=this.getFactory().domainPrincipalMap(i),s={};return t&&(s.tenantId=t),this.chainGet(o,function(){return e.getUri()+"/policy/users"},s)},findPolicyUserForTenant:function(t){const n=this,e=this.getFactory().domainPrincipal(this),i={};return i.tenantId=t,this.chainGet(e,function(){return n.getUri()+"/policy/user"},i)},findPolicyUsersForTenant:function(t){const n=this,e=this.getFactory().domainPrincipalMap(this),i={};return i.tenantId=t,this.chainGet(e,function(){return n.getUri()+"/policy/users"},i)},findPolicyTenants:function(t){const n=this,e=this.getFactory().tenantMap(this),i={};return t&&(i.registrarId=t),this.chainGet(e,function(){return n.getUri()+"/policy/tenants"},i)}})}(window),function(t){var n=t.Gitana;n.IdentityMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.IdentityMap"},this.getDirectory=function(){return t},this.getDirectoryId=function(){return t.getId()},this.base(t.getPlatform(),n)},clone:function(){return this.getFactory().identityMap(this.getDirectory(),this)},buildObject:function(t){return this.getFactory().identity(this.getDirectory(),t)}})}(window),function(t){const n=t.Gitana;n.AbstractDomainObject=n.AbstractPlatformObject.extend({constructor:function(t,n){this.base(t.getPlatform(),n),this.objectType=function(){return"Gitana.DomainPrincipal"},this.getDomain=function(){return t},this.getDomainId=function(){return t.getId()}},ref:function(){return this.getType()+"://"+this.getPlatformId()+"/"+this.getDomainId()+"/"+this.getId()}})}(window),function(t){const n=t.Gitana;n.Domain=n.AbstractPlatformDataStore.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.Domain"}},getUri:function(){return"/domains/"+this.getId()},getType:function(){return n.TypedIDConstants.TYPE_DOMAIN},clone:function(){return this.getFactory().domain(this.getPlatform(),this)},listPrincipals:function(t,e){const i=this,o={};t&&n.copyInto(o,t),e&&n.copyInto(o,e);const s=this.getFactory().domainPrincipalMap(this);return this.chainGet(s,function(){return i.getUri()+"/principals"},o)},readPrincipal:function(t,e){const i=this,o={};e&&n.copyInto(o,e);const s=this.getFactory().domainPrincipal(this);return this.chainGet(s,function(){return i.getUri()+"/principals/"+t},o)},createPrincipal:function(t){const n=this;if(t||(t={}),!t.name)return void console.log("missing name");if(!t.type)return void console.log("missing type");const e=this.getFactory().domainPrincipal(this,t);return this.chainCreate(e,t,function(){return n.getUri()+"/principals"})},queryPrincipals:function(t,e,i){const o=this,s={};e&&n.copyInto(s,e),i&&n.copyInto(s,i);const r=this.getFactory().domainPrincipalMap(this);return this.chainPost(r,function(){return o.getUri()+"/principals/query"},s,t)},listGroups:function(t){return this.queryPrincipals({type:"GROUP"},t)},createGroup:function(t){return t||(t={}),t.type="GROUP",this.createPrincipal(t)},queryGroups:function(t,n){return t||(t={}),t.type="GROUP",this.queryPrincipals(t,n)},listUsers:function(t){return this.queryPrincipals({type:"USER"},t)},createUser:function(t){return t||(t={}),t.type="USER",this.createPrincipal(t)},queryUsers:function(t,n){return t||(t={}),t.type="USER",this.queryPrincipals(t,n)},addMember:function(t,n){const e=this,i=this.extractPrincipalIdentifiers(t,this.getId()).principal,o=this.extractPrincipalDomainQualifiedId(n);return this.chainPostEmpty(null,function(){return e.getUri()+"/principals/"+i+"/members/add?id="+o})},removeMember:function(t,n){const e=this,i=this.extractPrincipalIdentifiers(t,this.getId()).principal,o=this.extractPrincipalDomainQualifiedId(n);return this.chainPostEmpty(null,function(){return e.getUri()+"/principals/"+i+"/members/remove?id="+o})},listMembers:function(t,e,i,o){const s=this,r={};i&&n.copyInto(r,i),e&&(r.filter=e),o&&(r.indirect=!0);const c=this.extractPrincipalIdentifiers(t,this.getId()).principal,a=this.getFactory().domainPrincipalMap(this);return this.chainGet(a,function(){return s.getUri()+"/principals/"+c+"/members"},r)},checkPrincipalPermissions:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/principals/permissions/check"},{},i).then(function(t){n.call(this,t.results)})},checkPrincipalAuthorities:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/principals/authorities/check"},{},i).then(function(t){n.call(this,t.results)})},checkGroupMemberships:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/principals/membership/check"},{},i).then(function(t){n.call(this,t.results)})}})}(window),function(t){const n=t.Gitana;n.DomainMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.DomainMap"},this.base(t,n)},clone:function(){return this.getFactory().domainMap(this.getPlatform(),this)},buildObject:function(t){return this.getFactory().domain(this.getPlatform(),t)}})}(window),function(t){const n=t.Gitana;n.DomainPrincipal=n.AbstractDomainObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.DomainPrincipal"}},getUri:function(){return"/domains/"+this.getDomainId()+"/principals/"+this.getId()},clone:function(){return this.getFactory().domainPrincipal(this.getDomain(),this)},beforeChainRun:function(){this.getFactory().extendPrincipal(this)},getName:function(){return this.get("name")},getType:function(){return this.get("type")},getDomainQualifiedName:function(){return this.getDomainId()+"/"+this.getName()},getDomainQualifiedId:function(){return this.getDomainId()+"/"+this.getId()},listMemberships:function(t,e){const i={};e&&n.copyInto(i,e);const o=this.getFactory().domainPrincipalMap(this.getDomain());return this.chainGet(o,function(){let n=this.getUri()+"/memberships";return t&&(n+="?indirect=true"),n},i)},listAttachments:n.Methods.listAttachments(),attachment:function(t){return this.listAttachments().select(t)},attach:n.Methods.attach(),unattach:n.Methods.unattach(),getPreviewUri:n.Methods.getPreviewUri(),listAuthenticationGrants:function(t){const e={};t&&n.copyInto(e,t),e.domainId=this.getDomainId(),e.principalId=this.getId();const i=this.getFactory().authenticationGrantMap(this.getPlatform());return this.chainGet(i,"/auth/grants",e)},listTeamMemberships:function(t,e){const i={teamableType:t.getType(),teamableId:t.getId()};e&&n.copyInto(i,e);const o=this.getFactory().teamMap(this.getCluster(),this);return this.chainGet(o,function(){return this.getUri()+"/teams"},i)}})}(window),function(t){const n=t.Gitana;n.PrincipalMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.PrincipalMap"},this.getDomain=function(){return t},this.base(t.getPlatform(),n)},clone:function(){return this.getFactory().domainPrincipalMap(this.getDomain(),this)},buildObject:function(t){return this.getFactory().domainPrincipal(this.getDomain(),t)}})}(window),function(t){const n=t.Gitana;n.DomainGroup={TYPE:"GROUP",ref:function(){return"group://"+this.getPlatformId()+"/"+this.getDomainId()+"/"+this.getId()},readGroupNode:function(t,n){const e=this.subchain(this.getFactory().node(t,"n:group"));return e.subchain(t).readGroupNode(this.getId(),n).then(function(){e.handleResponse(this)}),e},listMembers:function(t,e,i){const o=this,s={};i&&n.copyInto(s,i),t&&(s.filter=t),e&&(s.indirect=!0);const r=this.getFactory().domainPrincipalMap(this.getDomain());return this.chainGet(r,function(){return o.getUri()+"/members"},s)},listUsers:function(){let t=!1,e=null;const i=n.makeArray(arguments),o=i.shift();return n.isBoolean(o)?(t=o,e=i.shift()):e=i.shift(),this.listMembers("user",t,e)},listGroups:function(){let t=!1,e=null;const i=n.makeArray(arguments),o=i.shift();return n.isBoolean(o)?(t=o,e=i.shift()):e=o,this.listMembers("group",t,e)},addMember:function(t){const n=this.extractPrincipalDomainQualifiedId(t);return this.chainPostEmpty(null,this.getUri()+"/members/add?id="+n)},removeMember:function(t){const n=this.extractPrincipalDomainQualifiedId(t);return this.chainPostEmpty(null,this.getUri()+"/members/remove?id="+n)}}}(window),function(t){t.Gitana.DomainUser={TYPE:"USER",ref:function(){return"user://"+this.getPlatformId()+"/"+this.getDomainId()+"/"+this.getId()},readPersonNode:function(t,n){const e=this.subchain(this.getFactory().node(t,"n:person"));return e.subchain(t).readPersonNode(this.getDomainQualifiedId(),n).then(function(){e.handleResponse(this)}),e},hasIdentity:function(){return this.getDirectoryId()&&this.getIdentityId()},getDirectoryId:function(){return this.get("directoryId")},getIdentityId:function(){return this.get("identityId")},readDirectory:function(){const t=this.getFactory().directory(this.getPlatform(),{_doc:this.getDirectoryId()}),n=this.subchain(t);return n.subchain(this.getPlatform()).readDirectory(this.getDirectoryId()).then(function(){n.handleResponse(this)}),n},readIdentity:function(){const t=this,n=this.getFactory().directory(this.getPlatform(),{_doc:this.getDirectoryId()}),e=this.getFactory().identity(n,{_doc:this.getIdentityId()}),i=this.subchain(e);return i.subchain(this.getPlatform()).readDirectory(t.getDirectoryId()).then(function(){n.handleResponse(this),this.readIdentity(t.getIdentityId()).then(function(){e.handleResponse(this)})}),i},getFirstName:function(){return this.get("firstName")},setFirstName:function(t){this.set("firstName",t)},getLastName:function(){return this.get("lastName")},setLastName:function(t){this.set("lastName",t)},getCompanyName:function(){return this.get("companyName")},setCompanyName:function(t){this.set("companyName",t)},getEmail:function(){return this.get("email")},setEmail:function(t){this.set("email",t)},getJobTitle:function(){return this.get("jobTitle")},setJobTitle:function(t){this.set("jobTitle",t)},getAddress:function(){return this.get("address")},setAddress:function(t){this.set("address",t)},getCity:function(){return this.get("city")},setCity:function(t){this.set("city",t)},getState:function(){return this.get("state")},setState:function(t){this.set("state",t)},getZipcode:function(){return this.get("zipcode")},setZipcode:function(t){this.set("zipcode",t)},getPhoneNumber:function(){return this.get("phoneNumber")},setPhoneNumber:function(t){this.set("phoneNumber",t)}}}(window),function(t){Gitana=Base.extend({constructor:function(t){const n=this;t||(t={}),t.host&&(t.baseURL=t.host+"/proxy"),this.applicationInfo={},this.stackInfo={};const e={clientKey:null,clientSecret:null,baseURL:"/proxy",locale:Gitana.DEFAULT_LOCALE?Gitana.DEFAULT_LOCALE:null,application:null,loadAppHelper:!0,storage:null};if(Gitana.DEFAULT_CONFIG)for(let t in Gitana.DEFAULT_CONFIG)Gitana.DEFAULT_CONFIG.hasOwnProperty(t)&&(e[t]=Gitana.DEFAULT_CONFIG[t]);Gitana.copyKeepers(e,Gitana.loadDefaultConfig()),Gitana.copyKeepers(e,t),void 0===e.cacheBuster&&(e.cacheBuster=!0),Gitana.AUTO_UPGRADE_TO_CLOUDFRONT&&e.baseURL&&(e.baseURL=e.baseURL.replace("https://api.cloudcms.com","https://api1.cloudcms.com"),e.baseURL=e.baseURL.replace("http://api.cloudcms.com","http://api1.cloudcms.com")),this.baseURL=e.baseURL,this.locale=e.locale;const i={};e.clientKey&&(i.clientKey=e.clientKey),e.clientSecret&&(i.clientSecret=e.clientSecret),this.baseURL&&(i.baseURL=this.baseURL,i.tokenURL="/oauth/token"),i.requestedScope="api",this.updateOptions=function(t){t&&Gitana.copyInto(i,t)},this.resetHttp=function(t){const e={};Gitana.copyInto(e,i),t&&Gitana.copyInto(e,t),e.storage||(e.storage=this.getOriginalConfiguration().storage),n.http=new Gitana.OAuth2Http(e,e.storage)},this.setAuthInfo=function(t){this.authInfo=t},this.setStackInfo=function(t){this.stackInfo=t},this.setApplicationInfo=function(t){this.applicationInfo=t},this.getOriginalConfiguration=function(){return e},this.getHttpHeaders=function(){const t={};return this.http&&this.http.getBearerAuthorizationHeader()&&(t.Authorization=this.http.getBearerAuthorizationHeader()),t}},getAuthInfo:function(){return this.authInfo},getStackInfo:function(){return this.stackInfo},getApplicationInfo:function(){return this.applicationInfo},setLocale:function(t){this.locale=t},getLocale:function(){return this.locale},defaultFailureCallback:function(t){if(this.debug&&"undefined"!=typeof console){let n="Received bad http state ("+t.status+")",e=null,i=null;const o=t.responseText;o&&(i=JSON.parse(o))&&i.message&&(n=n+": "+i.message),i&&i.stacktrace&&(e=i.stacktrace),console.log(n),e&&console.log(e)}},ajax:function(n,e,i,o,s,r,c){s||(s={}),null==n&&(n="GET");let a=!1;if("application/json"===i&&(a=!0),("POST"===(n=n.toUpperCase())||"PUT"===n)&&(s["Content-Type"]=i,!i))return void Gitana.debug("Performing method: "+n+" but missing content type");let u=o;if(a&&("PUT"!==n&&"POST"!==n||o||(o={}),Gitana.isString(o)||(u=Gitana.stringify(o))),"/"===e.substring(0,1)){if(Gitana.isUndefined(t.location))throw new Error("Relative URL not supported outside of the browser: "+e);{let n=t.location.protocol+"//"+t.location.host;-1===t.location.host.indexOf(":")&&t.location.port&&(n+=":"+t.location.port),e=n+e}}const h={method:n,url:e,data:u,headers:s,success:r,failure:c};return Gitana.requestCount++,this.http.request(h),this},gitanaRequest:function(t,n,e,i,o,s,r,c){e||(e={});const a=n.indexOf("?");if(a>-1){const t=n.substring(a+1);n=n.substring(0,a);const i=t.split("&");for(let t=0;t<i.length;t++){const n=i[t].split("=");e[n[0]]=n[1]}}if(Gitana.startsWith(n,"/")&&(n=this.baseURL+n),c||(c=this.defaultFailureCallback),s||(s={}),Gitana.HTTP_PARAMS)for(let t in Gitana.HTTP_PARAMS)Gitana.HTTP_PARAMS.hasOwnProperty(t)&&(e[t]=Gitana.HTTP_PARAMS[t]);if(Gitana.HTTP_HEADERS)for(let t in Gitana.HTTP_HEADERS)Gitana.HTTP_HEADERS.hasOwnProperty(t)&&(s[t]=Gitana.HTTP_HEADERS[t]);Gitana.isEmpty(e.metadata)&&(e.metadata=!0),Gitana.isEmpty(e.full)&&(e.full=!0),null===this.locale?e.locale||(e.locale="default"):void 0!==this.locale&&(s["accept-language"]=this.locale,e.locale=this.locale);let u=null;!0===this.getOriginalConfiguration().cacheBuster?u=(new Date).getTime():"string"==typeof this.getOriginalConfiguration().cacheBuster?u=this.getOriginalConfiguration().cacheBuster:"function"==typeof this.getOriginalConfiguration().cacheBuster&&(u=this.getOriginalConfiguration().cacheBuster()),u&&(e.cb=u);for(let t in e){let i=e[t];Gitana.isFunction(i)?i=i.call():Gitana.isString(i)?i=Gitana.escape(i):Gitana.isNumber(i)||(i=Gitana.escape(Gitana.stringify(i,!1))),n=n.indexOf("?")>-1?n+"&"+t+"="+i:n+"?"+t+"="+i}return this.ajax(t,n,i,o,s,function(t,n){if(r){let n=t.text;if("application/json"===i)try{n=new Gitana.Response(JSON.parse(n))}catch(t){c(t)}r(n)}},function(t,n){if(c){const e={};if(t&&t.timeout)e.statusText="Connection timed out",e.status=n.status,e.errorType="timeout",e.message="Connection timed out",e.xhr=n,e.response=t,t.info&&(e.info=t.info);else{e.statusText=n.statusText,e.status=n.status,e.errorType="http",e.xhr=n,t&&(e.response=t);let o=null,s=null;if("application/json"===i)try{const n=t.text,e=new Gitana.Response(JSON.parse(n));e.message&&(o=e.message),e.stacktrace&&(s=e.stacktrace)}catch(t){}o&&(e.message=o),s&&(e.stacktrace=s)}c(e)}})},gitanaGet:function(t,n,e,i,o){return this.gitanaRequest("GET",t,n,"application/json",null,e,i,o)},gitanaDownload:function(t,n,e,i){return this.gitanaRequest("GET",t,n,null,null,{},e,i)},gitanaPost:function(t,n,e,i,o){return this.gitanaRequest("POST",t,n,"application/json",e,{},i,o)},gitanaUpload:function(t,n,e,i,o,s){return this.gitanaRequest("POST",t,n,e,i,{},o,s)},gitanaPut:function(t,n,e,i,o){return this.gitanaRequest("PUT",t,n,"application/json",e,{},i,o)},gitanaPatch:function(t,n,e,i,o){return this.gitanaRequest("PATCH",t,n,"application/json",e,{},i,o)},gitanaDelete:function(t,n,e,i){return this.gitanaRequest("DELETE",t,n,"application/json",null,{},e,i)},getFactory:function(){return new Gitana.ObjectFactory},authenticate:function(t,n){const e=this,i={code:null,redirectUri:null,username:null,password:null,accessToken:null,ticket:null,cookie:null,ticketMaxAge:null};Gitana.copyKeepers(i,Gitana.loadDefaultConfig()),Gitana.copyKeepers(i,t),(i.ticket||i.accessToken||i.code)&&(delete i.username,delete i.password,i.ticket?(delete i.accessToken,delete i.code):i.accessToken?(delete i.ticket,delete i.code):i.code&&(delete i.accessToken,delete i.ticket));const o={key:null,ticket:null,username:null,clientKey:null};Gitana.copyKeepers(o,this.getOriginalConfiguration()),Gitana.copyKeepers(o,t);let s=o.key;s||(s=Gitana.determinePlatformCacheKey(o,!0)),s&&(this.platformCacheKey=s);const r=new Gitana.Cluster(this,{}),c=function(t,n){const e=t.platformCacheKey;e&&Gitana.PLATFORM_CACHE(e,n);const i=t.getAuthInfo().getTicket();i&&Gitana.PLATFORM_CACHE(i,n)},a=this.getFactory().platform(r);return Chain(a).then(function(){return function(){const t=this;if(i.code||i.username||i.accessToken||i.cookie||i.ticket||(i.username="guest",i.password="guest"),i.code)i.authorizationFlow=Gitana.OAuth2Http.AUTHORIZATION_CODE,e.resetHttp(i),Gitana.deleteCookie("GITANA_TICKET","/"),e.gitanaGet("/auth/info",{},{},function(n){const i=new Gitana.AuthInfo(n);e.setAuthInfo(i),Gitana.deleteCookie("JSESSIONID","/"),c(e,t),t.reload(),t.next()},function(e){n&&n.call(t,e)});else if(i.username)i.authorizationFlow=Gitana.OAuth2Http.PASSWORD,e.resetHttp(i),Gitana.deleteCookie("GITANA_TICKET","/"),e.gitanaGet("/auth/info",{},{},function(n){const i=new Gitana.AuthInfo(n);e.setAuthInfo(i),Gitana.deleteCookie("JSESSIONID","/"),c(e,t),t.reload(),t.next()},function(e){n&&n.call(t,e)});else if(i.accessToken)i.authorizationFlow=Gitana.OAuth2Http.TOKEN,e.resetHttp(i),Gitana.deleteCookie("GITANA_TICKET","/"),e.gitanaGet("/auth/info",{},{},function(n){const i=new Gitana.AuthInfo(n);e.setAuthInfo(i),Gitana.deleteCookie("JSESSIONID","/"),c(e,t),t.reload(),t.next()},function(e){n&&n.call(t,e)});else if(i.cookie)i.authorizationFlow=Gitana.OAuth2Http.COOKIE,e.resetHttp(i),e.gitanaGet("/auth/info",{},{},function(n){const i=new Gitana.AuthInfo(n);e.setAuthInfo(i),i.accessToken&&e.http.accessToken(i.accessToken),Gitana.deleteCookie("JSESSIONID","/"),c(e,t),t.reload(),t.next()},function(e){n&&n.call(t,e)});else if(i.ticket){i.authorizationFlow=Gitana.OAuth2Http.TICKET,e.resetHttp(i);const o={GITANA_TICKET:i.ticket};e.gitanaGet("/auth/info",{},o,function(n){const i=new Gitana.AuthInfo(n);e.setAuthInfo(i),Gitana.deleteCookie("JSESSIONID","/"),c(e,t),t.reload(),t.next()},function(e){n&&n.call(t,e)})}else{const e="Unsupported authentication flow - you must provide either a username, authorization code, access token or select cookie-based authentication";if(!n)throw new Error(e);n.call(t,{message:e})}}.call(this),!1})},reloadAuthInfo:function(t){const n=this;n.gitanaGet("/auth/info",{},{},function(e){const i=new Gitana.AuthInfo(e);n.setAuthInfo(i),t()},function(n){t(null,n)})},clearAuthentication:function(){this.http.clearStorage&&this.http.clearStorage(),this.resetHttp(),Gitana.deleteCookie("GITANA_TICKET","/")},refreshAuthentication:function(t){this.http.refresh(function(n){t(n)})},destroy:function(){this.clearAuthentication()}}),Gitana.EVERYONE={name:"everyone",type:"GROUP"},Gitana.toCopyDependencyChain=function(t){let n=[];return"node"===t.getType()?n=(n=n.concat(Gitana.toCopyDependencyChain(t.getBranch()))).concat({typeId:"changeset",id:t.getSystemMetadata().getChangesetId()}):"association"===t.getType()?n=(n=n.concat(Gitana.toCopyDependencyChain(t.getBranch()))).concat({typeId:"changeset",id:t.getSystemMetadata().getChangesetId()}):"branch"===t.getType()?n=n.concat(Gitana.toCopyDependencyChain(t.getRepository())):"platform"===t.getType()||(n="stack"===t.getType()?n.concat(Gitana.toCopyDependencyChain(t.getPlatform())):(t.getType(),n.concat(Gitana.toCopyDependencyChain(t.getPlatform())))),n.push(Gitana.toDependencyObject(t)),n},Gitana.toDependencyObject=function(t){return{typeId:t.getType(),id:t.getId()}},Gitana.TypedIDConstants={},Gitana.TypedIDConstants.TYPE_APPLICATION="application",Gitana.TypedIDConstants.TYPE_EMAIL="email",Gitana.TypedIDConstants.TYPE_EMAIL_PROVIDER="emailprovider",Gitana.TypedIDConstants.TYPE_REGISTRATION="registration",Gitana.TypedIDConstants.TYPE_PAGE_RENDITION="pageRendition",Gitana.TypedIDConstants.TYPE_SETTINGS="settings",Gitana.TypedIDConstants.TYPE_MESSAGE="message",Gitana.TypedIDConstants.TYPE_CLUSTER="cluster",Gitana.TypedIDConstants.TYPE_JOB="job",Gitana.TypedIDConstants.TYPE_LOG_ENTRY="logEntry",Gitana.TypedIDConstants.TYPE_DIRECTORY="directory",Gitana.TypedIDConstants.TYPE_IDENTITY="identity",Gitana.TypedIDConstants.TYPE_CONNECTION="connection",Gitana.TypedIDConstants.TYPE_DOMAIN="domain",Gitana.TypedIDConstants.TYPE_DOMAIN_GROUP="group",Gitana.TypedIDConstants.TYPE_DOMAIN_USER="user",Gitana.TypedIDConstants.TYPE_PLATFORM="platform",Gitana.TypedIDConstants.TYPE_ACCESS_POLICY="accessPolicy",Gitana.TypedIDConstants.TYPE_AUTHENTICATION_GRANT="authenticationGrant",Gitana.TypedIDConstants.TYPE_BILLING_PROVIDERS_CONFIGURATION="billingProviderConfiguration",Gitana.TypedIDConstants.TYPE_DEPLOYMENT_RECEIVER="deployment-receiver",Gitana.TypedIDConstants.TYPE_DEPLOYMENT_PACKAGE="deployment-package",Gitana.TypedIDConstants.TYPE_DEPLOYMENT_STRATEGY="deployment-strategy",Gitana.TypedIDConstants.TYPE_DEPLOYMENT_TARGET="deployment-target",Gitana.TypedIDConstants.TYPE_CLIENT="client",Gitana.TypedIDConstants.TYPE_DESCRIPTOR="externalServiceDescriptor",Gitana.TypedIDConstants.TYPE_STACK="stack",Gitana.TypedIDConstants.TYPE_PROJECT="project",Gitana.TypedIDConstants.TYPE_SCHEDULED_WORK="scheduled-work",Gitana.TypedIDConstants.TYPE_REPORT="report",Gitana.TypedIDConstants.TYPE_WORKFLOW_INSTANCE="workflowInstance",Gitana.TypedIDConstants.TYPE_WORKFLOW_MODEL="workflowModel",Gitana.TypedIDConstants.TYPE_WORKFLOW_TASK="workflowTask",Gitana.TypedIDConstants.TYPE_WORKFLOW_COMMENT="workflowComment",Gitana.TypedIDConstants.TYPE_UICONFIG="uiconfig",Gitana.TypedIDConstants.TYPE_REGISTRAR="registrar",Gitana.TypedIDConstants.TYPE_METER="meter",Gitana.TypedIDConstants.TYPE_PLAN="plan",Gitana.TypedIDConstants.TYPE_TENANT="tenant",Gitana.TypedIDConstants.TYPE_REPOSITORY="repository",Gitana.TypedIDConstants.TYPE_ASSOCIATION="association",Gitana.TypedIDConstants.TYPE_BRANCH="branch",Gitana.TypedIDConstants.TYPE_CHANGESET="changeset",Gitana.TypedIDConstants.TYPE_NODE="node",Gitana.TypedIDConstants.TYPE_RELEASE="release",Gitana.TypedIDConstants.TYPE_MERGE_CONFLICT="mergeConflict",Gitana.TypedIDConstants.TYPE_DELETION="deletion",Gitana.TypedIDConstants.TYPE_VAULT="vault",Gitana.TypedIDConstants.TYPE_ARCHIVE="archive",Gitana.TypedIDConstants.TYPE_WEB_HOST="webhost",Gitana.TypedIDConstants.TYPE_AUTO_CLIENT_MAPPING="autoClientMapping",Gitana.TypedIDConstants.TYPE_TRUSTED_DOMAIN_MAPPING="trustedDomainMapping",Gitana.TypedIDConstants.TYPE_DEPLOYED_APPLICATION="deployedApplication",Gitana.handleJobCompletion=function(n,e,i,o,s){const r=function(){return Chain(e).readJob(i).then(function(){s&&s(this),!o||o&&("FINISHED"===this.getState()||"ERROR"===this.getState())?(n.loadFrom(this),n.next()):t.setTimeout(r,1e3)})};t.setTimeout(r,1e3)},Gitana.loadDefaultConfig=function(){},Gitana.MemoryCache=function(){const t={};return function(n,e){if(Gitana.isUndefined(e)||(e?t[n]=e:delete t[n]),"clear"===n){const n=[];for(let e in t)n.push(e);for(let e=0;e<n.length;e++)delete t[n[e]]}return t[n]}},Gitana.PLATFORM_CACHE=Gitana.MemoryCache(),Gitana.determinePlatformCacheKey=function(t,n){let e=null;return t.ticket?e=t.ticket:t.clientKey&&t.username?e=t.clientKey+":"+t.username:n&&(e="default"),e},Gitana.connect=function(t,n){Gitana.isFunction(t)&&(n=t,t=null);let e=!1;t||(t={},e=!0),Gitana.isString(t)&&(t={key:t}),void 0===t.invalidatePlatformCache&&(t.invalidatePlatformCache=!1),t.key||(t.key=Gitana.determinePlatformCacheKey(t,e)),void 0===t.loadAppHelper&&(t.loadAppHelper=!0);const i=function(e){if(t.loadAppHelper){const i={application:t.application?t.application:null,appCacheKey:null};if(Gitana.copyKeepers(i,Gitana.loadDefaultConfig()),Gitana.copyKeepers(i,this.getDriver().getOriginalConfiguration()),Gitana.copyKeepers(i,t),i.application){const t={application:i.application};i.appCacheKey&&(t.appCacheKey=i.appCacheKey),t.appCacheKey||e&&(t.appCacheKey=e+"_"+i.application),this.app(t,function(t){n&&n.call(this,t)})}else n&&n.call(this)}else n&&n.call(this)};t.key&&t.invalidatePlatformCache&&Gitana.disconnect(t.key);let o=null;return t.key&&(o=Gitana.PLATFORM_CACHE(t.key)),o?(o=Chain(new Gitana.Platform(o.getCluster(),o)),i.call(o,t.key),o):(e&&(t.cookie=!0),new Gitana(t).authenticate(t,function(e){e&&t.key&&Gitana.disconnect(t.key),n&&n.call(this,e)}).then(function(){i.call(this,t.key)}))},Gitana.disconnect=function(t,n){t||(t="default");const e=Gitana.PLATFORM_CACHE(t);if(e){n&&e.getDriver().gitanaPost("/auth/expire",{},{},function(){},function(t){});const i=[];for(let n in Gitana.APPS)0===n.indexOf(t+"_")&&i.push(n);for(let t=0;t<i.length;t++)delete Gitana.APPS[i[t]];const o=e.getDriver().getAuthInfo().getTicket();o&&Gitana.PLATFORM_CACHE(o,null),Gitana.PLATFORM_CACHE(t,null),e.getDriver().destroy()}},Gitana.requestCount=0,Gitana.VERSION="__VERSION__",t&&(t.Gitana=Gitana),Gitana.escape=function(t){return t&&(t=encodeURIComponent(t)),t},Gitana.reset=function(){Gitana.HTTP_TIMEOUT=12e4,Gitana.PLATFORM_CACHE("clear"),Gitana.deleteCookie("GITANA_TICKET")},Gitana.__INSERT_MARKER=null,Gitana.PREFER_GET_OVER_POST=!1,Gitana.XHR_WITH_CREDENTIALS=!0,Gitana.HTTP_X_CLOUDCMS_ORIGIN_HEADER=!0,Gitana.REFRESH_TOKEN_FAILURE_FN=function(t){t.clearStorage(),Gitana.deleteCookie("GITANA_TICKET")},Gitana.HTTP_PARAMS={},Gitana.HTTP_HEADERS={},Gitana.configureRequestHeaders=function(t,n,e,i){},Gitana.CSRF_TOKEN=null,Gitana.CSRF_COOKIE_NAMES=["CSRF-TOKEN","XSRF-TOKEN"],Gitana.CSRF_HEADER_NAME="X-CSRF-TOKEN",Gitana.DEFAULT_LOCALE=void 0,Gitana.defaultErrorHandler=function(t){console&&console.warn&&console.warn(t)},Gitana.AUTO_UPGRADE_TO_CLOUDFRONT=!0}(window),function(t){!function(){if(void 0!==t.location&&void 0===Gitana.autoConfigUri){let n=t.location.href,e=n.indexOf(t.location.pathname);(e=n.indexOf("/",e+2))>-1&&(n=n.substring(0,e)),n.indexOf("cloudcms.net")>-1&&(Gitana.autoConfigUri=n)}}()}(window),Gitana.Error=function(){},Gitana.Error.prototype=new Error,Gitana.Error.prototype.constructor=Gitana.Error,function(t){Gitana.HTTP_TIMEOUT=12e4,Gitana.HTTP_TIMEOUT_FN=function(t,n,e){},Gitana.HTTP_WORK_QUEUE_SIZE=1e5,Gitana.HTTP_XHR_FACTORY=function(){return null},Gitana.Http=Base.extend({constructor:function(){const t=new Gitana.WorkQueue(Gitana.HTTP_WORK_QUEUE_SIZE);this.invoke=function(n){const e=this;t(function(t){return function(n){const i=t.method||"GET",o=t.url,s=t.data,r=t.headers||{};let c=t.success||function(){},a=t.failure||function(){};const u=c;c=function(){n();const t=Array.prototype.slice.call(arguments);u.apply(e,t)};const h=a;a=function(){n();const t=Array.prototype.slice.call(arguments);h.apply(e,t)},r.Accept="application/json";let f=Gitana.CSRF_TOKEN;if(!f)for(let t=0;t<Gitana.CSRF_COOKIE_NAMES.length;t++){const n=Gitana.CSRF_COOKIE_NAMES[t],e=Gitana.readCookie(n);if(e){f=e;break}}if(f&&(r[Gitana.CSRF_HEADER_NAME]=f),void 0!==Gitana.XHR_CACHE_FN&&null!==Gitana.XHR_CACHE_FN){const t=Gitana.XHR_CACHE_FN({method:i,url:o,headers:r});if(t)return c(t)}Gitana.HTTP_X_CLOUDCMS_ORIGIN_HEADER&&"undefined"!=typeof window&&window.location&&window.location.origin&&(r["X-CLOUDCMS-ORIGIN"]=window.location.origin);const l=Gitana.Http.Request();Gitana.XHR_WITH_CREDENTIALS&&(l.withCredentials=!0);let p=null;Gitana.HTTP_TIMEOUT>0&&(p=setTimeout(function(){return l.abort(),Gitana.HTTP_TIMEOUT_FN&&Gitana.HTTP_TIMEOUT_FN(l,i,o),a({timeout:!0,text:"Http Request timed out",info:{method:i,url:o}},l),!1},Gitana.HTTP_TIMEOUT)),l.onreadystatechange=function(){if(4===l.readyState){let t,n=/^(.*?):\s*(.*?)\r?$/gm,e=r,s={},u="";if(l.getAllResponseHeaders)for(u=l.getAllResponseHeaders();t=n.exec(u);)s[t[1]]=t[2];else if(l.getResponseHeaders)for(let t=0,n=(u=l.getResponseHeaders()).length;t<n;++t)s[u[t][0]]=u[t][1];let h=!1;"Content-Type"in s&&"text/xml"===s["Content-Type"]&&(h=!0);const f={text:l.responseText,xml:h?l.responseXML:"",requestHeaders:e,responseHeaders:s};l.status,l.status>=200&&l.status<=226||304===l.status?(p&&clearTimeout(p),void 0!==Gitana.XHR_CACHE_FN&&null!==Gitana.XHR_CACHE_FN&&Gitana.XHR_CACHE_FN({method:i,url:o,headers:r},f),c(f,l)):l.status>=400?(p&&clearTimeout(p),a(f,l)):l.status>=300&&l.status<=303&&(p&&clearTimeout(p),a(f,l))}},Gitana.configureRequestHeaders&&Gitana.configureRequestHeaders(i,o,r,t),l.open(i,o,!0),l.setRequestHeader("X-Requested-With","XMLHttpRequest");for(const t in r)l.setRequestHeader(t,r[t]);try{l.send(s)}catch(t){console.log(t)}}}(n))}},request:function(t){return this.invoke(t)}}),Gitana.Http.toQueryString=function(t){let n="";if(t)for(const e in t){n.length>0&&(n+="&");let i=null;t[e]&&(i=t[e],i=Gitana.Http.URLEncode(i)),i&&(n+=e+"="+i)}return n},Gitana.Http.Request=function(){let n=null;return Gitana.HTTP_XHR_FACTORY&&(n=Gitana.HTTP_XHR_FACTORY()),n||(n=void 0!==t.Titanium&&void 0!==t.Titanium.Network.createHTTPClient?t.Titanium.Network.createHTTPClient():new t.XMLHttpRequest),n};const n=function(){};n.prototype={join:function(t){return t=t||"",this.values().join(t)},keys:function(){let t,n=[],e=this;for(t in e)e.hasOwnProperty(t)&&n.push(t);return n},values:function(){let t,n=[],e=this;for(t in e)e.hasOwnProperty(t)&&n.push(e[t]);return n},shift:function(){throw"not implemented"},unshift:function(){throw"not implemented"},push:function(){throw"not implemented"},pop:function(){throw"not implemented"},sort:function(){throw"not implemented"},ksort:function(t){let n,e,i,o=this,s=o.keys();for(void 0===t?s.sort():s.sort(t),n=0;n<s.length;n++)e=o[i=s[n]],delete o[i],o[i]=e;return o},toObject:function(){let t,n={},e=this;for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}};const e=function(t){let n,e=arguments.callee,i=this;if(!(this instanceof e))return new e(t);for(n in t)t.hasOwnProperty(n)&&(i[n]=t[n]);return i};e.prototype=new n,Gitana.Http.URI=function(t){let n,e,i,o,s,r,c,a=arguments.callee,u=this;if(!(this instanceof a))return new a(t);u.scheme="",u.host="",u.port="",u.path="",u.query=new Gitana.Http.QueryString,u.anchor="",null!==t&&(e=(n=t.match(/^([^:\/?#]+?:\/\/)*([^\/:?#]*)?(:[^\/?#]*)*([^?#]*)(\?[^#]*)?(#(.*))*/))[1],i=n[2],o=n[3],s=n[4],r=n[5],c=n[6],e=void 0!==e?e.replace("://","").toLowerCase():"http",o=o?o.replace(":",""):"https"===e?"443":"80",e="http"==e&&"443"===o?"https":e,r=r?r.replace("?",""):"",c=c?c.replace("#",""):"",("https"===e&&"443"!==o||"http"===e&&"80"!==o)&&(i=i+":"+o),u.scheme=e,u.host=i,u.port=o,u.path=s||"/",u.query.setQueryParams(r),u.anchor=c||"")},Gitana.Http.URI.prototype={scheme:"",host:"",port:"",path:"",query:"",anchor:"",toString:function(){const t=this.query+"";return this.scheme+"://"+this.host+this.path+(""!=t?"?"+t:"")+(""!==this.anchor?"#"+this.anchor:"")}},Gitana.Http.QueryString=function(t){let n,e=arguments.callee,i=this;if(!(this instanceof e))return new e(t);if(void 0!==t)for(n in t)t.hasOwnProperty(n)&&(i[n]=t[n]);return i},Gitana.Http.QueryString.prototype=new e,Gitana.Http.QueryString.prototype.toString=function(){let t,n=this,e=[],i="",o="",s=Gitana.Http.URLEncode;for(t in n.ksort(),n)n.hasOwnProperty(t)&&void 0!==t&&void 0!==n[t]&&(o=s(t)+"="+s(n[t]),e.push(o));return e.length>0&&(i=e.join("&")),i},Gitana.Http.QueryString.prototype.setQueryParams=function(t){let n,e,i,o,s=arguments,r=this;if(1===s.length){if("object"==typeof t)for(n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);else if("string"==typeof t)for(n=0,i=(e=t.split("&")).length;n<i;n++)r[(o=e[n].split("="))[0]]=o[1]}else for(n=0;n<arg_length;n+=2)r[s[n]]=s[n+1]},Gitana.Http.URLEncode=function(t){function n(t){let n=t.toString(16).toUpperCase();return n.length<2&&(n=0+n),"%"+n}if(!t)return"";let e,i,o=/[ \r\n!*"'();:@&=+$,\/?%#\[\]<>{}|`^\\\u0080-\uffff]/,s=(t+="").length,r=t.split("");for(e=0;e<s;e++)(i=r[e].match(o))&&((i=i[0].charCodeAt(0))<128?r[e]=n(i):i<2048?r[e]=n(192+(i>>6))+n(128+(63&i)):i<65536?r[e]=n(224+(i>>12))+n(128+(i>>6&63))+n(128+(63&i)):i<2097152&&(r[e]=n(240+(i>>18))+n(128+(i>>12&63))+n(128+(i>>6&63))+n(128+(63&i))));return r.join("")},Gitana.Http.URLDecode=function(t){return t?t.replace(/%[a-fA-F0-9]{2}/gi,function(t){return String.fromCharCode(parseInt(t.replace("%",""),16))}):""}}(this),Gitana.OAuth2Http=Gitana.Http.extend({constructor:function(t,n){const e=this;null!==n&&"string"!=typeof n||(n=new Gitana.OAuth2Http.Storage(n)),this.cookieMode=null,this.ticketMode=null,this.error=null,this.errorDescription=null,this.errorUri=null;let i="/oauth/token";t.tokenURL&&(i=t.tokenURL);let o=null;t.baseURL&&(o=t.baseURL);const s=t.clientKey,r=t.clientSecret;this.authorizationFlow=t.authorizationFlow||Gitana.OAuth2Http.AUTHORIZATION_CODE,t.requestedScope&&(this.requestedScope=t.requestedScope),this.authorizationFlow==Gitana.OAuth2Http.AUTHORIZATION_CODE&&(this.code=t.code,this.redirectUri=t.redirectUri),this.authorizationFlow==Gitana.OAuth2Http.PASSWORD&&(this.username=t.username,t.password?this.password=t.password:this.password=""),this.authorizationFlow==Gitana.OAuth2Http.COOKIE&&(this.cookieMode=!0),this.authorizationFlow==Gitana.OAuth2Http.TICKET&&(this.ticketMode=t.ticket),this.ticketMaxAge=t.ticketMaxAge,this.clearStorage=function(){n.clear()},this.accessToken=function(t){return n.poke("accessToken",t)},this.refreshToken=function(t){return n.poke("refreshToken",t)},this.grantedScope=function(t){return n.poke("grantedScope",t)},this.expiresIn=function(t){return n.poke("expiresIn",t)},this.grantTime=function(t){return n.poke("grantTime",t)},this.getClientAuthorizationHeader=function(){let t=s+":";return r&&(t+=r),"Basic "+Gitana.btoa(t)},this.getBearerAuthorizationHeader=function(){return"Bearer "+e.accessToken()},this.getPrefixedTokenURL=function(){return this.getPrefixedURL(i)},this.getPrefixedURL=function(t){let n=t;return o&&Gitana.startsWith(t,"/")&&(n=o+t),n},this.authorizationFlow==Gitana.OAuth2Http.TOKEN&&(this.accessToken()!==t.accessToken&&n.clear(),this.accessToken(t.accessToken)),this.base()},request:function(t){const n=this;void 0===Gitana.REFRESH_TOKEN_LOCKS&&(Gitana.REFRESH_TOKEN_LOCKS={}),void 0===Gitana.REFRESH_TOKEN_LOCK_REATTEMPT_MS&&(Gitana.REFRESH_TOKEN_LOCK_REATTEMPT_MS=75);const e=function(t,i){setTimeout(function(){if(Gitana.REFRESH_TOKEN_LOCKS[t])return e();const o=n.accessToken();s(o===i)},Gitana.REFRESH_TOKEN_LOCK_REATTEMPT_MS)},i=function(t,i){const s=n.refreshToken(),r=n.accessToken();if(Gitana.REFRESH_TOKEN_LOCKS[s])return e(s,r);Gitana.REFRESH_TOKEN_LOCKS[s]=!0,o(function(n){delete Gitana.REFRESH_TOKEN_LOCKS[s],t(n)},function(t,n){delete Gitana.REFRESH_TOKEN_LOCKS[s],i(t,n)})},o=function(t,e){const i={success:function(e){const i=JSON.parse(e.text);if(e.error)n.error=i.error,n.errorDescription=i.error_description,n.errorUri=i.error_uri;else{const t=i.access_token,e=i.refresh_token,o=i.expires_in,s=(new Date).getTime(),r=n.grantedScope();n.clearStorage(),n.accessToken(t),n.refreshToken(e),n.expiresIn(o),n.grantedScope(r),n.grantTime(s)}t(e)},failure:function(t,i){Gitana.REFRESH_TOKEN_FAILURE_FN(n,t,i),e(t,i)},headers:{Authorization:n.getClientAuthorizationHeader()},url:n.getPrefixedTokenURL(),method:Gitana.OAuth2Http.TOKEN_METHOD},o={};if(n.ticketMaxAge&&(o.ticketMaxAge=n.ticketMaxAge),"post"===Gitana.OAuth2Http.TOKEN_METHOD.toLowerCase()){i.headers["Content-Type"]="application/x-www-form-urlencoded";const t={grant_type:"refresh_token"};t.refresh_token=n.refreshToken(),n.requestedScope&&(t.scope=n.requestedScope),i.data=""+Gitana.Http.toQueryString(t)}else o.grant_type="refresh_token",o.refresh_token=n.refreshToken(),n.requestedScope&&(o.scope=n.requestedScope);const s=Gitana.Http.toQueryString(o);s&&(i.url.indexOf("?")>-1?i.url=i.url+"&"+s:i.url=i.url+"?"+s),n.invoke(i)},s=function(e){const o={};Gitana.copyInto(o,t),o.success=function(n){t.success(n)},o.failure=function(o,r){if(e){let e=!1,c=!1;if(o.text){let t={};try{t=JSON.parse(o.text)}catch(t){console.log("Error response is not json"),console.log(t),console.log(o.text),e=!0}t.error&&"invalid_token"===t.error&&(c=!0)}const a=401===o.code,u=400===o.code,h=403===o.code,f=o.timeout;(a||u||h||c||e&&!f)&&n.refreshToken()?i(function(){s(!1)},function(){t.failure(o,r)}):t.failure(o,r)}else t.failure(o,r)},o.headers||(o.headers={}),n.cookieMode||n.ticketMode||(o.headers.Authorization=n.getBearerAuthorizationHeader()),n.ticketMode&&(o.headers.GITANA_TICKET=encodeURIComponent(n.ticketMode)),o.url=n.getPrefixedURL(o.url),n.invoke(o)};let r=!1;n.accessToken()&&n.grantTime()&&n.expiresIn()&&n.grantTime()+1e3*n.expiresIn()-(new Date).getTime()<=2e4&&(r=!0),n.accessToken()&&!r||this.cookieMode||this.ticketMode?s(!0):n.refreshToken()?i(function(){s(!0)},function(n,e){t.failure(n,e)}):function(t,e){const i={success:function(t,i){const o=JSON.parse(t.text);if(o.error)return n.error=o.error,n.errorDescription=o.error_description,n.errorUri=o.error_uri,e(t,i);const r=o.access_token,c=o.refresh_token,a=o.expires_in,u=o.scope,h=(new Date).getTime();n.clearStorage(),n.accessToken(r),n.refreshToken(c),n.expiresIn(a),n.grantedScope(u),n.grantTime(h),s(!0)},failure:function(t,n){e(t,n)},headers:{Authorization:n.getClientAuthorizationHeader()},url:n.getPrefixedTokenURL(),method:Gitana.OAuth2Http.TOKEN_METHOD},o={};if(n.ticketMaxAge&&(o.ticketMaxAge=n.ticketMaxAge),"post"===Gitana.OAuth2Http.TOKEN_METHOD.toLowerCase()){i.headers["Content-Type"]="application/x-www-form-urlencoded";const t={};t.grant_type=n.authorizationFlow,n.requestedScope&&(t.scope=n.requestedScope),n.authorizationFlow===Gitana.OAuth2Http.AUTHORIZATION_CODE?(t.code=n.code,n.redirectUri&&(t.redirect_uri=n.redirectUri)):n.authorizationFlow===Gitana.OAuth2Http.PASSWORD&&(t.username=n.username,t.password=n.password),i.data=""+Gitana.Http.toQueryString(t)}else o.grant_type=n.authorizationFlow,n.requestedScope&&(o.scope=n.requestedScope),n.authorizationFlow===Gitana.OAuth2Http.AUTHORIZATION_CODE?(o.code=n.code,n.redirectUri&&(o.redirect_uri=n.redirectUri)):n.authorizationFlow===Gitana.OAuth2Http.PASSWORD&&(o.username=n.username,o.password=n.password);const r=Gitana.Http.toQueryString(o);r&&(i.url.indexOf("?")>-1?i.url=i.url+"&"+r:i.url=i.url+"?"+r),n.invoke(i)}(0,function(n,e){t.failure(n,e)})},refresh:function(t){const n=this;if(!n.refreshToken())return t({message:"The driver does not have a refresh token, cannot refresh"});const e={success:function(e){const i=JSON.parse(e.text);if(i.error)return n.error=i.error,n.errorDescription=i.error_description,n.errorUri=i.error_uri,t({error:n.error,message:n.errorDescription});{const e=i.access_token,o=i.refresh_token,s=i.expires_in,r=(new Date).getTime(),c=n.grantedScope();n.clearStorage(),n.accessToken(e),n.refreshToken(o),n.expiresIn(s),n.grantedScope(c),n.grantTime(r),t()}},failure:function(e,i){Gitana.REFRESH_TOKEN_FAILURE_FN&&Gitana.REFRESH_TOKEN_FAILURE_FN(n,e,i),n.clearStorage(),t({message:"Unable to refresh access token"})},headers:{Authorization:n.getClientAuthorizationHeader()},url:n.getPrefixedTokenURL(),method:Gitana.OAuth2Http.TOKEN_METHOD},i={};if(n.ticketMaxAge&&(i.ticketMaxAge=n.ticketMaxAge),"post"===Gitana.OAuth2Http.TOKEN_METHOD.toLowerCase()){e.headers["Content-Type"]="application/x-www-form-urlencoded";const t={grant_type:"refresh_token"};t.refresh_token=n.refreshToken(),n.requestedScope&&(t.scope=n.requestedScope),e.data=""+Gitana.Http.toQueryString(t)}else i.grant_type="refresh_token",i.refresh_token=n.refreshToken(),n.requestedScope&&(i.scope=n.requestedScope);const o=Gitana.Http.toQueryString(i);o&&(e.url.indexOf("?")>-1?e.url=e.url+"&"+o:e.url=e.url+"?"+o),n.invoke(e)}}),Gitana.OAuth2Http.Storage=function(t){const n=function(){const t={};return{removeItem:function(n){delete t[n]},getItem:function(n){return t[n]},setItem:function(n,e){t[n]=e}}}(),e=function(){return"session"===t&&function(){try{return"sessionStorage"in window&&null!==window.sessionStorage}catch(t){return!1}}()?sessionStorage:"local"===t&&function(){try{return"localStorage"in window&&null!==window.localStorage}catch(t){return!1}}()?localStorage:n};return{clear:function(){e().setItem("gitanaAuthState",""),e().removeItem("gitanaAuthState")},poke:function(t,n){let i={};const o=e().getItem("gitanaAuthState");o&&""!==o&&(i=JSON.parse(o));let s=!1;return null!=n?(i[t]=n,s=!0):null===n&&(delete i[t],s=!0),s&&e().setItem("gitanaAuthState",JSON.stringify(i)),i[t]}}},Gitana.OAuth2Http.PASSWORD="password",Gitana.OAuth2Http.AUTHORIZATION_CODE="authorization_code",Gitana.OAuth2Http.TOKEN="token",Gitana.OAuth2Http.COOKIE="cookie",Gitana.OAuth2Http.TICKET="ticket",Gitana.OAuth2Http.TOKEN_METHOD="POST",window,Gitana.Methods={},Gitana.Methods.listAttachments=function(t){return t||(t=Gitana.BinaryAttachmentMap),function(n){const e=this,i=this.subchain(new t(this));if(n){const t=e.getSystemMetadata().attachments;if(t)for(const n in t)i[n].attachmentId=n}else i.then(function(){const t=this;return e.getDriver().gitanaGet(e.getUri()+"/attachments",null,{},function(n){t.handleResponse(n),t.next()}),!1});return i}},Gitana.Methods.attach=function(t,n){return t||(t=Gitana.BinaryAttachment),function(e,i,o){const s=this;e||(e="default");const r=this.subchain(new t(this));return r.then(function(){const t={};n&&n(t);let c=s.getUri()+"/attachments/"+e;o&&o.read&&"function"==typeof o.read&&Gitana.streamUpload?this.subchain(s).then(function(){const t=this;return c=s.getDriver().baseURL+c,Gitana.streamUpload(s.getDriver(),o,c,i,function(){Chain(s).reload().then(function(){this.listAttachments().then(function(){this.select(e).then(function(){r.handleResponse(this),t.next()})})})}),!1}):this.chainUpload(this,c,t,i,o).then(function(){this.subchain(s).listAttachments().then(function(){this.select(e).then(function(){r.handleResponse(this)})})})}),r}},Gitana.Methods.unattach=function(){return function(t){return this.then(function(){this.chainDelete(this,this.getUri()+"/attachments/"+t).then(function(){})})}},Gitana.Methods.getPreviewUri=function(t){return t||(t="preview"),function(n,e){let i=this.getDriver().baseURL+this.getUri()+"/"+t+"/"+n;if(e){let t=!0;for(const n in e){i+=t?"?":"&";const o=e[n];o&&(i+=n+"="+o),t=!1}}return i}},function(t){const n=t.Gitana;n.ObjectFactory=Base.extend({constructor:function(){this.create=function(t,n,e){return new t(n,e)}},platformDataStoreMap:function(t,e){return this.create(n.PlatformDataStoreMap,t,e)},platformDataStore:function(t,n){return this[n.datastoreTypeId](t,n)},platform:function(t,e){return this.create(n.Platform,t,e)},job:function(t,e){let i=null;return e&&(i=n.isString(e)?e:e.type),"copy"===i?this.create(n.CopyJob,t,e):"export"===i?this.create(n.TransferExportJob,t,e):"import"===i?this.create(n.TransferImportJob,t,e):this.create(n.Job,t,e)},jobMap:function(t,e){return this.create(n.JobMap,t,e)},logEntry:function(t,e){return this.create(n.LogEntry,t,e)},logEntryMap:function(t,e){return this.create(n.LogEntryMap,t,e)},stack:function(t,e){return this.create(n.Stack,t,e)},stackMap:function(t,e){return this.create(n.StackMap,t,e)},project:function(t,e){return this.create(n.Project,t,e)},projectMap:function(t,e){return this.create(n.ProjectMap,t,e)},uiConfig:function(t,e){return this.create(n.UIConfig,t,e)},uiConfigMap:function(t,e){return this.create(n.UIConfigMap,t,e)},scheduledWork:function(t,e){return this.create(n.ScheduledWork,t,e)},scheduledWorkMap:function(t,e){return this.create(n.ScheduledWorkMap,t,e)},report:function(t,e){return this.create(n.Report,t,e)},reportMap:function(t,e){return this.create(n.ReportMap,t,e)},repository:function(t,e){return this.create(n.Repository,t,e)},repositoryMap:function(t,e){return this.create(n.RepositoryMap,t,e)},domain:function(t,e){return this.create(n.Domain,t,e)},domainMap:function(t,e){return this.create(n.DomainMap,t,e)},vault:function(t,e){return this.create(n.Vault,t,e)},vaultMap:function(t,e){return this.create(n.VaultMap,t,e)},registrar:function(t,e){return this.create(n.Registrar,t,e)},registrarMap:function(t,e){return this.create(n.RegistrarMap,t,e)},directory:function(t,e){return this.create(n.Directory,t,e)},directoryMap:function(t,e){return this.create(n.DirectoryMap,t,e)},application:function(t,e){return this.create(n.Application,t,e)},applicationMap:function(t,e){return this.create(n.ApplicationMap,t,e)},webhost:function(t,e){return this.create(n.WebHost,t,e)},webhostMap:function(t,e){return this.create(n.WebHostMap,t,e)},autoClientMapping:function(t,e){return this.create(n.AutoClientMapping,t,e)},autoClientMappingMap:function(t,e){return this.create(n.AutoClientMappingMap,t,e)},trustedDomainMapping:function(t,e){return this.create(n.TrustedDomainMapping,t,e)},trustedDomainMappingMap:function(t,e){return this.create(n.TrustedDomainMappingMap,t,e)},deployedApplication:function(t,e){return this.create(n.DeployedApplication,t,e)},deployedApplicationMap:function(t,e){return this.create(n.DeployedApplicationMap,t,e)},descriptor:function(t,e){return this.create(n.Descriptor,t,e)},descriptorMap:function(t,e){return this.create(n.DescriptorMap,t,e)},client:function(t,e){const i=this.create(n.Client,t,e);return n.stampInto(i,n.ClientMethods),i},clientMap:function(t,e){return this.create(n.ClientMap,t,e)},accessPolicy:function(t,e){return this.create(n.AccessPolicy,t,e)},accessPolicyMap:function(t,e){return this.create(n.AccessPolicyMap,t,e)},authenticationGrant:function(t,e){return this.create(n.AuthenticationGrant,t,e)},authenticationGrantMap:function(t,e){return this.create(n.AuthenticationGrantMap,t,e)},billingProviderConfiguration:function(t,e){return this.create(n.BillingProviderConfiguration,t,e)},billingProviderConfigurationMap:function(t,e){return this.create(n.BillingProviderConfigurationMap,t,e)},workflowModel:function(t,e){return this.create(n.WorkflowModel,t,e)},workflowModelMap:function(t,e){return this.create(n.WorkflowModelMap,t,e)},workflowInstance:function(t,e){return this.create(n.WorkflowInstance,t,e)},workflowInstanceMap:function(t,e){return this.create(n.WorkflowInstanceMap,t,e)},workflowTask:function(t,e){return this.create(n.WorkflowTask,t,e)},workflowTaskMap:function(t,e){return this.create(n.WorkflowTaskMap,t,e)},workflowComment:function(t,e){return this.create(n.WorkflowComment,t,e)},workflowCommentMap:function(t,e){return this.create(n.WorkflowCommentMap,t,e)},deploymentReceiver:function(t,e){return this.create(n.DeploymentReceiver,t,e)},deploymentReceiverMap:function(t,e){return this.create(n.DeploymentReceiverMap,t,e)},deploymentPackage:function(t,e){return this.create(n.DeploymentPackage,t,e)},deploymentPackageMap:function(t,e){return this.create(n.DeploymentPackageMap,t,e)},deploymentStrategy:function(t,e){return this.create(n.DeploymentStrategy,t,e)},deploymentStrategyMap:function(t,e){return this.create(n.DeploymentStrategyMap,t,e)},deploymentTarget:function(t,e){return this.create(n.DeploymentTarget,t,e)},deploymentTargetMap:function(t,e){return this.create(n.DeploymentTargetMap,t,e)},changeset:function(t,e){return this.create(n.Changeset,t,e)},branch:function(t,e){return this.create(n.Branch,t,e)},node:function(t,e){let i=null;if(e){n.isString(e)&&(e={_type:e});const t=e._type;t&&n.ObjectFactory.registry[t]&&(i=n.ObjectFactory.registry[t]),i||t&&n.startsWith(t,"a:")&&(i=n.Association),i||e.__is_association&&e.__is_association()&&(i=n.Association)}return i||(i=n.Node),this.create(i,t,e)},association:function(t,e){return this.create(n.Association,t,e)},release:function(t,e){return this.create(n.Release,t,e)},mergeConflict:function(t,e){return this.create(n.MergeConflict,t,e)},deletion:function(t,e){return this.create(n.Deletion,t,e)},branchMap:function(t,e){return this.create(n.BranchMap,t,e)},changesetMap:function(t,e){return this.create(n.ChangesetMap,t,e)},releaseMap:function(t,e){return this.create(n.ReleaseMap,t,e)},mergeConflictMap:function(t,e){return this.create(n.MergeConflictMap,t,e)},nodeMap:function(t,e){return this.create(n.NodeMap,t,e)},deletionMap:function(t,e){return this.create(n.DeletionMap,t,e)},definition:function(t,e){return this.create(n.Definition,t,e)},form:function(t,e){return this.create(n.Form,t,e)},traversalResults:function(t,e){return this.create(n.TraversalResults,t,e)},domainPrincipal:function(t,e){const i=this.create(n.DomainPrincipal,t,e);return e&&this.extendPrincipal(i),i},domainPrincipalMap:function(t,e){return this.create(n.PrincipalMap,t,e)},extendPrincipal:function(t){t.getType()&&"Gitana.DomainPrincipal"===t.objectType()&&("USER"===t.getType()?n.stampInto(t,n.DomainUser):"GROUP"===t.getType()&&n.stampInto(t,n.DomainGroup))},archive:function(t,e){return this.create(n.Archive,t,e)},archiveMap:function(t,e){return this.create(n.ArchiveMap,t,e)},team:function(t,e,i){return new n.Team(t,e,i)},teamMap:function(t,e,i){return new n.TeamMap(t,e,i)},activity:function(t,e){return new n.Activity(t,e)},activityMap:function(t,e){return new n.ActivityMap(t,e)},role:function(t,e,i){return new n.Role(t,e,i)},roleMap:function(t,e,i){return new n.RoleMap(t,e,i)},resultMap:function(t,e){return new n.ResultMap(t,e)},tenant:function(t,e){return this.create(n.Tenant,t,e)},tenantMap:function(t,e){return this.create(n.TenantMap,t,e)},plan:function(t,e){return this.create(n.Plan,t,e)},planMap:function(t,e){return this.create(n.PlanMap,t,e)},meter:function(t,e){return this.create(n.Meter,t,e)},meterMap:function(t,e){return this.create(n.MeterMap,t,e)},identity:function(t,e){return this.create(n.Identity,t,e)},identityMap:function(t,e){return this.create(n.IdentityMap,t,e)},connection:function(t,e){return this.create(n.Connection,t,e)},connectionMap:function(t,e){return this.create(n.ConnectionMap,t,e)},settings:function(t,e){return this.create(n.Settings,t,e)},settingsMap:function(t,e){return this.create(n.SettingsMap,t,e)},registration:function(t,e){return this.create(n.Registration,t,e)},registrationMap:function(t,e){return this.create(n.RegistrationMap,t,e)},pageRendition:function(t,e){return this.create(n.PageRendition,t,e)},pageRenditionMap:function(t,e){return this.create(n.PageRenditionMap,t,e)},email:function(t,e){return this.create(n.Email,t,e)},emailMap:function(t,e){return this.create(n.EmailMap,t,e)},emailProvider:function(t,e){return this.create(n.EmailProvider,t,e)},emailProviderMap:function(t,e){return this.create(n.EmailProviderMap,t,e)},message:function(t,e){return this.create(n.Message,t,e)},messageMap:function(t,e){return this.create(n.MessageMap,t,e)}}),n.ObjectFactory.registry={},n.ObjectFactory.register=function(t,e){n.ObjectFactory.registry[t]=e}}(window),function(t){const n=t.Gitana;n.AbstractPlatformDataStore=n.ContainedDataStore.extend({constructor:function(t,n){this.base(t,n),this.getPlatform=function(){return t},this.getPlatformId=function(){return t.getId()},this.getCluster=function(){return t.getCluster()},this.getClusterId=function(){return t.getClusterId()}},ref:function(){return this.getType()+"://"+this.getPlatformId()+"/"+this.getId()},copy:function(t,e,i){const o=this,s={sources:n.toCopyDependencyChain(this),targets:n.toCopyDependencyChain(t)};i&&(s.configuration=i);const r=this.getFactory().job(this.getCluster(),"copy");return this.subchain(r).then(function(){const t=this;return this.getDriver().gitanaPost("/tools/copy?schedule=ASYNCHRONOUS",{},s,function(i){n.handleJobCompletion(t,o.getCluster(),i.getId(),!e)},function(t){o.httpError(t)}),!1})},findStack:function(){return this.subchain(this.getPlatform()).findStackForDataStore(this.getType(),this.getId())},loadInfo:function(t){return this.chainGetResponse(this,function(){return this.getUri()+"/info"},{}).then(function(n){t(n)})}})}(window),function(t){const n=t.Gitana;n.AbstractPlatformObject=n.AbstractSelfableACLObject.extend({constructor:function(t,n){this.base(t.getDriver(),n),this.getPlatform=function(){return t},this.getPlatformId=function(){return t.getId()},this.getCluster=function(){return t.getCluster()},this.getClusterId=function(){return t.getClusterId()}},ref:function(){return this.getType()+"://"+this.getPlatformId()+"/"+this.getId()},exportArchive:function(t){const e=this;let i=t.vault;n.isString(i)||(i=i.getId());const o=t.group,s=t.artifact,r=t.version,c=t.configuration?t.configuration:{},a=!t.async,u=t.title,h=t.description,f=t.published,l=this.getFactory().job(this.getCluster(),"export");return this.subchain(l).then(function(){const t=this,l={};return l.vault=i,l.group=o,l.artifact=s,l.version=r,l.schedule="ASYNCHRONOUS",u&&(l.title=u),h&&(l.description=h),f&&(l.published=f),this.getDriver().gitanaPost(e.getUri()+"/export",l,c,function(i){n.handleJobCompletion(t,e.getCluster(),i.getId(),a)},function(t){e.httpError(t)}),!1})},importArchive:function(t,e){const i=this;let o=t.vault;n.isString(o)||(o=o.getId());const s=t.group,r=t.artifact,c=t.version,a=t.configuration?t.configuration:{},u=!t.async,h=this.getFactory().job(this.getCluster(),"import");return this.subchain(h).then(function(){const t=this;return this.getDriver().gitanaPost(i.getUri()+"/import?vault="+o+"&group="+s+"&artifact="+r+"&version="+c+"&schedule=ASYNCHRONOUS",{},a,function(o){n.handleJobCompletion(t,i.getCluster(),o.getId(),u,e)},function(t){i.httpError(t)}),!1})},copy:function(t,e,i){const o=this,s={sources:n.toCopyDependencyChain(this),targets:n.toCopyDependencyChain(t)};i&&(s.configuration=i);const r=this.getFactory().job(this.getCluster(),"copy");return this.subchain(r).then(function(){const t=this;return this.getDriver().gitanaPost("/tools/copy?schedule=ASYNCHRONOUS",{},s,function(i){n.handleJobCompletion(t,o.getCluster(),i.getId(),!e)},function(t){o.httpError(t)}),!1})}})}(window),function(t){const n=t.Gitana;n.AbstractPlatformObjectMap=n.AbstractMap.extend({constructor:function(t,n){this.getPlatform=function(){return t},this.getPlatformId=function(){return t.getId()},this.getCluster=function(){return t.getCluster()},this.getClusterId=function(){return t.getClusterId()},this.base(t.getDriver(),n)}})}(window),function(t){const n=t.Gitana;n.AccessPolicy=n.AbstractPlatformObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.AccessPolicy"}},getType:function(){return n.TypedIDConstants.TYPE_ACCESS_POLICY},getUri:function(){return"/access/policies/"+this.getId()},clone:function(){return this.getFactory().accessPolicy(this.getPlatform(),this)}})}(window),function(t){var n=t.Gitana;n.AccessPolicyMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.AccessPolicyMap"},this.base(t,n)},clone:function(){return this.getFactory().accessPolicyMap(this.getPlatform(),this)},buildObject:function(t){return this.getFactory().accessPolicy(this.getPlatform(),t)}})}(window),function(t){const n=t.Gitana;n.AuthenticationGrant=n.AbstractPlatformObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.AuthenticationGrant"}},getType:function(){return n.TypedIDConstants.TYPE_AUTHENTICATION_GRANT},getUri:function(){return"/auth/grants/"+this.getId()},clone:function(){return this.getFactory().authenticationGrant(this.getPlatform(),this)},getKey:function(){return this.get("key")},getSecret:function(){return this.get("secret")},getPrincipalDomainId:function(){return this.get("principalDomainId")},getPrincipalId:function(){return this.get("principalId")},getClientId:function(){return this.get("clientId")},getEnabled:function(){return this.get("enabled")},getAllowOpenDriverAuthentication:function(){return this.get("allowOpenDriverAuthentication")}})}(window),function(t){const n=t.Gitana;n.AuthenticationGrantMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.AuthenticationGrantMap"},this.base(t,n)},clone:function(){return this.getFactory().authenticationGrantMap(this.getPlatform(),this)},buildObject:function(t){return this.getFactory().authenticationGrant(this.getPlatform(),t)}})}(window),function(t){const n=t.Gitana;n.BillingProviderConfiguration=n.AbstractPlatformObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.BillingProviderConfiguration"}},getType:function(){return n.TypedIDConstants.TYPE_BILLING_PROVIDER_CONFIGURATION},getUri:function(){return"/billing/configurations/"+this.getId()},clone:function(){return this.getFactory().billingProviderConfiguration(this.getPlatform(),this)}})}(window),function(t){const n=t.Gitana;n.BillingProviderConfigurationMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.BillingProviderConfigurationMap"},this.base(t,n)},clone:function(){return this.getFactory().billingProviderConfigurationMap(this.getPlatform(),this)},buildObject:function(t){return this.getFactory().billingProviderConfiguration(this.getPlatform(),t)}})}(window),function(t){const n=t.Gitana;n.Client=n.AbstractPlatformObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.Client"}},getType:function(){return n.TypedIDConstants.TYPE_CLIENT},getUri:function(){return"/clients/"+this.getId()},clone:function(){return this.getFactory().client(this.getPlatform(),this)},getAuthorizedGrantTypes:function(){return this.get("authorizedGrantTypes")},getScope:function(){return this.get("scope")},getAllowOpenDriverAuthentication:function(){return this.get("allowOpenDriverAuthentication")},getEnabled:function(){return this.get("enabled")},listAuthenticationGrants:function(t){const e={};t&&n.copyInto(e,t),e.clientId=this.getId();const i=this.getFactory().authenticationGrantMap(this.getPlatform());return this.chainGet(i,"/auth/grants",e)}})}(window),function(t){const n=t.Gitana;n.ClientMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.ClientMap"},this.base(t,n)},clone:function(){return this.getFactory().clientMap(this.getPlatform(),this)},buildObject:function(t){return this.getFactory().client(this.getPlatform(),t)}})}(window),function(t){const n=t.Gitana;n.DeploymentPackage=n.AbstractPlatformObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.DeploymentPackage"}},getType:function(){return n.TypedIDConstants.TYPE_DEPLOYMENT_PACKAGE},getUri:function(){return"/deployment/packages/"+this.getId()},clone:function(){return this.getFactory().deploymentPackage(this.getPlatform(),this)}})}(window),function(t){const n=t.Gitana;n.DeploymentPackageMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.DeploymentPackageMap"},this.base(t,n)},clone:function(){return this.getFactory().deploymentPackageMap(this.getPlatform(),this)},buildObject:function(t){return this.getFactory().deploymentPackage(this.getPlatform(),t)}})}(window),function(t){const n=t.Gitana;n.DeploymentReceiver=n.AbstractPlatformObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.DeploymentReceiver"}},getType:function(){return n.TypedIDConstants.TYPE_DEPLOYMENT_RECEIVER},getUri:function(){return"/deployment/receivers/"+this.getId()},clone:function(){return this.getFactory().deploymentReceiver(this.getPlatform(),this)}})}(window),function(t){const n=t.Gitana;n.DeploymentReceiverMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.DeploymentReceiverMap"},this.base(t,n)},clone:function(){return this.getFactory().deploymentReceiverMap(this.getPlatform(),this)},buildObject:function(t){return this.getFactory().deploymentReceiver(this.getPlatform(),t)}})}(window),function(t){const n=t.Gitana;n.DeploymentStrategy=n.AbstractPlatformObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.DeploymentStrategy"}},getType:function(){return n.TypedIDConstants.TYPE_DEPLOYMENT_STRATEGY},getUri:function(){return"/deployment/strategies/"+this.getId()},clone:function(){return this.getFactory().deploymentStrategy(this.getPlatform(),this)}})}(window),function(t){const n=t.Gitana;n.DeploymentStrategyMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.DeploymentStrategyMap"},this.base(t,n)},clone:function(){return this.getFactory().deploymentStrategyMap(this.getPlatform(),this)},buildObject:function(t){return this.getFactory().deploymentStrategy(this.getPlatform(),t)}})}(window),function(t){const n=t.Gitana;n.DeploymentTarget=n.AbstractPlatformObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.DeploymentTarget"}},getType:function(){return n.TypedIDConstants.TYPE_DEPLOYMENT_TARGET},getUri:function(){return"/deployment/targets/"+this.getId()},clone:function(){return this.getFactory().deploymentTarget(this.getPlatform(),this)}})}(window),function(t){const n=t.Gitana;n.DeploymentTargetMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.DeploymentTargetMap"},this.base(t,n)},clone:function(){return this.getFactory().deploymentTargetMap(this.getPlatform(),this)},buildObject:function(t){return this.getFactory().deploymentTarget(this.getPlatform(),t)}})}(window),function(t){const n=t.Gitana;n.Descriptor=n.AbstractPlatformObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.Descriptor"}},getType:function(){return n.TypedIDConstants.TYPE_DESCRIPTOR},getUri:function(){return"/descriptors/"+this.getId()},clone:function(){return this.getFactory().descriptor(this.getPlatform(),this)},test:function(t,n){const e=this;return"function"==typeof t&&(n=t,t={}),this.chainPostResponse(this,function(){return e.getUri()+"/test"},{},t).then(function(t){n(t)})}})}(window),function(t){const n=t.Gitana;n.DescriptorMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.DescriptorMap"},this.base(t,n)},clone:function(){return this.getFactory().descriptorMap(this.getPlatform(),this)},buildObject:function(t){return this.getFactory().descriptor(this.getPlatform(),t)}})}(window),function(t){t.Gitana.ClientMethods={getKey:function(){return this.get("key")},getSecret:function(){return this.get("secret")},getDomainUrls:function(){return this.get("domainUrls")},getIsTenantDefault:function(){return this.get("isTenantDefault")},getDefaultTenantId:function(){return this.get("defaultTenantId")},getAuthorizedGrantTypes:function(){return this.get("authorizedGrantTypes")},getScope:function(){return this.get("scope")},getRegisteredRedirectUri:function(){return this.get("registeredRedirectUri")},getAllowOpenDriverAuthentication:function(){return this.get("allowOpenDriverAuthentication")},getEnabled:function(){return this.get("enabled")},getAllowAutoApprovalForImplicitFlow:function(){return this.get("allowAutoApprovalForImplicitFlow")}}}(window),function(t){const n=t.Gitana;n.Platform=n.ContainedDataStore.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.Platform"},this.base(t,n),this.getCluster=function(){return t},this.getClusterId=function(){return t.getId()}},getPlatform:function(){return this},readCluster:function(){return this.subchain(this.getCluster())},getUri:function(){return""},getType:function(){return n.TypedIDConstants.TYPE_PLATFORM},clone:function(){return this.getFactory().platform(this.getCluster(),this)},del:function(){return this},reload:function(){return this.chainReload(null,function(){return this.getUri()+"/"})},update:function(){return this.chainUpdate(null,function(){return this.getUri()+"/"})},readPrimaryDomain:function(){const t=this,n=this.getFactory().domain(this);return this.chainGet(n,function(){return t.getUri()+"/domains/primary"})},loadInfo:function(t){return this.chainGetResponse(this,function(){return"/info"},{}).then(function(n){t(n)})},listRepositories:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().repositoryMap(this);return this.chainGet(i,"/repositories",e)},readRepository:function(t){const n=this.getFactory().repository(this);return this.chainGet(n,"/repositories/"+t)},createRepository:function(t){const n=this.getFactory().repository(this);return this.chainCreate(n,t,"/repositories")},queryRepositories:function(t,e){const i=this.getFactory().repositoryMap(this),o={};return e&&n.copyInto(o,e),this.chainPost(i,"/repositories/query",o,t)},checkRepositoryPermissions:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/repositories/permissions/check"},{},e).then(function(t){n.call(this,t.results)})},checkRepositoryAuthorities:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/repositories/authorities/check"},{},e).then(function(t){n.call(this,t.results)})},listDomains:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().domainMap(this);return this.chainGet(i,"/domains",e)},readDomain:function(t){const n=this.getFactory().domain(this);return this.chainGet(n,"/domains/"+t)},createDomain:function(t){const n=this.getFactory().domain(this);return this.chainCreate(n,t,"/domains")},queryDomains:function(t,e){const i=this.getFactory().domainMap(this),o={};return e&&n.copyInto(o,e),this.chainPost(i,"/domains/query",o,t)},checkDomainPermissions:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/domains/permissions/check"},{},e).then(function(t){n.call(this,t.results)})},checkDomainAuthorities:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/domains/authorities/check"},{},e).then(function(t){n.call(this,t.results)})},listVaults:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().vaultMap(this);return this.chainGet(i,"/vaults",e)},readVault:function(t){const n=this.getFactory().vault(this);return this.chainGet(n,"/vaults/"+t)},createVault:function(t){const n=this.getFactory().vault(this);return this.chainCreate(n,t,"/vaults")},queryVaults:function(t,e){const i=this.getFactory().vaultMap(this),o={};return e&&n.copyInto(o,e),this.chainPost(i,"/vaults/query",o,t)},checkVaultPermissions:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/vaults/permissions/check"},{},e).then(function(t){n.call(this,t.results)})},checkVaultAuthorities:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/vaults/authorities/check"},{},e).then(function(t){n.call(this,t.results)})},authenticate:function(t,n){return this.getDriver().authenticate(t,n)},logout:function(t){return this.subchain().then(function(){const e=this.getDriver().platformCacheKey;e&&n.disconnect(e,t),this.getDriver().clearAuthentication(),delete this.getDriver().platformCacheKey})},listStacks:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().stackMap(this);return this.chainGet(i,"/stacks",e)},readStack:function(t){const n=this.getFactory().stack(this);return this.chainGet(n,"/stacks/"+t)},createStack:function(t){t||(t={});const n=this.getFactory().stack(this);return this.chainCreate(n,t,"/stacks")},queryStacks:function(t,e){const i={};e&&n.copyInto(i,e);const o=this.getFactory().stackMap(this);return this.chainPost(o,function(){return"/stacks/query"},i,t)},findStackForDataStore:function(t,n){const e=this.getFactory().stack(this);return this.chainGet(e,"/stacks/find/"+t+"/"+n)},checkStackPermissions:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/stacks/permissions/check"},{},e).then(function(t){n.call(this,t.results)})},checkStackAuthorities:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/stacks/authorities/check"},{},e).then(function(t){n.call(this,t.results)})},listProjects:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().projectMap(this);return this.chainGet(i,"/projects",e)},readProject:function(t){const n=this.getFactory().project(this);return this.chainGet(n,"/projects/"+t)},createProject:function(t){t||(t={});const n=this.getFactory().project(this);return this.chainCreate(n,t,"/projects")},startCreateProject:function(t,n,e){return t||(t={}),n||(n={}),this.chainPostResponse(this,function(){return"/projects/start"},n,t).then(function(t){const n=t._doc;e(n)})},queryProjects:function(t,e){const i={};e&&n.copyInto(i,e);const o=this.getFactory().projectMap(this);return this.chainPost(o,function(){return"/projects/query"},i,t)},checkProjectPermissions:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/projects/permissions/check"},{},e).then(function(t){n.call(this,t.results)})},checkProjectAuthorities:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/projects/authorities/check"},{},e).then(function(t){n.call(this,t.results)})},listProjectTypes:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().projectMap(this);return this.chainGet(i,"/projecttypes",e)},queryLogEntries:function(t,e){const i=this;t||(t={});const o=this.getFactory().logEntryMap(this.getCluster()),s={};return e&&n.copyInto(s,e),this.chainPost(o,function(){return i.getUri()+"/logs/query"},s,t)},readLogEntry:function(t){const n=this,e=this.getFactory().logEntry(this.getCluster());return this.chainGet(e,function(){return n.getUri()+"/logs/"+t})},readLog:function(t){return this.chainGetResponseText(this,function(){return"/logs/logfile"}).then(function(n){t.call(this,n)})},createLogEntry:function(t,n,e){e||(e={}),e.message=t,e.level=n;const i=this.getFactory().logEntry(this.getCluster());return this.chainCreate(i,e,"/logs")},postLogEntry:function(t,n,e){const i=this;return e||(e={}),e.message=t,e.level=n,this.chainPostEmpty(null,function(){return i.getUri()+"/logs"},{},e,"application/json")},listRegistrars:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().registrarMap(this);return this.chainGet(i,"/registrars",e)},readRegistrar:function(t){const n=this.getFactory().registrar(this);return this.chainGet(n,"/registrars/"+t)},createRegistrar:function(t){const n=this.getFactory().registrar(this);return this.chainCreate(n,t,"/registrars")},queryRegistrars:function(t,e){const i=this.getFactory().registrarMap(this),o={};return e&&n.copyInto(o,e),this.chainPost(i,"/registrars/query",o,t)},checkRegistrarPermissions:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/registrars/permissions/check"},{},e).then(function(t){n.call(this,t.results)})},checkRegistrarAuthorities:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/registrars/authorities/check"},{},e).then(function(t){n.call(this,t.results)})},listApplications:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().applicationMap(this);return this.chainGet(i,"/applications",e)},readApplication:function(t){const n=this.getFactory().application(this);return this.chainGet(n,function(){return"/applications/"+t})},createApplication:function(t){const n=this.getFactory().application(this);return this.chainCreate(n,t,"/applications")},queryApplications:function(t,e){const i=this.getFactory().applicationMap(this),o={};return e&&n.copyInto(o,e),this.chainPost(i,"/applications/query",o,t)},checkApplicationPermissions:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/applications/permissions/check"},{},e).then(function(t){n.call(this,t.results)})},checkApplicationAuthorities:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/applications/authorities/check"},{},e).then(function(t){n.call(this,t.results)})},listApplicationTypes:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().applicationMap(this);return this.chainGet(i,"/applicationtypes",e)},listClients:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().clientMap(this);return this.chainGet(i,"/clients",e)},readClient:function(t){const n=this.getFactory().client(this);return this.chainGet(n,"/clients/"+t)},createClient:function(t){t||(t={});const n=this.getFactory().client(this);return this.chainCreate(n,t,"/clients")},queryClients:function(t,e){const i={};e&&n.copyInto(i,e);const o=this.getFactory().clientMap(this);return this.chainPost(o,function(){return"/clients/query"},i,t)},checkClientPermissions:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/clients/permissions/check"},{},e).then(function(t){n.call(this,t.results)})},checkClientAuthorities:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/clients/authorities/check"},{},e).then(function(t){n.call(this,t.results)})},readAccessPolicy:function(t){const n=this.getFactory().accessPolicy(this);return this.chainGet(n,"/access/policies/"+t)},createAccessPolicy:function(t){t||(t={});const n=this.getFactory().accessPolicy(this);return this.chainCreate(n,t,"/access/policies")},listAccessPolicies:function(t){const e={};t&&n.copyInto(e,t),e.clientId=this.getId();const i=this.getFactory().accessPolicyMap(this.getPlatform());return this.chainGet(i,"/access/policies",e)},queryAccessPolicies:function(t,e){const i={};e&&n.copyInto(i,e);const o=this.getFactory().accessPolicyMap(this.getPlatform());return this.chainPost(o,"/access/policies/query",i,t)},findAccessPolicies:function(t,e){const i={};i.ref=t,e&&n.copyInto(i,e);const o=this.getFactory().accessPolicyMap(this.getPlatform());return this.chainPost(o,"/access/policies/find",i)},listAccessPolicyTargets:function(t,e){const i={};i.accessPolicyId=t,e&&n.copyInto(i,e);const o="/access/policies/"+t+"/targets",s=this.getFactory().accessPolicyMap(this.getPlatform());return this.chainGet(s,o,i)},assignAccessPolicy:function(t,n){const e={};e.ref=n;const i="/access/policies/"+t+"/assign",o=this.getFactory().accessPolicyMap(this.getPlatform());return this.chainPost(o,i,e)},unassignAccessPolicy:function(t,n){const e={};e.ref=n;const i="/access/policies/"+t+"/unassign",o=this.getFactory().accessPolicyMap(this.getPlatform());return this.chainPost(o,i,e)},unassignAllAccessPolicies:function(t){const n={};n.ref=t;const e=this.getFactory().accessPolicyMap(this.getPlatform());return this.chainPost(e,"/access/policies/unassignall",n)},readAuthenticationGrant:function(t){const n=this.getFactory().authenticationGrant(this);return this.chainGet(n,"/auth/grants/"+t)},createAuthenticationGrant:function(t){t||(t={});const n=this.getFactory().authenticationGrant(this);return this.chainCreate(n,t,"/auth/grants")},queryAuthenticationGrants:function(t,e){const i={};e&&n.copyInto(i,e);const o=this.getFactory().authenticationGrantMap(this);return this.chainPost(o,function(){return"/auth/grants/query"},i,t)},checkAuthenticationGrantPermissions:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/auth/grants/permissions/check"},{},e).then(function(t){n.call(this,t.results)})},checkAuthenticationGrantAuthorities:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/auth/grants/authorities/check"},{},e).then(function(t){n.call(this,t.results)})},listDirectories:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().directoryMap(this);return this.chainGet(i,"/directories",e)},readDirectory:function(t){const n=this.getFactory().directory(this);return this.chainGet(n,"/directories/"+t)},createDirectory:function(t){const n=this.getFactory().directory(this);return this.chainCreate(n,t,"/directories")},queryDirectories:function(t,e){const i=this.getFactory().directoryMap(this),o={};return e&&n.copyInto(o,e),this.chainPost(i,"/directories/query",o,t)},checkDirectoryPermissions:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/directories/permissions/check"},{},e).then(function(t){n.call(this,t.results)})},checkDirectoryAuthorities:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/directories/authorities/check"},{},e).then(function(t){n.call(this,t.results)})},listBillingProviderConfigurations:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().billingProviderConfigurationMap(this);return this.chainGet(i,"/billing/configurations",e)},readBillingProviderConfiguration:function(t){const n=this.getFactory().billingProviderConfiguration(this);return this.chainGet(n,"/billing/configurations/"+t)},createBillingProviderConfiguration:function(t,n){n||(n={}),n.providerId=t;const e=this.getFactory().billingProviderConfiguration(this);return this.chainCreate(e,n,"/billing/configurations")},queryBillingProviderConfigurations:function(t,e){const i={};e&&n.copyInto(i,e);const o=this.getFactory().billingProviderConfigurationMap(this);return this.chainPost(o,function(){return"/billing/configurations/query"},i,t)},checkBillingProviderConfigurationPermissions:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/billing/configurations/permissions/check"},{},e).then(function(t){n.call(this,t.results)})},checkBillingProviderConfigurationAuthorities:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/billing/configurations/authorities/check"},{},e).then(function(t){n.call(this,t.results)})},listWebHosts:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().webhostMap(this);return this.chainGet(i,"/webhosts",e)},readWebHost:function(t){const n=this.getFactory().webhost(this);return this.chainGet(n,"/webhosts/"+t)},createWebHost:function(t){const n=this.getFactory().webhost(this);return this.chainCreate(n,t,"/webhosts")},queryWebHosts:function(t,e){const i=this.getFactory().webhostMap(this),o={};return e&&n.copyInto(o,e),this.chainPost(i,"/webhosts/query",o,t)},checkWebHostPermissions:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/webhosts/permissions/check"},{},e).then(function(t){n.call(this,t.results)})},checkWebHostAuthorities:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/webhosts/authorities/check"},{},e).then(function(t){n.call(this,t.results)})},listTenantAttachments:function(){const t=this,e=this.clone();e.getUri=function(){return"/tenant"};const i=this.subchain(new n.BinaryAttachmentMap(e));return i.then(function(){const n=this;return t.getDriver().gitanaGet(t.getUri()+"/tenant/attachments",null,{},function(t){n.handleResponse(t),n.next()}),!1}),i},tenantAttachment:function(t){return this.listTenantAttachments().select(t)},tenantAttach:function(t,e,i){const o=this,s=this.clone();s.getUri=function(){return"/tenant"};const r=this.subchain(new n.BinaryAttachment(s));return r.subchain().then(function(){const n=o.getUri()+"/tenant/attachments/"+t;this.chainUpload(this,n,null,e,i).then(function(){this.subchain(o).listTenantAttachments().then(function(){this.select(t).then(function(){r.handleResponse(this)})})})}),r},tenantUnattach:function(t){return this.subchain().then(function(){this.chainDelete(this,this.getUri()+"/tenant/attachments/"+t).then(function(){})})},getTenantPreviewUri:n.Methods.getPreviewUri("tenant/preview"),app:function(t,e){n.isFunction(t)&&(e=t,t=null),n.isString(t)&&(t={application:t});const i={application:null,appCacheKey:null};n.copyKeepers(i,n.loadDefaultConfig()),n.copyKeepers(i,this.getDriver().getOriginalConfiguration()),n.copyKeepers(i,t);const o=i.appCacheKey;if(o&&n.APPS&&n.APPS[o])return e.call(Chain(n.APPS[o]));if(!i.application)return void e.call(this,new Error("No application configured"));const s=new n.AppHelper(this,i);n.APPS||(n.APPS={}),s.init.call(s,function(t){t?e(t):(o&&(n.APPS[o]=s),e.call(Chain(s)))})},accessLookups:function(t,n){const e={entries:t};return this.chainPostResponse(this,function(){return"/access/lookup"},{},e).then(function(t){n.call(this,t.entries)})},accessChecks:function(t,n){const e={entries:t};return this.chainPostResponse(this,function(){return"/access/check"},{},e).then(function(t){n.call(this,t.entries)})},referenceReads:function(t,n){const e={entries:t};return this.chainPostResponse(this,function(){return"/ref/read"},{},e).then(function(t){n.call(this,t.entries)})},referenceDiff:function(t,n,e){const i={source:t,target:n};return this.chainGetResponse(this,function(){return"/ref/diff"},i).then(function(t){e.call(this,t)})},referenceMerge:function(t,n,e){const i={source:t};return this.chainPostResponse(this,function(){return"/ref/merge"},i,n).then(function(t){e.call(this,t)})},adminIndexDatastores:function(){const t=this;return this.then(function(){const n=this,e=t.getUri()+"/admin/index";return t.getDriver().gitanaPost(e,null,{},function(){n.next()}),!1})},adminRepair:function(){const t=this;return this.then(function(){const n=this,e=t.getUri()+"/admin/repair";return t.getDriver().gitanaPost(e,null,{},function(){n.next()}),!1})},listRuleActions:function(t,e){const i={};return t&&n.copyInto(i,t),this.chainGetResponse(this,function(){return"/rule/actions"},i).then(function(t){e(t)})},readRuleAction:function(t,n){return this.chainGetResponse(this,function(){return"/rule/actions/"+t},{}).then(function(t){n(t)})},listRuleConditions:function(t,e){const i={};return t&&n.copyInto(i,t),this.chainGetResponse(this,function(){return"/rule/conditions"},i).then(function(t){e(t)})},readRuleCondition:function(t,n){return this.chainGetResponse(this,function(){return"/rule/conditions/"+t},{}).then(function(t){n(t)})},listWorkflowModels:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().workflowModelMap(this);return this.chainGet(i,"/workflow/models",e)},listAllWorkflowModels:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().workflowModelMap(this);return this.chainGet(i,"/workflow/models?all=true",e)},readWorkflowModel:function(t,n){const e=this.getFactory().workflowModel(this);return this.chainGet(e,function(){let e="/workflow/models/"+t;return n&&(e+="/versions/"+n),e})},createWorkflowModel:function(t,n){n||(n={}),n.id=t;const e=this.getFactory().workflowModel(this);return this.chainCreate(e,n,"/workflow/models")},queryWorkflowModels:function(t,e){const i={};e&&n.copyInto(i,e);const o=this.getFactory().workflowModelMap(this);return this.chainPost(o,function(){return"/workflow/models/query"},i,t)},queryAllWorkflowModels:function(t,e){const i={};e&&n.copyInto(i,e);const o=this.getFactory().workflowModelMap(this);return this.chainPost(o,function(){return"/workflow/models/query?all=true"},i,t)},checkWorkflowModelPermissions:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/workflow/models/permissions/check"},{},e).then(function(t){n.call(this,t.results)})},checkWorkflowModelAuthorities:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/workflow/models/authorities/check"},{},e).then(function(t){n.call(this,t.results)})},listWorkflowModelVersions:function(t,e){const i={};e&&n.copyInto(i,e);const o=this.getFactory().workflowModelMap(this);return this.chainGet(o,function(){return"/workflow/models/"+t+"/versions"},i)},queryWorkflowModelVersions:function(t,e,i){const o={};i&&n.copyInto(o,i);const s=this.getFactory().workflowModelMap(this);return this.chainPost(s,function(){return"/workflow/models/"+t+"/versions/query"},o,e)},listWorkflows:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().workflowInstanceMap(this);return this.chainGet(i,"/workflow/instances",e)},readWorkflow:function(t){const n=this.getFactory().workflowInstance(this);return this.chainGet(n,"/workflow/instances/"+t)},createWorkflow:function(t,n){n||(n={});const e={modelId:t},i=this.getFactory().workflowInstance(this);return this.chainCreate(i,n,"/workflow/instances",e)},queryWorkflows:function(t,e){const i={};e&&n.copyInto(i,e);const o=this.getFactory().workflowInstanceMap(this);return this.chainPost(o,function(){return"/workflow/instances/query"},i,t)},checkWorkflowInstancePermissions:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/workflow/instance/permissions/check"},{},e).then(function(t){n.call(this,t.results)})},checkWorkflowInstanceAuthorities:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/workflow/instance/authorities/check"},{},e).then(function(t){n.call(this,t.results)})},listWorkflowTasks:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().workflowTaskMap(this);return this.chainGet(i,"/workflow/tasks",e)},readWorkflowTask:function(t){const n=this.getFactory().workflowTask(this);return this.chainGet(n,"/workflow/tasks/"+t)},queryWorkflowTasks:function(t,e){const i={};e&&n.copyInto(i,e);const o=this.getFactory().workflowTaskMap(this);return this.chainPost(o,function(){return"/workflow/tasks/query"},i,t)},checkWorkflowTaskPermissions:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/workflow/task/permissions/check"},{},e).then(function(t){n.call(this,t.results)})},checkWorkflowTaskAuthorities:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/workflow/task/authorities/check"},{},e).then(function(t){n.call(this,t.results)})},listWorkflowComments:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().workflowCommentMap(this);return this.chainGet(i,"/workflow/comments",e)},readWorkflowComment:function(t){const n=this.getFactory().workflowComment(this);return this.chainGet(n,"/workflow/comments/"+t)},createWorkflowComment:function(t,n,e){const i=this.getFactory().workflowComment(this);return this.chainCreateEx(i,e,function(){let e="/workflow/instances/"+t+"/comments";return n&&(e+="?taskId="+n),e},function(t){return"/workflow/comments/"+t._doc})},queryWorkflowComments:function(t,e){const i={};e&&n.copyInto(i,e);const o=this.getFactory().workflowCommentMap(this);return this.chainPost(o,function(){return"/workflow/comments/query"},i,t)},checkWorkflowCommentPermissions:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/workflow/comments/permissions/check"},{},e).then(function(t){n.call(this,t.results)})},checkWorkflowCommentAuthorities:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/workflow/comments/authorities/check"},{},e).then(function(t){n.call(this,t.results)})},listTasksForCurrentUser:function(t,e){const i={};e&&n.copyInto(i,e),t&&(i.filter=t);const o=this.getFactory().workflowTaskMap(this);return this.chainGet(o,"/workflow/user/tasks",i)},queryTasksForCurrentUser:function(t,e,i){const o={};i&&n.copyInto(o,i),t&&(o.filter=t);const s=this.getFactory().workflowTaskMap(this);return this.chainPost(s,"/workflow/user/tasks/query",o,e)},queryTasks:function(t,e){const i={};e&&n.copyInto(i,e);const o=this.getFactory().workflowTaskMap(this);return this.chainPost(o,"/workflow/tasks/query",i,t)},loadWorkflowHistory:function(t,e,i){const o={};return e&&n.copyInto(o,e),this.chainGetResponse(this,function(){return"/workflow/instances/"+t+"/history"},o).then(function(t){i(t)})},listScheduledWorkItems:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().scheduledWorkMap(this);return this.chainGet(i,"/work/scheduled",e)},readScheduledWorkItem:function(t){const n=this.getFactory().scheduledWork(this);return this.chainGet(n,"/work/scheduled/"+t)},createScheduledWorkItem:function(t){t||(t={});const n=this.getFactory().scheduledWork(this);return this.chainCreate(n,t,"/work/scheduled")},queryScheduledWorkItems:function(t,e){const i={};e&&n.copyInto(i,e);const o=this.getFactory().scheduledWorkMap(this);return this.chainPost(o,function(){return"/work/scheduled/query"},i,t)},checkScheduledWorkPermissions:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/work/scheduled/permissions/check"},{},e).then(function(t){n.call(this,t.results)})},checkScheduledWorkAuthorities:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/work/scheduled/authorities/check"},{},e).then(function(t){n.call(this,t.results)})},listReports:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().reportMap(this);return this.chainGet(i,"/reports",e)},readReport:function(t){const n=this.getFactory().report(this);return this.chainGet(n,"/reports/"+t)},createReport:function(t){t||(t={});const n=this.getFactory().report(this);return this.chainCreate(n,t,"/reports")},queryReports:function(t,e){const i={};e&&n.copyInto(i,e);const o=this.getFactory().reportMap(this);return this.chainPost(o,function(){return"/reports/query"},i,t)},checkReportPermissions:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/reports/permissions/check"},{},e).then(function(t){n.call(this,t.results)})},checkReportAuthorities:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/reports/authorities/check"},{},e).then(function(t){n.call(this,t.results)})},executeReport:function(t,e,i,o){"function"==typeof e&&(o=e,e={},i=null),"function"==typeof i&&(o=i,i=null,e||(e={}));const s={};return i&&n.copyInto(s,i),this.chainPostResponse(this,function(){return"/reports/"+t+"/execute"},s,e).then(function(t){o.call(this,t)})},runExport:function(n,e,i){e||(e={});let o=[];if(n.refs)o=n.refs();else if(n.length)for(let t=0;t<n.length;t++)o.push(n[t].ref());e.references=o;const s=this;return this.chainPostResponse(this,function(){return"/ref/exports/start"},{},e).then(function(n){const e=n._doc,o=function(){t.setTimeout(function(){Chain(s).readExportStatus(e,function(t){"FINISHED"===t.state?(i(e,t),s.next()):"ERROR"===t.state?(i(e,t),s.next()):o()})},1e3)};return o(),!1})},readExportStatus:function(t,n){return this.chainGetResponse(this,function(){return"/ref/exports/"+t+"/status"}).then(function(t){n(t)})},exportDownloadUrl:function(t,n,e){let i="/ref/exports/"+t+"/download";return n&&(i+="/"+n),e&&(i+="?a=true"),i},listServiceDescriptors:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().descriptorMap(this);return this.chainGet(i,"/descriptors",e)},readServiceDescriptor:function(t){const n=this.getFactory().descriptor(this);return this.chainGet(n,"/descriptors/"+t)},createServiceDescriptor:function(t){t||(t={});const n=this.getFactory().descriptor(this);return this.chainCreate(n,t,"/descriptors")},queryServiceDescriptors:function(t,e){const i={};e&&n.copyInto(i,e);const o=this.getFactory().descriptorMap(this);return this.chainPost(o,function(){return"/descriptors/query"},i,t)},checkServiceDescriptorPermissions:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/descriptors/permissions/check"},{},e).then(function(t){n.call(this,t.results)})},checkServiceDescriptorAuthorities:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/descriptors/authorities/check"},{},e).then(function(t){n.call(this,t.results)})},listUIConfigs:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().uiConfigMap(this);return this.chainGet(i,"/uiconfigs",e)},readUIConfig:function(t){const n=this.getFactory().uiConfig(this);return this.chainGet(n,"/uiconfigs/"+t)},createUIConfig:function(t){t||(t={});const n=this.getFactory().uiConfig(this);return this.chainCreate(n,t,"/uiconfigs")},queryUIConfigs:function(t,e){const i={};e&&n.copyInto(i,e);const o=this.getFactory().uiConfigMap(this);return this.chainPost(o,function(){return"/uiconfigs/query"},i,t)},checkUIConfigPermissions:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/uiconfigs/permissions/check"},{},e).then(function(t){n.call(this,t.results)})},checkUIConfigAuthorities:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/uiconfigs/authorities/check"},{},e).then(function(t){n.call(this,t.results)})},listDeploymentReceivers:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().deploymentReceiverMap(this);return this.chainGet(i,"/deployment/receivers",e)},readDeploymentReceiver:function(t){const n=this.getFactory().deploymentReceiver(this);return this.chainGet(n,"/deployment/receivers/"+t)},createDeploymentReceiver:function(t){t||(t={});const n=this.getFactory().deploymentReceiver(this);return this.chainCreate(n,t,"/deployment/receivers")},queryDeploymentReceivers:function(t,e){const i={};e&&n.copyInto(i,e);const o=this.getFactory().deploymentReceiverMap(this);return this.chainPost(o,function(){return"/deployment/receivers/query"},i,t)},checkDeploymentReceiverPermissions:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/deployment/receivers/permissions/check"},{},e).then(function(t){n.call(this,t.results)})},checkDeploymentReceiverAuthorities:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/deployment/receivers/authorities/check"},{},e).then(function(t){n.call(this,t.results)})},listDeploymentPackages:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().deploymentPackageMap(this);return this.chainGet(i,"/deployment/packages",e)},readDeploymentPackage:function(t){const n=this.getFactory().deploymentPackage(this);return this.chainGet(n,"/deployment/packages/"+t)},queryDeploymentPackages:function(t,e){const i={};e&&n.copyInto(i,e);const o=this.getFactory().deploymentPackageMap(this);return this.chainPost(o,function(){return"/deployment/packages/query"},i,t)},checkDeploymentPackagePermissions:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/deployment/packages/permissions/check"},{},e).then(function(t){n.call(this,t.results)})},checkDeploymentPackageAuthorities:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/deployment/packages/authorities/check"},{},e).then(function(t){n.call(this,t.results)})},listDeploymentStrategies:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().deploymentStrategyMap(this);return this.chainGet(i,"/deployment/strategies",e)},readDeploymentStrategy:function(t){const n=this.getFactory().deploymentStrategy(this);return this.chainGet(n,"/deployment/strategies/"+t)},createDeploymentStrategy:function(t){t||(t={});const n=this.getFactory().deploymentStrategy(this);return this.chainCreate(n,t,"/deployment/strategies")},queryDeploymentStrategies:function(t,e){const i={};e&&n.copyInto(i,e);const o=this.getFactory().deploymentStrategyMap(this);return this.chainPost(o,function(){return"/deployment/strategies/query"},i,t)},checkDeploymentStrategyPermissions:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/deployment/strategies/permissions/check"},{},e).then(function(t){n.call(this,t.results)})},checkDeploymentStrategyAuthorities:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/deployment/strategies/authorities/check"},{},e).then(function(t){n.call(this,t.results)})},listDeploymentTargets:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().deploymentTargetMap(this);return this.chainGet(i,"/deployment/targets",e)},readDeploymentTarget:function(t){const n=this.getFactory().deploymentTarget(this);return this.chainGet(n,"/deployment/targets/"+t)},createDeploymentTarget:function(t){t||(t={});const n=this.getFactory().deploymentTarget(this);return this.chainCreate(n,t,"/deployment/targets")},queryDeploymentTargets:function(t,e){const i={};e&&n.copyInto(i,e);const o=this.getFactory().deploymentTargetMap(this);return this.chainPost(o,function(){return"/deployment/targets/query"},i,t)},checkDeploymentTargetPermissions:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/deployment/targets/permissions/check"},{},e).then(function(t){n.call(this,t.results)})},checkDeploymentTargetAuthorities:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/deployment/targets/authorities/check"},{},e).then(function(t){n.call(this,t.results)})}})}(window),function(t){const n=t.Gitana;n.PlatformDataStoreMap=n.AbstractMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.PlatformDataStoreMap"},this.getPlatform=function(){return t},this.base(t.getDriver(),n)},clone:function(){return this.getFactory().platformDataStoreMap(this.getPlatform(),this)},buildObject:function(t){return this.getFactory().platformDataStore(this.getPlatform(),t)}})}(window),function(t){const n=t.Gitana;n.Project=n.AbstractPlatformObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.Project"}},getType:function(){return n.TypedIDConstants.TYPE_PROJECT},getUri:function(){return"/projects/"+this.getId()},clone:function(){return this.getFactory().project(this.getPlatform(),this)},listAttachments:n.Methods.listAttachments(),attachment:function(t){return this.listAttachments().select(t)},attach:n.Methods.attach(),unattach:n.Methods.unattach(),getPreviewUri:n.Methods.getPreviewUri(),readStack:function(){const t=this,n=this.getFactory().stack(this.getPlatform());return this.chainGet(n,function(){return t.getPlatform().getUri()+"/stacks/"+t.stackId})},adminMaintenance:function(){const t=this;return this.then(function(){const n=this,e=t.getUri()+"/admin/maintenance";return t.getDriver().gitanaPost(e,null,{},function(){n.next()}),!1})},inviteUser:function(t){const n=this,e={};return e.id=t,this.chainPostEmpty(null,function(){return n.getUri()+"/users/invite"},e)}})}(window),function(t){const n=t.Gitana;n.ProjectMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.ProjectMap"},this.base(t,n)},clone:function(){return this.getFactory().projectMap(this.getPlatform(),this)},buildObject:function(t){return this.getFactory().project(this.getPlatform(),t)}})}(window),function(t){const n=t.Gitana;n.Report=n.AbstractPlatformObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.Report"}},getType:function(){return n.TypedIDConstants.TYPE_REPORT},getUri:function(){return"/reports/"+this.getId()},clone:function(){return this.getFactory().report(this.getPlatform(),this)}})}(window),function(t){const n=t.Gitana;n.ReportMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.ReportMap"},this.base(t,n)},clone:function(){return this.getFactory().reportMap(this.getPlatform(),this)},buildObject:function(t){return this.getFactory().report(this.getPlatform(),t)}})}(window),function(t){const n=t.Gitana;n.ScheduledWork=n.AbstractPlatformObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.ScheduledWork"}},getType:function(){return n.TypedIDConstants.TYPE_SCHEDULED_WORK},getUri:function(){return"/work/scheduled/"+this.getId()},clone:function(){return this.getFactory().scheduledWork(this.getPlatform(),this)},trigger:function(){const t=this;return this.then(function(){const n=this,e=t.getUri()+"/trigger";return t.getDriver().gitanaPost(e,null,{},function(){n.next()}),!1})}})}(window),function(t){const n=t.Gitana;n.ScheduledWorkMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.ScheduledWorkMap"},this.base(t,n)},clone:function(){return this.getFactory().scheduledWorkMap(this.getPlatform(),this)},buildObject:function(t){return this.getFactory().scheduledWork(this.getPlatform(),t)}})}(window),function(t){const n=t.Gitana;n.Stack=n.AbstractPlatformObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.Stack"}},getType:function(){return n.TypedIDConstants.TYPE_STACK},getUri:function(){return"/stacks/"+this.getId()},clone:function(){return this.getFactory().stack(this.getPlatform(),this)},getKey:function(){return this.get("key")},readTeam:function(t){const n=this.getFactory().team(this.getPlatform(),this);return this.chainGet(n,function(){return this.getUri()+"/teams/"+t})},listTeams:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().teamMap(this.getCluster(),this);return this.chainGet(i,function(){return this.getUri()+"/teams"},e)},createTeam:function(t,n){n||(n={});const e=this,i=this.getFactory().team(this.getPlatform(),this);return this.chainPostResponse(i,function(){return this.getUri()+"/teams?key="+t},{},n).then(function(){const n=this;return Chain(e).readTeam(t).then(function(){n.handleResponse(this),n.next()}),!1})},readOwnersTeam:function(){return this.readTeam("owners")},readRole:function(t,n){const e={};n&&(e.inherited=!0);const i=this.getFactory().role(this.getCluster(),this);return this.chainGet(i,function(){return this.getUri()+"/roles/"+t},e)},listRoles:function(t){const n={};t&&(n.inherited=!0);const e=this.getFactory().roleMap(this.getCluster(),this);return this.chainGet(e,function(){return this.getUri()+"/roles"},n)},createRole:function(t,e){e||(e={}),e.roleKey=t;const i=this,o=this.getFactory().role(this.getPlatform(),this,t);return this.chainPostResponse(o,function(){return this.getUri()+"/roles"},{},e).then(function(){this.subchain(i).readRole(t).then(function(){n.copyInto(o,this)})})},listAttachments:n.Methods.listAttachments(),attachment:function(t){return this.listAttachments().select(t)},attach:n.Methods.attach(),unattach:n.Methods.unattach(),getPreviewUri:n.Methods.getPreviewUri(),queryLogEntries:function(t,e){const i=this;t||(t={});const o=this.getFactory().logEntryMap(this.getCluster()),s={};return e&&n.copyInto(s,e),this.chainPost(o,function(){return i.getUri()+"/logs/query"},s,t)},readLogEntry:function(t){const n=this,e=this.getFactory().logEntry(this.getCluster());return this.chainGet(e,function(){return n.getUri()+"/logs/"+t})},readLog:function(t){return this.chainGetResponseText(this,function(){return this.getUri()+"/logs/logfile"}).then(function(n){t.call(this,n)})},assignDataStore:function(t,e){const i=this,o=n.makeArray(arguments);let s;if(1===o.length){const t=o.shift();s=t.getType&&t.getId?{type:t.getType(),id:t.getId()}:t}else t=o.shift(),e=o.shift(),s={type:t.getType(),id:t.getId()},e&&(s.key=e);return this.chainPostEmpty(null,function(){return i.getUri()+"/datastores/assign"},s)},unassignDataStore:function(t){const n=this,e={key:t};return this.chainPostEmpty(null,function(){return n.getUri()+"/datastores/unassign"},e)},listDataStores:function(t){const e=this,i=this.getFactory().platformDataStoreMap(this.getPlatform()),o={};return t&&n.copyInto(o,t),this.chainGet(i,function(){return e.getUri()+"/datastores"},o)},queryDataStores:function(t,e){const i=this,o={};e&&n.copyInto(o,e);const s=this.getFactory().platformDataStoreMap(this.getPlatform());return this.chainPost(s,function(){return i.getUri()+"/datastores/query"},o,t)},existsDataStore:function(t,n){const e=this;return this.chainPostResponse(this,function(){return e.getUri()+"/datastores/exists?key="+t}).then(function(t){n.call(this,t.exists)})},readDataStore:function(t,n){const e=this;return this.then(function(){const i=this;return Chain(e).queryDataStores().then(function(){const e=this[t];e._doc=e.datastoreId,delete e.datastoreTypeId,n&&n.call(e),i.next()}),!1})}})}(window),function(t){const n=t.Gitana;n.StackMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.StackMap"},this.base(t,n)},clone:function(){return this.getFactory().stackMap(this.getPlatform(),this)},buildObject:function(t){return this.getFactory().stack(this.getPlatform(),t)}})}(window),function(t){const n=t.Gitana;n.UIConfig=n.AbstractPlatformObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.UIConfig"}},getType:function(){return n.TypedIDConstants.TYPE_UICONFIG},getUri:function(){return"/uiconfigs/"+this.getId()},clone:function(){return this.getFactory().uiConfig(this.getPlatform(),this)}})}(window),function(t){const n=t.Gitana;n.UIConfigMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.UIConfigMap"},this.base(t,n)},clone:function(){return this.getFactory().uiConfigMap(this.getPlatform(),this)},buildObject:function(t){return this.getFactory().uiConfig(this.getPlatform(),t)}})}(window),function(t){const n=t.Gitana;n.WorkflowComment=n.AbstractPlatformObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.WorkflowComment"}},getType:function(){return n.TypedIDConstants.TYPE_WORKFLOW_COMMENT},getUri:function(){return"/workflow/comments/"+this.getId()},clone:function(){return this.getFactory().workflowComment(this.getPlatform(),this)}})}(window),function(t){const n=t.Gitana;n.WorkflowCommentMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.WorkflowCommentMap"},this.base(t,n)},clone:function(){return this.getFactory().workflowCommentMap(this.getPlatform(),this)},buildObject:function(t){return this.getFactory().workflowComment(this.getPlatform(),t)}})}(window),function(t){const n=t.Gitana;n.WorkflowInstance=n.AbstractPlatformObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.WorkflowInstance"},this.toReference=function(t){return t.ref()},this.toResourceId=function(t){let n=t;return t&&t.getId&&(n=t.getId()),n}},getType:function(){return n.TypedIDConstants.TYPE_WORKFLOW_INSTANCE},getUri:function(){return"/workflow/instances/"+this.getId()},clone:function(){return this.getFactory().workflowInstance(this.getPlatform(),this)},loadResourceList:function(t){return this.chainGetResponse(this,function(){return this.getUri()+"/resources"}).then(function(n){t.call(this,n.rows)})},loadResource:function(t,n){return this.chainGetResponse(this,function(){return this.getUri()+"/resources/"+t}).then(function(t){n.call(this,t)})},addResource:function(t){const n={reference:this.toReference(t)};return this.chainPostResponse(this,function(){return this.getUri()+"/resources/add"},n)},removeResource:function(t){return this.chainPostResponse(this,function(){const n=this.toResourceId(t);return this.getUri()+"/resources/"+n+"/remove"})},removeAllResources:function(){return this.chainPostResponse(this,function(){return this.getUri()+"/resources/removeall"})},start:function(t){return this.chainPost(this,function(){return this.getUri()+"/start"},{},t)},terminate:function(){return this.chainPostResponse(this,function(){return this.getUri()+"/terminate"})},suspend:function(){return this.chainPostResponse(this,function(){return this.getUri()+"/suspend"})},resume:function(){return this.chainPostResponse(this,function(){return this.getUri()+"/resume"})},upgradeModel:function(t,n){const e={id:t,version:n};return this.chainPost(this,function(){return this.getUri()+"/upgrade"},e)}})}(window),function(t){const n=t.Gitana;n.WorkflowInstanceMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.WorkflowInstanceMap"},this.base(t,n)},clone:function(){return this.getFactory().workflowInstanceMap(this.getPlatform(),this)},buildObject:function(t){return this.getFactory().workflowInstance(this.getPlatform(),t)}})}(window),function(t){const n=t.Gitana;n.WorkflowModel=n.AbstractPlatformObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.WorkflowModel"}},getType:function(){return n.TypedIDConstants.TYPE_WORKFLOW_MODEL},getUri:function(){return"/workflow/models/"+this.id+"/versions/"+this.version},clone:function(){return this.getFactory().workflowModel(this.getPlatform(),this)},update:function(t){const n=this,e={};return t&&(e.force=!0),this.chainUpdate(null,function(){return n.getUri()},e)},deploy:function(){const t=this;return this.chainPostEmpty(null,function(){return t.getUri()+"/deploy"})},undeploy:function(){const t=this;return this.chainPostEmpty(null,function(){return t.getUri()+"/undeploy"})}})}(window),function(t){const n=t.Gitana;n.WorkflowModelMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.WorkflowModelMap"},this.base(t,n)},clone:function(){return this.getFactory().workflowModelMap(this.getPlatform(),this)},buildObject:function(t){return this.getFactory().workflowModel(this.getPlatform(),t)}})}(window),function(t){const n=t.Gitana;n.WorkflowTask=n.AbstractPlatformObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.WorkflowTask"},this.toReference=function(t){return t.ref()},this.toResourceId=function(t){let n=t;return t&&t.getId&&(n=t.getId()),n}},getType:function(){return n.TypedIDConstants.TYPE_WORKFLOW_TASK},getUri:function(){return"/workflow/tasks/"+this.getId()},clone:function(){return this.getFactory().workflowTask(this.getPlatform(),this)},loadResourceList:function(t){return this.chainGetResponse(this,function(){return this.getUri()+"/resources"}).then(function(n){t.call(this,n.rows)})},loadResource:function(t,n){return this.chainGetResponse(this,function(){return this.getUri()+"/resources/"+t}).then(function(t){n.call(this,t)})},addResource:function(t){const n={reference:this.toReference(t)};return this.chainPostResponse(this,function(){return this.getUri()+"/resources/add"},n)},removeResource:function(t){return this.chainPostResponse(this,function(){const n=this.toResourceId(t);return this.getUri()+"/resources/"+n+"/remove"})},removeAllResources:function(){return this.chainPostResponse(this,function(){return this.getUri()+"/resources/removeall"})},claim:function(){const t=this.getFactory().workflowTask(this.getPlatform());return this.chainPost(t,function(){return this.getUri()+"/claim"},{},{})},unclaim:function(){const t=this.getFactory().workflowTask(this.getPlatform());return this.chainPost(t,function(){return this.getUri()+"/unclaim"},{},{})},delegate:function(t){const n={userId:this.extractPrincipalDomainQualifiedId(t)},e=this.getFactory().workflowTask(this.getPlatform());return this.chainPost(e,function(){return this.getUri()+"/delegate"},n,{})},listDelegates:function(t){const e=this,i={};t&&n.copyInto(i,t);const o=this.getFactory().domainPrincipalMap(this);return this.chainGet(o,function(){return e.getUri()+"/delegates"},i)},complete:function(t,n){const e={routeId:t},i=this.getFactory().workflowTask(this.getPlatform());return this.chainPost(i,function(){return this.getUri()+"/complete"},e,n)},move:function(t,n){const e={id:t},i=this.getFactory().workflowTask(this.getPlatform());return this.chainPost(i,function(){return this.getUri()+"/move"},e,n)},loadRoutes:function(t){return this.chainGetResponse(this,function(){return this.getUri()+"/routes"}).then(function(n){t.call(this,n.routes)})}})}(window),function(t){const n=t.Gitana;n.WorkflowTaskMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.WorkflowTaskMap"},this.base(t,n)},clone:function(){return this.getFactory().workflowTaskMap(this.getPlatform(),this)},buildObject:function(t){return this.getFactory().workflowTask(this.getPlatform(),t)}})}(window),function(t){const n=t.Gitana;n.AbstractRegistrarObject=n.AbstractPlatformObject.extend({constructor:function(t,n){this.base(t.getPlatform(),n),this.objectType=function(){return"Gitana.Meter"},this.getRegistrar=function(){return t},this.getRegistrarId=function(){return t.getId()}},ref:function(){return this.getType()+"://"+this.getPlatformId()+"/"+this.getRegistrarId()+"/"+this.getId()}})}(window),function(t){const n=t.Gitana;n.Meter=n.AbstractRegistrarObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.Meter"}},getType:function(){return n.TypedIDConstants.TYPE_PLAN},getUri:function(){return"/registrars/"+this.getRegistrarId()+"/meters/"+this.getId()},clone:function(){return this.getFactory().meter(this.getRegistrar(),this)}}),n.Meter.FIELD_TENANT_ID="tenantId",n.Meter.FIELD_METER_TYPE="meterType",n.Meter.FIELD_METER_START="meterStart",n.Meter.FIELD_METER_END="meterEnd",n.Meter.FIELD_MAX_BYTE_COUNT="maxByteCount",n.Meter.FIELD_RAW_BYTE_COUNT="rawByteCount",n.Meter.FIELD_RAW_BYTE_COUNT_PERCENTAGE="rawByteCountPercentage",n.Meter.FIELD_UNPROCESSED_BYTE_COUNT="unprocessedByteCount",n.Meter.FIELD_BILLABLE_BYTE_COUNT="billableByteCount",n.Meter.FIELD_BILLABLE_BYTE_COUNT_PERCENTAGE="billableByteCountPercentage",n.Meter.FIELD_MAX_OBJECT_COUNT="maxObjectCount",n.Meter.FIELD_RAW_OBJECT_COUNT="rawObjectCount",n.Meter.FIELD_RAW_OBJECT_COUNT_PERCENTAGE="rawObjectCountPercentage",n.Meter.FIELD_UNPROCESSED_OBJECT_COUNT="unprocessedObjectCount",n.Meter.FIELD_BILLABLE_OBJECT_COUNT="billableObjectCount",n.Meter.FIELD_BILLABLE_OBJECT_COUNT_PERCENTAGE="billableObjectCountPercentage"}(window),function(t){const n=t.Gitana;n.MeterMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.MeterMap"},this.getRegistrar=function(){return t},this.getRegistrarId=function(){return t.getId()},this.base(t.getPlatform(),n)},clone:function(){return this.getFactory().planMap(this.getRegistrar(),this)},buildObject:function(t){return this.getFactory().plan(this.getRegistrar(),t)}})}(window),function(t){const n=t.Gitana;n.Plan=n.AbstractRegistrarObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.Plan"}},getType:function(){return n.TypedIDConstants.TYPE_PLAN},getUri:function(){return"/registrars/"+this.getRegistrarId()+"/plans/"+this.getId()},clone:function(){return this.getFactory().plan(this.getRegistrar(),this)},getPlanKey:function(){return this.get("planKey")}})}(window),function(t){const n=t.Gitana;n.PlanMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.PlanMap"},this.getRegistrar=function(){return t},this.getRegistrarId=function(){return t.getId()},this.base(t.getPlatform(),n)},clone:function(){return this.getFactory().planMap(this.getRegistrar(),this)},buildObject:function(t){return this.getFactory().plan(this.getRegistrar(),t)}})}(window),function(t){const n=t.Gitana;n.Registrar=n.AbstractPlatformDataStore.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.Registrar"},this.base(t,n)},getUri:function(){return"/registrars/"+this.getId()},getType:function(){return n.TypedIDConstants.TYPE_REGISTRAR},clone:function(){return this.getFactory().registrar(this.getPlatform(),this)},listTenants:function(t){const e=this,i={};t&&n.copyInto(i,t);const o=this.getFactory().tenantMap(this);return this.chainGet(o,function(){return e.getUri()+"/tenants"},i)},queryTenants:function(t,e){const i=this,o=this.getFactory().tenantMap(this),s={};return e&&n.copyInto(s,e),this.chainPost(o,function(){return i.getUri()+"/tenants/query"},s,t)},readTenant:function(t){const n=this,e=this.getFactory().tenant(this);return this.chainGet(e,function(){return n.getUri()+"/tenants/"+t})},lookupTenantForPrincipal:function(t){const n=this,e=this.getFactory().tenant(this);return this.chainGet(e,function(){return n.getUri()+"/tenants/lookup?id="+t.getDomainQualifiedId()})},createTenant:function(t,n,e){const i=this,o={};o.principalId=t.getId(),o.domainId=t.getDomainId(),o.planKey=n,e&&(o.paymentMethod=e);const s=this.getFactory().tenant(this);return this.chainCreate(s,o,function(){return i.getUri()+"/tenants"})},checkTenantPermissions:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/tenants/permissions/check"},{},i).then(function(t){n.call(this,t.results)})},checkTenantAuthorities:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/tenants/authorities/check"},{},i).then(function(t){n.call(this,t.results)})},listPlans:function(t){const e=this,i={};t&&n.copyInto(i,t);const o=this.getFactory().planMap(this);return this.chainGet(o,function(){return e.getUri()+"/plans"},i)},queryPlans:function(t,e){const i=this,o=this.getFactory().planMap(this),s={};return e&&n.copyInto(s,e),this.chainPost(o,function(){return i.getUri()+"/plans/query"},s,t)},readPlan:function(t){const n=this,e=this.getFactory().plan(this);return this.chainGet(e,function(){return n.getUri()+"/plans/"+t})},createPlan:function(t){const n=this,e=this.getFactory().plan(this);return this.chainCreate(e,t,function(){return n.getUri()+"/plans"})},checkPlanPermissions:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/plans/permissions/check"},{},i).then(function(t){n.call(this,t.results)})},checkPlanAuthorities:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/plans/authorities/check"},{},i).then(function(t){n.call(this,t.results)})},listMeters:function(t){const e=this,i={};t&&n.copyInto(i,t);const o=this.getFactory().meterMap(this);return this.chainGet(o,function(){return e.getUri()+"/meters"},i)},queryMeters:function(t,e){const i=this,o=this.getFactory().meterMap(this),s={};return e&&n.copyInto(s,e),this.chainPost(o,function(){return i.getUri()+"/meters/query"},s,t)},readMeter:function(t){const n=this,e=this.getFactory().meter(this);return this.chainGet(e,function(){return n.getUri()+"/meters/"+t})},createMeter:function(t){const n=this,e=this.getFactory().meter(this);return this.chainCreate(e,t,function(){return n.getUri()+"/meters"})},checkMeterPermissions:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/meters/permissions/check"},{},i).then(function(t){n.call(this,t.results)})},checkMeterAuthorities:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/meters/authorities/check"},{},i).then(function(t){n.call(this,t.results)})}})}(window),function(t){const n=t.Gitana;n.RegistrarMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.RegistrarMap"},this.base(t,n)},clone:function(){return this.getFactory().registrarMap(this.getPlatform(),this)},buildObject:function(t){return this.getFactory().registrar(this.getPlatform(),t)}})}(window),function(t){const n=t.Gitana;n.Tenant=n.AbstractRegistrarObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.Tenant"}},getType:function(){return n.TypedIDConstants.TYPE_TENANT},getUri:function(){return"/registrars/"+this.getRegistrarId()+"/tenants/"+this.getId()},clone:function(){return this.getFactory().tenant(this.getRegistrar(),this)},getDnsSlug:function(){return this.get("dnsSlug")},getPlanKey:function(){return this.get("planKey")},getPrincipalId:function(){return this.get("principalId")},getPrincipalDomainId:function(){return this.get("domainId")},getPlatformId:function(){return this.get("platformId")},readTenantPlan:function(){const t=this,n=this.getFactory().plan(this.getRegistrar());return this.chainGet(n,function(){return t.getPlatform().getUri()+"/registrars/"+t.getRegistrarId()+"/plans/"+t.getPlanKey()})},readTenantPrincipal:function(){const t=this,n=this.getFactory().domain(this.getPlatform(),{_doc:this.getPrincipalDomainId()}),e=this.getFactory().domainPrincipal(n);return this.chainGet(e,function(){return t.getPlatform().getUri()+"/domains/"+t.getPrincipalDomainId()+"/principals/"+t.getPrincipalId()})},listAttachments:n.Methods.listAttachments(),attachment:function(t){return this.listAttachments().select(t)},attach:n.Methods.attach(),unattach:n.Methods.unattach(),listAllocatedObjects:function(t,e,i){const o=this,s={};return i&&n.copyInto(s,i),e&&(s.type=e),this.chainGetResponse(this,function(){return o.getUri()+"/objects"},s).then(function(n){t.call(this,n.rows)})},listAllocatedRepositoryObjects:function(t,n){return this.listAllocatedObjects(t,"repository",n)},listAllocatedDomainObjects:function(t,n){return this.listAllocatedObjects(t,"domain",n)},listAllocatedVaultObjects:function(t,n){return this.listAllocatedObjects(t,"vault",n)},listAllocatedClientObjects:function(t,n){return this.listAllocatedObjects(t,"client",n)},listAllocatedRegistrarObjects:function(t,n){return this.listAllocatedObjects(t,"registrar",n)},listAllocatedStackObjects:function(t,n){return this.listAllocatedObjects(t,"stack",n)},listAllocatedDirectoryObjects:function(t,n){return this.listAllocatedObjects(t,"directory",n)},listAllocatedApplicationObjects:function(t,n){return this.listAllocatedObjects(t,"application",n)},readDefaultAllocatedClientObject:function(t){const e=this;return this.chainGetResponse(this,function(){return e.getUri()+"/defaultclient"},{}).then(function(e){const i={};n.copyInto(i,e),n.stampInto(i,n.ClientMethods),i.get=function(t){return this[t]},t.call(this,i)})},listAutoClientMappingObjects:function(t,e){const i=this,o={};return e&&n.copyInto(o,e),this.chainGetResponse(this,function(){return i.getUri()+"/autoclientmappings"},o).then(function(n){t.call(this,n.rows)})}})}(window),function(t){const n=t.Gitana;n.TenantMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.TenantMap"},this.getRegistrar=function(){return t},this.getRegistrarId=function(){return t.getId()},this.base(t.getPlatform(),n)},clone:function(){return this.getFactory().tenantMap(this.getRegistrar(),this)},buildObject:function(t){return this.getFactory().tenant(this.getRegistrar(),t)}})}(window),function(t){const n=t.Gitana;n.AbstractNode=n.AbstractRepositoryObject.extend({constructor:function(t,e){this.__qname=function(){let t=null;return function(e){return n.isUndefined(e)||(t=e),t}}(),this.__type=function(){let t=null;return function(e){return n.isUndefined(e)||(t=e),t}}(),this.__features=function(){let t={};return function(e){return n.isUndefined(e)||(t=e),t}}(),this.__stats=function(){let t={};return function(e){return n.isUndefined(e)||(t=e),t}}(),this.__is_association=function(){let t=!1;return function(e){return n.isUndefined(e)||(t=e),t}}(),this.base(t.getRepository(),e),this.getBranch=function(){return t},this.getBranchId=function(){return t.getId()}},getUri:function(){return"/repositories/"+this.getRepositoryId()+"/branches/"+this.getBranchId()+"/nodes/"+this.getId()},ref:function(){return"node://"+this.getPlatformId()+"/"+this.getRepositoryId()+"/"+this.getBranchId()+"/"+this.getId()},clone:function(){return this.getFactory().node(this.getBranch(),this)},handleSystemProperties:function(t){if(this.base(t),this._qname){const t=this._qname;delete this._qname,this.__qname(t)}if(this._type){const t=this._type;delete this._type,this.__type(t)}if(this._features){const t=this._features;delete this._features,this.__features(t)}if(this._statistics&&"object"==typeof this._statistics){const t=this._statistics;delete this._statistics,this.__stats(t)}if(!n.isUndefined(this._is_association)){const t=this._is_association;delete this._is_association,this.__is_association(t)}},chainCopyState:function(t){this.base(t),t.__qname&&this.__qname(t.__qname()),t.__type&&this.__type(t.__type()),t.__features&&this.__features(t.__features()),t.__stats&&this.__stats(t.__stats()),t.__is_association&&this.__is_association(t.__is_association())},stats:function(){return this.__stats()},getFeatureIds:function(t){const n=this,e=function(){const t=[];for(const n in this.__features())t[t.length]=n;return t};return t?this.then(function(){t.call(this,e.call(n))}):e.call(n)},getFeature:function(t,n){const e=this;return n?this.then(function(){n.call(this,e.__features()[t])}):e.__features()[t]},removeFeature:function(t){const n=this;return this.chainDelete(this,function(){return n.getUri()+"/features/"+t}).reload().then(function(){n.loadFrom(this)})},addFeature:function(t,n){const e=this;return n||(n={}),this.chainPostEmpty(null,function(){return e.getUri()+"/features/"+t},{},n).reload().then(function(){e.loadFrom(this)})},hasFeature:function(t,e){return e?this.then(function(){const i=!n.isEmpty(this.__features()[t]);e.call(this,i)}):!n.isEmpty(this.__features()[t])},isAssociation:function(){return this.__is_association()},isContainer:function(){return this.hasFeature("f:container")},touch:function(){const t=this;return this.chainPost(null,function(){return t.getUri()+"/touch"})},getTypeQName:function(){return this.__type()},changeTypeQName:function(t){const n=this;return this.chainPostEmpty(null,function(){return n.getUri()+"/change_type?type="+t}).reload().then(function(){n.loadFrom(this)})},getQName:function(){return this.__qname()},changeQName:function(t){const n=this;return this.chainPostEmpty(null,function(){return n.getUri()+"/change_qname?qname="+t}).reload().then(function(){n.loadFrom(this)})},listAttachments:n.Methods.listAttachments(n.NodeAttachmentMap),attachment:function(t){return this.listAttachments().select(t)},attachmentDownloadUri:function(t){return this.getDriver().baseURL+this.getUri()+"/attachments/"+t},attach:function(t,e,i,o){return n.Methods.attach.call(this,n.NodeAttachment,function(t){o&&(t.filename=o)}).call(this,t,e,i)},getPreviewUri:n.Methods.getPreviewUri(),unattach:n.Methods.unattach()})}(window),function(t){const n=t.Gitana;n.AbstractRepositoryObject=n.AbstractPlatformObject.extend({constructor:function(t,n){this.base(t.getPlatform(),n),this.getRepository=function(){return t},this.getRepositoryId=function(){return t.getId()}},ref:function(){return this.getType()+"://"+this.getPlatformId()+"/"+this.getRepositoryId()+"/"+this.getId()}})}(window),function(t){const n=t.Gitana;n.Association=n.AbstractNode.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.Association"}},getType:function(){return n.TypedIDConstants.TYPE_ASSOCIATION},isAssociation:function(){return!0},getDirectionality:function(){return this.get("directionality")},getSourceNodeId:function(){return this.get("source")},getSourceNodeChangesetId:function(){return this.get("source_changeset")},getSourceNodeType:function(){return this.get("source_type")},getTargetNodeId:function(){return this.get("target")},getTargetNodeChangesetId:function(){return this.get("target_changeset")},getTargetNodeType:function(){return this.get("target_type")},readSourceNode:function(){const t=this;return this.subchain(this.getFactory().node(this.getBranch())).then(function(){const n=this;this.subchain(t.getBranch()).readNode(t.getSourceNodeId()).then(function(){n.loadFrom(this)})})},readTargetNode:function(){const t=this;return this.subchain(this.getFactory().node(this.getBranch())).then(function(){const n=this;this.subchain(t.getBranch()).readNode(t.getTargetNodeId()).then(function(){n.loadFrom(this)})})},readOtherNode:function(t){const e=this;let i=null;i=n.isString(t)?t:t.getId();const o=this.subchain(this.getFactory().node(this.getBranch()));return o.then(function(){const t=this;this.subchain(e).then(function(){if(i===this.getSourceNodeId())this.readTargetNode().then(function(){t.loadFrom(this)});else{if(i!==this.getTargetNodeId()){const t=new n.Error;return t.name="No node on association",t.message="The node: "+i+" was not found on this association",this.error(t),!1}this.readSourceNode().then(function(){t.loadFrom(this)})}})}),o},getDirection:function(t){let e=null;e=n.isString(t)?t:t.getId();let i=null;return"UNDIRECTED"===this.getDirectionality()?i="MUTUAL":this.getSourceNodeId()===e?i="OUTGOING":this.getTargetNodeId()===e&&(i="INCOMING"),i},getOtherNodeId:function(t){let e=null;e=n.isString(t)?t:t.getId();let i=null;return this.getSourceNodeId()===e?i=this.getTargetNodeId():this.getTargetNodeId()===e&&(i=this.getSourceNodeId()),i}})}(window),function(t){const n=t.Gitana;n.Branch=n.AbstractRepositoryObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.Branch"}},getType:function(){return n.TypedIDConstants.TYPE_BRANCH},getUri:function(){return"/repositories/"+this.getRepositoryId()+"/branches/"+this.getId()},clone:function(){return this.getFactory().branch(this.getRepository(),this)},isMaster:function(){return"master"===this.getBranchType().toLowerCase()},getBranchType:function(){return this.get("type")},getTip:function(){return this.get("tip")},listMounts:function(t){const e=this,i={};t&&n.copyInto(i,t);const o=this.getFactory().nodeMap(this);return this.chainGet(o,function(){return e.getUri()+"/nodes"},i)},readNode:function(t,n,e={}){const i=this;n&&(e.path=n);const o=this.getFactory().node(this);return this.chainGet(o,function(){return i.getUri()+"/nodes/"+t},e)},rootNode:function(){return this.readNode("root")},createNode:function(t,e){const i=this,o={};if(e){let t="root",i="a:child",s=null,r=null,c=null;if("string"==typeof e){let i=e;if(n.startsWith(i,"/")&&(i=i.substring(1)),""===i)s="/";else{const n=i.indexOf("/");t=i.substring(0,n),s=i.substring(n+1)}}else"object"==typeof e&&(e.rootNodeId&&(t=e.rootNodeId),e.associationType&&(i=e.associationType),e.fileName?c=e.fileName:e.filename&&(c=e.filename),e.parentFolderPath?r=e.parentFolderPath:e.folderPath?r=e.folderPath:e.folderpath&&(r=e.folderpath),e.filePath?s=e.filePath:e.filepath&&(s=e.filepath));if(t&&(o.rootNodeId=t),i&&(o.associationType=i),c&&(o.fileName=c),s&&(o.filePath=s),r&&(o.parentFolderPath=r),e.params)for(const t in e.params)o[t]=e.params[t]}const s=this.getFactory().node(this);return this.chainCreate(s,t,function(){return i.getUri()+"/nodes"},o)},searchNodes:function(t,e){const i=this,o={};e&&n.copyInto(o,e),n.isString(t)&&(t={search:t});const s=this.getFactory().nodeMap(this);return this.chainPost(s,function(){return i.getUri()+"/nodes/search"},o,t)},queryNodes:function(t,e){const i=this;t||(t={});const o={};e&&n.copyInto(o,e);const s=function(){return i.getUri()+"/nodes/query"},r=this.getFactory().nodeMap(this);return n.PREFER_GET_OVER_POST?(n.copyInto(o,{query:JSON.stringify(t)}),this.chainGet(r,s,o)):this.chainPost(r,s,o,t)},queryOne:function(t,n){return this.queryNodes(t).keepOne(function(t){if(n)return n(t),!1})},graphqlQuery:function(t,e,i,o){const s=this,r={query:t};i&&(r.constiables=i),e&&(r.operationName=e);const c=function(){return s.getUri()+"/graphql"};return n.PREFER_GET_OVER_POST?s.chainGetResponse(s,c,r).then(function(t){o(t)}):s.chainPostResponse(s,c,{},r).then(function(t){o(t)})},graphqlSchema:function(t){const n=this;return n.chainGetResponseText(n,function(){return n.getUri()+"/graphql/schema"},{}).then(function(n){t(n)})},deleteNodes:function(t){const n=this;return this.chainPost(this,function(){return n.getUri()+"/nodes/delete"},{},{_docs:t})},checkNodePermissions:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/nodes/permissions/check"},{},i).then(function(t){n.call(this,t.results)})},checkNodeAuthorities:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/nodes/authorities/check"},{},i).then(function(t){n.call(this,t.results)})},readPersonNode:function(t,n){const e=this,i=this.extractPrincipalDomainQualifiedId(t),o=this.getFactory().node(this,"n:person");return this.chainGet(o,function(){let t=e.getUri()+"/person/acquire?id="+i;return n&&(t+="&createIfNotFound="+n),t})},readGroupNode:function(t,n){const e=this,i=this.extractPrincipalDomainQualifiedId(t),o=this.getFactory().node(this,"n:group");return this.chainGet(o,function(){let t=e.getUri()+"/group/acquire?id="+i;return n&&(t+="&createIfNotFound="+n),t})},listDefinitions:function(t,e){t&&"object"==typeof t&&(e=t,t=null);const i=this,o={capabilities:"true"};t&&(o.filter=t),e&&n.copyInto(o,e);const s=this.getFactory().nodeMap(this);return this.chainGet(s,function(){return i.getUri()+"/definitions"},o)},queryDefinitions:function(t,e){const i=this,o={};e&&n.copyInto(o,e);const s=this.getFactory().nodeMap(this);return this.chainPost(s,function(){return i.getUri()+"/definitions/query"},o,t)},readDefinition:function(t){const n=this,e=this.getFactory().definition(this);return this.chainGet(e,function(){return n.getUri()+"/definitions/"+t})},loadSchemas:function(t,n){"function"==typeof t&&(n=t,t=null);const e=this;return this.then(function(){const i=this;let o=e.getUri()+"/schemas";return t&&(o+="?filter="+t),e.getDriver().gitanaGet(o,null,{},function(t){n.call(i,t),i.next()}),!1})},loadSchema:function(t,n){const e=this;return this.then(function(){const i=this,o=e.getUri()+"/schemas/"+t;return e.getDriver().gitanaGet(o,null,{},function(t){n.call(i,t),i.next()}),!1})},generateQName:function(t,n){const e=this;return this.then(function(){const i=this,o=e.getUri()+"/qnames/generate";return e.getDriver().gitanaPost(o,null,t,function(t){const e=t._qname;n.call(i,e),i.next()}),!1})},associate:function(t,e,i){let o=null;o=n.isString(t)?t:t.getId();let s=null;s=n.isString(e)?e:e.getId();const r=this.subchain(this);return r.subchain(this).then(function(){this.readNode(o).associate(s,i)}),r},traverse:function(t,e){let i=null;return i=n.isString(t)?t:t.getId(),this.readNode(i).traverse(e)},createContainer:function(t){return t||(t={}),t._features||(t._features={}),t._features["f:container"]={active:"true"},this.createNode(t)},find:function(t,e){const i=this,o={};e&&n.copyInto(o,e);const s=this.getFactory().nodeMap(this);return this.chainPost(s,function(){return i.getUri()+"/nodes/find"},o,t)},findNodes:function(t,n){return this.find(t,n)},listItems:function(t,e){const i=this;e&&n.copyInto({},e);const o=this.getFactory().nodeMap(this);return this.chainGet(o,function(){return i.getUri()+"/lists/"+t+"/items"},e)},queryItems:function(t,e,i){const o=this,s={};i&&n.copyInto(s,i);const r=this.getFactory().nodeMap(this);return this.chainPost(r,function(){return o.getUri()+"/lists/"+t+"/items/query"},s,e)},loadForms:function(t,n){const e=this;return this.then(function(){const i=this;let o=e.getUri()+"/forms";return t&&(o+="?filter="+t),e.getDriver().gitanaGet(o,null,{},function(t){n.call(i,t),i.next()}),!1})},adminRebuildPathIndexes:function(){const t=this;return this.then(function(){const n=this,e=t.getUri()+"/admin/paths/index";return t.getDriver().gitanaPost(e,null,{},function(){n.next()}),!1})},adminRebuildSearchIndexes:function(){const t=this;return this.then(function(){const n=this,e=t.getUri()+"/admin/search/index";return t.getDriver().gitanaPost(e,null,{},function(){n.next()}),!1})},adminContentMaintenance:function(){const t=this;return this.then(function(){const n=this,e=t.getUri()+"/admin/content";return t.getDriver().gitanaPost(e,null,{},function(){n.next()}),!1})},adminUpgradeSchema:function(){const t=this;return this.then(function(){const n=this,e=t.getUri()+"/admin/upgradeschema";return t.getDriver().gitanaPost(e,null,{},function(){n.next()}),!1})},createForExport:function(t,n,e){return n||(n={}),n.repositoryId||(n.repositoryId=this.getRepositoryId()),n.branchId||(n.branchId=this.getId()),n.properties||(n.properties={}),n.parentFolderPath||(n.parentFolderPath={}),this.chainPostResponse(this,function(){return"/ref/exports/"+t+"/generate"},{},n).then(function(t){e(t)})},loadInfo:function(t){return this.chainGetResponse(this,function(){return this.getUri()+"/info"},{}).then(function(n){t(n)})},createCustomIndex:function(t,n){const e=this;let i=null;return i=void 0===n?t:{name:t,index:n},this.chainPost(this,function(){return e.getUri()+"/indexes"},{},i)},dropCustomIndex:function(t){const n=this;return this.chainDelete(this,function(){return n.getUri()+"/indexes/"+t})},loadCustomIndexes:function(t){const n=this;return this.chainGetResponse(this,function(){return n.getUri()+"/indexes"},{}).then(function(n){t(n)})},loadHistoryChangesets:function(t,e,i){const o=this;"function"==typeof e&&(i=e,e=null),"function"==typeof t&&(i=t,t={},e=null),t||(t={});const s={};return e&&n.copyInto(s,e),t.root&&(s.root=t.root),t.tip&&(s.tip=t.tip),t.include_root&&(s.include_root=t.include_root),this.chainGetResponse(this,function(){return o.getUri()+"/history/changesets"},s).then(function(t){i(t)})},loadHistoryNodeDiffs:function(t,e,i){const o=this;"function"==typeof e&&(i=e,e=null),"function"==typeof t&&(i=t,t={},e=null),t||(t={});const s={};return e&&n.copyInto(s,e),t.root&&(s.root=t.root),t.tip&&(s.tip=t.tip),t.include_root&&(s.include_root=t.include_root),this.chainGetResponse(this,function(){return o.getUri()+"/history/nodediffs"},s).then(function(t){i(t)})},readDeletion:function(t){const n=this,e=this.getFactory().deletion(this);return this.chainGet(e,function(){return n.getUri()+"/deletions/"+t},{})},queryDeletions:function(t,e){const i=this;t||(t={});const o={};e&&n.copyInto(o,e);const s=function(){return i.getUri()+"/deletions/query"},r=this.getFactory().deletionMap(this);return n.PREFER_GET_OVER_POST?(n.copyInto(o,{query:JSON.stringify(t)}),this.chainGet(r,s,o)):this.chainPost(r,s,o,t)},purgeAllDeletions:function(){const t=this;return this.chainPostEmpty(null,function(){return t.getUri()+"/deletions/purgeall"})},archive:function(t){const n=this;return this.chainPostResponse(this,function(){return n.getUri()+"/archive"}).then(function(n){t(n)})},unarchive:function(t){const n=this;return this.chainPostResponse(this,function(){return n.getUri()+"/unarchive"}).then(function(n){t(n)})},startChangesetHistory:function(t,e){"function"==typeof t&&(e=t,t=null);const i={};if(n.isObject(t))for(const n in t)i[n]=t[n];return this.chainPostResponse(this,function(){return this.getUri()+"/history/start"},i).then(function(t){const n=t._doc;e(n)})}})}(window),function(t){const n=t.Gitana;n.BranchMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.BranchMap"},this.getRepository=function(){return t},this.getRepositoryId=function(){return t.getId()},this.base(t.getPlatform(),n)},clone:function(){return this.getFactory().branchMap(this.getRepository(),this)},buildObject:function(t){return this.getFactory().branch(this.getRepository(),t)}})}(window),function(t){const n=t.Gitana;n.Changeset=n.AbstractRepositoryObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.Changeset"}},getType:function(){return n.TypedIDConstants.TYPE_CHANGESET},getUri:function(){return"/repositories/"+this.getRepositoryId()+"/changesets/"+this.getId()},clone:function(){return this.getFactory().changeset(this.getRepository(),this)},listNodes:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().nodeMap(this);return this.chainGet(i,function(){return"/repositories/"+this.getRepositoryId()+"/changesets/"+this.getId()+"/nodes"},e)}})}(window),function(t){const n=t.Gitana;n.ChangesetMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.ChangesetMap"},this.getRepository=function(){return t},this.getRepositoryId=function(){return t.getId()},this.base(t.getPlatform(),n)},clone:function(){return this.getFactory().changesetMap(this.getRepository(),this)},buildObject:function(t){return this.getFactory().changeset(this.getRepository(),t)}})}(window),function(t){const n=t.Gitana;n.Deletion=n.AbstractRepositoryObject.extend({constructor:function(t,n){this.base(t.getRepository(),n),this.objectType=function(){return"Gitana.Deletion"},this.getBranch=function(){return t},this.getBranchId=function(){return t.getId()}},getType:function(){return n.TypedIDConstants.TYPE_DELETION},getUri:function(){return"/repositories/"+this.getRepositoryId()+"/branches/"+this.getBranchId()+"/deletions/"+this._deletion.nodeId},clone:function(){return this.getFactory().deletion(this.getBranch(),this)},ref:function(){return"deletion://"+this.getPlatformId()+"/"+this.getRepositoryId()+"/"+this.getBranchId()+"/"+this._deletion.nodeId},restore:function(t,n){const e=this;return"function"==typeof t&&(n=t,t={}),t||(t={}),this.chainPostResponse(null,function(){return e.getUri()+"/restore"},{},t).then(function(t){n.call(this,t)})}})}(window),function(t){const n=t.Gitana;n.DeletionMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.DeletionMap"},this.getRepository=function(){return t.getRepository()},this.getRepositoryId=function(){return t.getRepository().getId()},this.getBranch=function(){return t},this.getBranchId=function(){return t.getId()},this.base(t.getPlatform(),n)},clone:function(){return this.getFactory().deletionMap(this.getBranch(),this)},buildObject:function(t){return this.getFactory().deletion(this.getBranch(),t)},del:function(){const t=this,n=function(){return t.getBranch().getUri()+"/deletions/delete"};return this.subchain().then(function(){const t=this.__keys();return this.chainPost(this,n,{},{_docs:t})})}})}(window),function(t){const n=t.Gitana;n.MergeConflict=n.AbstractRepositoryObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.MergeConflict"}},getType:function(){return n.TypedIDConstants.TYPE_MERGE_CONFLICT},getUri:function(){return"/repositories/"+this.getRepositoryId()+"/conflicts/"+this.getId()},clone:function(){return this.getFactory().mergeConflict(this.getRepository(),this)},resolve:function(t,e){const i=this,o={};let s=null;return n.isString(t)?o.resolution=t:n.isArray(t)&&(s={resolutions:t}),this.chainPostResponse(this,function(){return i.getUri()+"/resolve"},o,s).then(function(t){e(t)})},commit:function(t){const n=this,e={};return t&&(e.branch=t),this.chainPost(this,function(){return n.getUri()+"/commit"},e)}})}(window),function(t){const n=t.Gitana;n.MergeConflictMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.MergeConflictMap"},this.getRepository=function(){return t},this.getRepositoryId=function(){return t.getId()},this.base(t.getPlatform(),n)},clone:function(){return this.getFactory().mergeConflictMap(this.getRepository(),this)},buildObject:function(t){return this.getFactory().mergeConflict(this.getRepository(),t)}})}(window),function(t){const n=t.Gitana;n.Node=n.AbstractNode.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.Node"}},getType:function(){return n.TypedIDConstants.TYPE_NODE},listChildren:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().nodeMap(this.getBranch());return this.chainGet(i,function(){return"/repositories/"+this.getRepositoryId()+"/branches/"+this.getBranchId()+"/nodes/"+this.getId()+"/children"},e)},listRelatives:function(t,e){let i=null,o=null;t&&(i=t.type,t.direction&&(o=t.direction.toUpperCase()));const s={};e&&n.copyInto(s,e);const r=this.getFactory().nodeMap(this.getBranch());return this.chainGet(r,function(){let t="/repositories/"+this.getRepositoryId()+"/branches/"+this.getBranchId()+"/nodes/"+this.getId()+"/relatives";return i&&(t=t+"?type="+i),o&&(t=i?t+"&direction="+o:t+"?direction="+o),t},s)},queryRelatives:function(t,e,i){let o=null,s=null;e&&(o=e.type,e.direction&&(s=e.direction.toUpperCase()));const r={};i&&n.copyInto(r,i);const c=this.getFactory().nodeMap(this.getBranch());return this.chainPost(c,function(){let t="/repositories/"+this.getRepositoryId()+"/branches/"+this.getBranchId()+"/nodes/"+this.getId()+"/relatives/query";return o&&(t=t+"?type="+o),s&&(t=o?t+"&direction="+s:t+"?direction="+s),t},r,t)},patch:function(t){const n=this.getFactory().nodeMap(this.getBranch());return this.chainPatch(n,function(){return this.getUri()},null,t)},associations:function(t,e){let i=null,o=null;t&&(i=t.type,t.direction&&(o=t.direction.toUpperCase()));const s={};e&&n.copyInto(s,e);const r=this.getFactory().nodeMap(this.getBranch());return this.chainGet(r,function(){let t="/repositories/"+this.getRepositoryId()+"/branches/"+this.getBranchId()+"/nodes/"+this.getId()+"/associations?a=1";return i&&(t=t+"&type="+i),o&&(t=t+"&direction="+o),t},s)},incomingAssociations:function(t,n){const e={direction:"INCOMING"};return t&&(e.type=t),this.associations(e,n)},outgoingAssociations:function(t,n){const e={direction:"OUTGOING"};return t&&(e.type=t),this.associations(e,n)},associate:function(t,e,i){return n.isString(t)||(t=t.getId()),e&&n.isString(e)&&(e={_type:e}),this.chainPostEmpty(null,function(){let n="/repositories/"+this.getRepositoryId()+"/branches/"+this.getBranchId()+"/nodes/"+this.getId()+"/associate?node="+t;return i&&(n+="&directionality=UNDIRECTED"),n},null,e)},associateOf:function(t,n,e){const i=this,o=this.subchain(this);return o.subchain(t).then(function(){this.associate(i,n,e)}),o},unassociate:function(t,e,i){return n.isString(t)||(t=t.getId()),this.chainPostEmpty(null,function(){let n="/repositories/"+this.getRepositoryId()+"/branches/"+this.getBranchId()+"/nodes/"+this.getId()+"/unassociate?node="+t;return e&&(n=n+"&type="+e),i&&(n+="&directionality=UNDIRECTED"),n})},traverse:function(t){const n={traverse:t},e=this.getFactory().traversalResults(this.getBranch());return this.chainPost(e,function(){return"/repositories/"+this.getRepositoryId()+"/branches/"+this.getBranchId()+"/nodes/"+this.getId()+"/traverse"},{},n)},mount:function(t){return this.chainPostEmpty(null,function(){return"/repositories/"+this.getRepositoryId()+"/branches/"+this.getBranchId()+"/nodes/"+this.getId()+"/mount/"+t},null,object)},unmount:function(){return this.chainPostEmpty(null,function(){return"/repositories/"+this.getRepositoryId()+"/branches/"+this.getBranchId()+"/nodes/"+this.getId()+"/unmount"},null,object)},lock:function(){return this.chainPostEmpty(null,function(){return"/repositories/"+this.getRepositoryId()+"/branches/"+this.getBranchId()+"/nodes/"+this.getId()+"/lock"})},unlock:function(){return this.chainPostEmpty(null,function(){return"/repositories/"+this.getRepositoryId()+"/branches/"+this.getBranchId()+"/nodes/"+this.getId()+"/unlock"})},checkLocked:function(t){return this.subchain(this).then(function(){const n=this,e="/repositories/"+this.getRepositoryId()+"/branches/"+this.getBranchId()+"/nodes/"+this.getId()+"/lock";return this.getDriver().gitanaGet(e,null,{},function(e){t.call(n,e.locked),n.next()}),!1})},loadACL:function(t){const n=this;return this.chainGetResponse(this,function(){return n.getUri()+"/acl/list"}).then(function(n){t.call(this,n)})},listAuthorities:function(t){const n=this.extractPrincipalDomainQualifiedId(t);return this.chainGetResponseRows(this,function(){return"/repositories/"+this.getRepositoryId()+"/branches/"+this.getBranchId()+"/nodes/"+this.getId()+"/acl?id="+n})},checkAuthority:function(t,n,e){const i=this.extractPrincipalDomainQualifiedId(t);return this.chainPostResponse(this,function(){return"/repositories/"+this.getRepositoryId()+"/branches/"+this.getBranchId()+"/nodes/"+this.getId()+"/authorities/"+n+"/check?id="+i}).then(function(t){e.call(this,t.check)})},grantAuthority:function(t,n){const e=this.extractPrincipalDomainQualifiedId(t);return this.chainPostEmpty(null,function(){return"/repositories/"+this.getRepositoryId()+"/branches/"+this.getBranchId()+"/nodes/"+this.getId()+"/authorities/"+n+"/grant?id="+e})},revokeAuthority:function(t,n){const e=this.extractPrincipalDomainQualifiedId(t);return this.chainPostEmpty(null,function(){return"/repositories/"+this.getRepositoryId()+"/branches/"+this.getBranchId()+"/nodes/"+this.getId()+"/authorities/"+n+"/revoke?id="+e})},revokeAllAuthorities:function(t){return this.revokeAuthority(t,"all")},loadAuthorityGrants:function(t,n){t||(t=[]);const e={principals:t};return this.chainPostResponse(this,"/repositories/"+this.getRepositoryId()+"/branches/"+this.getBranchId()+"/nodes/"+this.getId()+"/authorities",{},e).then(function(t){n.call(this,t)})},checkPermission:function(t,n,e){const i=this.extractPrincipalDomainQualifiedId(t);return this.chainPostResponse(this,function(){return"/repositories/"+this.getRepositoryId()+"/branches/"+this.getBranchId()+"/nodes/"+this.getId()+"/permissions/"+n+"/check?id="+i}).then(function(t){e.call(this,t.check)})},createTranslation:function(t,n,e){const i=function(){let e="/repositories/"+this.getRepositoryId()+"/branches/"+this.getBranchId()+"/nodes/"+this.getId()+"/i18n?locale="+n;return t&&(e+="&edition="+t),e},o=this.getFactory().node(this.getBranch());return this.chainCreateEx(o,e,i,i)},editions:function(t){return this.chainGetResponse(this,function(){return"/repositories/"+this.getRepositoryId()+"/branches/"+this.getBranchId()+"/nodes/"+this.getId()+"/i18n/editions"}).then(function(n){t.call(this,n.editions)})},locales:function(t,n){return this.chainGetResponse(this,function(){return"/repositories/"+this.getRepositoryId()+"/branches/"+this.getBranchId()+"/nodes/"+this.getId()+"/i18n/locales?edition="+t}).then(function(t){n.call(this,t.locales)})},listTranslations:function(t,e){const i={};t&&(i.edition=t),e&&n.copyInto(i,e);const o=this.getFactory().nodeMap(this.getBranch());return this.chainGet(o,function(){return"/repositories/"+this.getRepositoryId()+"/branches/"+this.getBranchId()+"/nodes/"+this.getId()+"/i18n/translations"},i)},readTranslation:function(){let t,e;const i=n.makeArray(arguments);1===i.length?e=i.shift():i.length>1&&(t=i.shift(),e=i.shift());const o=this.getFactory().node(this.getBranch());return this.chainGet(o,function(){let n="/repositories/"+this.getRepositoryId()+"/branches/"+this.getBranchId()+"/nodes/"+this.getId()+"/i18n?locale="+e;return t&&(n+="&edition="+t),n})},createChild:function(t){const e=this,i=new n.Branch(this.getRepository()),o=this.getFactory().node(i);return this.subchain(o).then(function(){const n=this;this.subchain(e).then(function(){i.loadFrom(this.getBranch()),this.subchain(i).createNode(t).then(function(){n.loadFrom(this),this.childOf(e)})})})},childOf:function(t){return this.associateOf(t,"a:child")},find:function(t,e){const i={};e&&n.copyInto(i,e);const o=this.getFactory().nodeMap(this.getBranch());return this.chainPost(o,function(){return"/repositories/"+this.getRepositoryId()+"/branches/"+this.getBranchId()+"/nodes/"+this.getId()+"/find"},i,t)},findRelatives:function(t,e,i){let o=null,s=null;e&&(o=e.type,e.direction&&(s=e.direction.toUpperCase()),delete e.type,delete e.direction);const r={};i&&n.copyInto(r,i);const c=this.getFactory().nodeMap(this.getBranch());return this.chainPost(c,function(){let t="/repositories/"+this.getRepositoryId()+"/branches/"+this.getBranchId()+"/nodes/"+this.getId()+"/relatives/find";return o&&(t=t+"?type="+o),s&&(t=o?t+"&direction="+s:t+"?direction="+s),t},r,t)},loadTree:function(t,n){const e=this;"function"==typeof t&&(n=t,t=null),t||(t={});const i={};t.leafPath?i.leaf=t.leafPath:t.leaf&&(i.leaf=t.leaf),t.basePath?i.base=t.basePath:t.base&&(i.base=t.base),t.containers&&(i.containers=!0),t.properties&&(i.properties=!0),t.object&&(i.object=!0),i.depth=1,t.depth&&(i.depth=t.depth);const o={};return t.query&&(o.query=t.query),t.search&&(o.search=t.search),this.chainPostResponse(this,function(){return e.getUri()+"/tree"},i,o).then(function(t){n.call(this,t)})},resolvePath:function(t,n){const e=this,i={rootNodeId:t};return this.chainGetResponse(this,function(){return e.getUri()+"/path"},i).then(function(t){n.call(this,t.path)})},listVersions:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().nodeMap(this.getBranch());return this.chainGet(i,function(){return this.getUri()+"/versions"},e)},restoreVersion:function(t){const n=this.getFactory().node(this.getBranch());return this.chainPost(n,function(){return"/repositories/"+this.getRepositoryId()+"/branches/"+this.getBranchId()+"/nodes/"+this.getId()+"/versions/"+t+"/restore"},{},{})},moveToFolder:function(t){const n=this,e={};return e.targetNodeId=t.getId?t.getId():t,this.chainPostEmpty(this,function(){return n.getUri()+"/move"},e)}})}(window),function(t){const n=t.Gitana;n.NodeAttachment=n.BinaryAttachment.extend({constructor:function(t,n){this.base(t,n)},getFilename:function(){return this.filename}})}(window),function(t){const n=t.Gitana;n.NodeAttachmentMap=n.BinaryAttachmentMap.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.NodeAttachmentMap"}},clone:function(){return new n.NodeAttachmentMap(this.__persistable(),this)},buildObject:function(t){return new n.NodeAttachment(this.__persistable(),t)}})}(window),function(t){const n=t.Gitana;n.NodeMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.NodeMap"},this.getRepository=function(){return t.getRepository()},this.getRepositoryId=function(){return t.getRepository().getId()},this.getBranch=function(){return t},this.getBranchId=function(){return t.getId()},this.base(t.getPlatform(),n)},clone:function(){return this.getFactory().nodeMap(this.getBranch(),this)},buildObject:function(t){return this.getFactory().node(this.getBranch(),t)},del:function(){const t=this,n=function(){return t.getBranch().getUri()+"/nodes/delete"};return this.subchain().then(function(){const t=this.__keys();return this.chainPost(this,n,{},{_docs:t})})}})}(window),function(t){const n=t.Gitana;n.Release=n.AbstractRepositoryObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.Release"}},getType:function(){return n.TypedIDConstants.TYPE_RELEASE},getUri:function(){return"/repositories/"+this.getRepositoryId()+"/releases/"+this.getId()},clone:function(){return this.getFactory().release(this.getRepository(),this)},finalize:function(t,n){"function"==typeof t&&(n=t,t=null),t||(t={});const e=this;return this.chainPostResponse(this,function(){return e.getUri()+"/finalize"},{},t).then(function(t){n(t)})},unfinalize:function(t){const n=this;return this.chainPostResponse(this,function(){return n.getUri()+"/unfinalize"}).then(function(n){t(n)})},loadInfo:function(t){const n=this;return this.chainGetResponse(this,function(){return n.getUri()+"/info"},{}).then(function(n){t(n)})},startFinalize:function(t,n){const e=this;return"function"==typeof t&&(n=t,t=null),t||(t={}),this.chainPostResponse(this,function(){return e.getUri()+"/finalize/start"},{},t).then(function(t){const e=t._doc;n(e)})},archive:function(t){const n=this;return this.chainPostResponse(this,function(){return n.getUri()+"/archive"}).then(function(n){t(n)})},unarchive:function(t){const n=this;return this.chainPostResponse(this,function(){return n.getUri()+"/unarchive"}).then(function(n){t(n)})},releaseImmediately:function(t){const n=this;return this.chainPostResponse(this,function(){return n.getUri()+"/releaseimmediately"}).then(function(n){t(n)})}})}(window),function(t){const n=t.Gitana;n.ReleaseMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.ReleaseMap"},this.getRepository=function(){return t},this.getRepositoryId=function(){return t.getId()},this.base(t.getPlatform(),n)},clone:function(){return this.getFactory().releaseMap(this.getRepository(),this)},buildObject:function(t){return this.getFactory().release(this.getRepository(),t)}})}(window),function(t){const n=t.Gitana;n.Repository=n.AbstractPlatformDataStore.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.Repository"}},getType:function(){return n.TypedIDConstants.TYPE_REPOSITORY},getUri:function(){return"/repositories/"+this.getId()},clone:function(){return this.getFactory().repository(this.getPlatform(),this)},listBranches:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().branchMap(this);return this.chainGet(i,function(){return"/repositories/"+this.getId()+"/branches"},e)},readBranch:function(t){const n=this.getFactory().branch(this);return this.chainGet(n,function(){return"/repositories/"+this.getId()+"/branches/"+t})},createBranch:function(t,n,e){const i={branch:t,changeset:n},o=this.getFactory().branch(this);return this.chainCreate(o,e,function(){return"/repositories/"+this.getId()+"/branches"},i)},createSnapshot:function(t,n){const e={changeset:t},i=this.getFactory().branch(this);return this.chainCreate(i,n,function(){return"/repositories/"+this.getId()+"/snapshots"},e)},queryBranches:function(t,e){const i={};e&&n.copyInto(i,e);const o=this.getFactory().branchMap(this);return this.chainPost(o,function(){return"/repositories/"+this.getId()+"/branches/query"},i,t)},listPullSources:function(t,e){const i={};e&&n.copyInto(i,e);const o=this.getFactory().branchMap(this);return this.chainGet(o,function(){return"/repositories/"+this.getId()+"/branches/"+t+"/pull/sources"},i)},checkBranchPermissions:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/repositories/"+this.getId()+"/branches/permissions/check"},{},e).then(function(t){n.call(this,t.results)})},checkBranchAuthorities:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/repositories/"+this.getId()+"/branches/authorities/check"},{},e).then(function(t){n.call(this,t.results)})},listChangesets:function(){const t=this.getFactory().changesetMap(this);return this.chainGet(t,function(){return"/repositories/"+this.getId()+"/changesets"})},readChangeset:function(t){const n=this.getFactory().changeset(this);return this.chainGet(n,function(){return"/repositories/"+this.getId()+"/changesets/"+t})},listChangesetParents:function(t){const n=this.getFactory().changesetMap(this);return this.chainGet(n,function(){return"/repositories/"+this.getId()+"/changesets/"+t+"/parents"})},listChangesetChildren:function(t){const n=this.getFactory().changesetMap(this);return this.chainGet(n,function(){return"/repositories/"+this.getId()+"/changesets/"+t+"/children"})},queryChangesets:function(t,e){const i={};e&&n.copyInto(i,e);const o=this.getFactory().changesetMap(this);return this.chainPost(o,function(){return"/repositories/"+this.getId()+"/changesets/query"},i,t)},startMerge:function(t,n,e){const i={id:t};return this.chainPostResponse(this,function(){return"/repositories/"+this.getId()+"/branches/"+n+"/merge/start"},i).then(function(t){const n=t._doc;e(n)})},startDiff:function(t,n,e){const i={id:t};return this.chainPostResponse(this,function(){return"/repositories/"+this.getId()+"/branches/"+n+"/diff/start"},i).then(function(t){const n=t._doc;e(n)})},startChanges:function(t,e,i,o){"function"==typeof i&&(o=i,i=null);const s={};if("string"==typeof i)s.view=i;else if(n.isObject(i))for(const t in i)s[t]=i[t];return s.id=t,this.chainPostResponse(this,function(){return"/repositories/"+this.getId()+"/branches/"+e+"/changes/start"},s).then(function(t){const n=t._doc;o(n)})},listMerges:function(t,n){const e={};n&&(e.mergeType=n);const i=this.getFactory().branchMap(this);return this.chainGet(i,function(){return"/repositories/"+this.getId()+"/branches/"+t+"/merges"},e)},copyFrom:function(t,n,e){const i={id:t};return this.chainPost(this,function(){return"/repositories/"+this.getId()+"/branches/"+n+"/copyfrom"},i,e)},listReleases:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().releaseMap(this);return this.chainGet(i,function(){return"/repositories/"+this.getId()+"/releases"},e)},readRelease:function(t){const n=this.getFactory().release(this);return this.chainGet(n,function(){return"/repositories/"+this.getId()+"/releases/"+t})},createRelease:function(t,n){const e={};n&&(e.sourceId=n);const i=this.getFactory().release(this);return this.chainCreate(i,t,function(){return"/repositories/"+this.getId()+"/releases"},e)},startCreateRelease:function(t,n,e){const i=this;"function"==typeof t&&(e=t,n=null,t=null),"function"==typeof n&&(e=n,n=null),t||(t={});const o={};return n&&(o.sourceId=n),this.chainPostResponse(this,function(){return i.getUri()+"/releases/create/start"},o,t).then(function(t){const n=t._doc;e(n)})},queryReleases:function(t,e){const i={};e&&n.copyInto(i,e);const o=this.getFactory().releaseMap(this);return this.chainPost(o,function(){return"/repositories/"+this.getId()+"/releases/query"},i,t)},checkReleasePermissions:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/repositories/"+this.getId()+"/releases/permissions/check"},{},e).then(function(t){n.call(this,t.results)})},checkReleaseAuthorities:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/repositories/"+this.getId()+"/releases/authorities/check"},{},e).then(function(t){n.call(this,t.results)})},listConflicts:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().mergeConflictMap(this);return this.chainGet(i,function(){return"/repositories/"+this.getId()+"/conflicts"},e)},readConflict:function(t){const n=this.getFactory().mergeConflict(this);return this.chainGet(n,function(){return"/repositories/"+this.getId()+"/conflicts/"+t})},queryConflicts:function(t,e){const i={};e&&n.copyInto(i,e);const o=this.getFactory().mergeConflictMap(this);return this.chainPost(o,function(){return"/repositories/"+this.getId()+"/conflicts/query"},i,t)},checkConflictPermissions:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/repositories/"+this.getId()+"/conflicts/permissions/check"},{},e).then(function(t){n.call(this,t.results)})},checkConflictAuthorities:function(t,n){const e={checks:t};return this.chainPostResponse(this,function(){return"/repositories/"+this.getId()+"/conflicts/authorities/check"},{},e).then(function(t){n.call(this,t.results)})},getMaxSize:function(){return this.get("maxSize")},getSize:function(){return this.get("size")},getObjectCount:function(){return this.get("objectcount")}})}(window),function(t){const n=t.Gitana;n.RepositoryMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.RepositoryMap"},this.base(t,n)},clone:function(){return this.getFactory().repositoryMap(this.getPlatform(),this)},buildObject:function(t){return this.getFactory().repository(this.getPlatform(),t)}})}(window),function(t){const n=t.Gitana;n.TraversalResults=n.AbstractPersistable.extend({constructor:function(t,n){this._nodes||(this._nodes={}),this._associations||(this._associations={}),this._config||(this._config={}),this.base(t.getDriver(),n),this.getRepository=function(){return t.getRepository()},this.getRepositoryId=function(){return t.getRepository().getId()},this.getBranch=function(){return t},this.getBranchId=function(){return t.getId()}},clear:function(){n.deleteProperties(this._nodes,!0),n.deleteProperties(this._associations,!0),n.deleteProperties(this._config,!0)},handleResponse:function(t){this.clear(),this.handleSystemProperties(t),n.copyInto(this._nodes,t.nodes),n.copyInto(this._associations,t.associations),n.copyInto(this._config,t.config),this._config.center=t.node},center:function(){const t=this.getFactory().node(this.getBranch()),n=this.subchain(t);return n.subchain(this.getBranch()).readNode(this._config.center).then(function(){n.handleResponse(this)}),n},nodeCount:function(t){return this.then(function(){t.call(this,n.getNumberOfKeys(this._nodes))})},associationCount:function(t){return this.then(function(){t.call(this,n.getNumberOfKeys(this._associations))})},nodes:function(){const t=this;return this.subchain(this.getFactory().nodeMap(this.getBranch())).then(function(){const n={rows:t._nodes};this.handleResponse(n)})},node:function(t){const n=this;return this.subchain(this.getFactory().node(this.getBranch())).then(function(){const e=n._nodes[t];if(!e)return n.missingNodeError(t);this.handleResponse(e)})},associations:function(){const t=this;return this.subchain(this.getFactory().nodeMap(this.getBranch())).then(function(){const n={rows:t._associations};this.handleResponse(n)})},association:function(t){const n=this;return this.subchain(this.getFactory().association(this.getBranch())).then(function(){const e=n._associations[t];if(!e)return n.missingNodeError(t);this.handleResponse(e)})}})}(window),function(t){const n=t.Gitana;n.Definition=n.Node.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.Definition"}},clone:function(){return this.getFactory().definition(this.getBranch(),this)},listFormAssociations:function(){const t=this,n=this.getFactory().nodeMap(this.getBranch());return this.chainGet(n,function(){return t.getUri()+"/forms"})},readForm:function(t){const n=this,e=this.getFactory().form(this.getBranch());return this.chainGet(e,function(){return n.getUri()+"/forms/"+t})},createForm:function(t,n,e){const i=this;"string"==typeof n&&(e=n,n=null),n||(n={}),n._type="n:form";const o=this.getFactory().form(this.getBranch()),s=this.subchain(o);return s.subchain(this.getBranch()).createNode(n,e).then(function(){const n=this;this.subchain(i).then(function(){const e={_type:"a:has_form","form-key":t};this.associate(n,e).then(function(){const t=this,e="/repositories/"+n.getRepositoryId()+"/branches/"+n.getBranchId()+"/nodes/"+n.getId();return this.getDriver().gitanaGet(e,null,{},function(n){s.handleResponse(n),t.next()}),!1})})}),s},removeFormAssociation:function(t){return this.subchain(this).then(function(){let n=null;this.listFormAssociations().each(function(){this.getFormKey()===t&&(n=this)}).then(function(){n&&this.subchain(n).del()})})},listChildDefinitions:function(t){const e=this,i={};t&&n.copyInto(i,t);const o=this.getFactory().nodeMap(this.getBranch());return this.chainGet(o,function(){return e.getBranch().getUri()+"/definitions/"+this.getQName()+"/children"},i)}}),n.ObjectFactory.register("d:type",n.Definition),n.ObjectFactory.register("d:feature",n.Definition),n.ObjectFactory.register("d:association",n.Definition)}(window),function(t){const n=t.Gitana;n.Form=n.Node.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.Form"}},clone:function(){return this.getFactory().form(this.getBranch(),this)},getEngineId:function(){return this.get("engineId")},setEngineId:function(t){this.set("engineId",t)}}),n.ObjectFactory.register("n:form",n.Form)}(window),function(t){const n=t.Gitana;n.HasFormAssociation=n.Association.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.HasFormAssociation"}},clone:function(){return new n.HasFormAssociation(this.getBranch(),this)},getFormKey:function(){return this.get("form-key")},setFormKey:function(t){this.set("form-key",t)}}),n.ObjectFactory.register("a:has_form",n.HasFormAssociation)}(window),function(t){const n=t.Gitana;n.HasTranslationAssociation=n.Association.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.HasTranslationAssociation"}},clone:function(){return new n.HasTranslationAssociation(this.getBranch(),this)},getLocale:function(){return this.get("locale")},setLocale:function(t){this.set("locale",t)},getEdition:function(){return this.get("edition")},setEdition:function(t){this.set("edition",t)}}),n.ObjectFactory.register("a:has_translation",n.HasTranslationAssociation)}(window),function(t){const n=t.Gitana;n.Person=n.Node.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.Person"}},clone:function(){return new n.Person(this.getBranch(),this)},getPrincipalName:function(){return this.get("principal-name")},getPrincipalType:function(){return this.get("principal-type")},getPrincipalId:function(){return this.get("principal-id")},getPrincipalDomainId:function(){return this.get("principal-domain")},readPrincipal:function(){return this.subchain(this.getPlatform()).readDomain(this.getPrincipalDomainId()).readPrincipal(this.getPrincipalId())},getFirstName:function(){return this.get("firstName")},setFirstName:function(t){this.set("firstName",t)},getLastName:function(){return this.get("lastName")},setLastName:function(t){this.set("lastName",t)},getCompanyName:function(){return this.get("companyName")},setCompanyName:function(t){this.set("companyName",t)},getEmail:function(){return this.get("email")},setEmail:function(t){this.set("email",t)},getJobTitle:function(){return this.get("jobTitle")},setJobTitle:function(t){this.set("jobTitle",t)},getAddress:function(){return this.get("address")},setAddress:function(t){this.set("address",t)},getCity:function(){return this.get("city")},setCity:function(t){this.set("city",t)},getState:function(){return this.get("state")},setState:function(t){this.set("state",t)},getZipcode:function(){return this.get("zipcode")},setZipcode:function(t){this.set("zipcode",t)},getPhoneNumber:function(){return this.get("phoneNumber")},setPhoneNumber:function(t){this.set("phoneNumber",t)}}),n.ObjectFactory.register("n:person",n.Person)}(window),function(t){const n=t.Gitana;n.Response=Base.extend({constructor:function(t){n.copyInto(this,t)},getId:function(){return this._doc},isStatusDocument:function(){return this.ok||this.error},isListDocument:function(){return this.total_rows&&this.rows&&this.offset},isDataDocument:function(){return!this.isStatusDocument()&&!this.isListDocument()},isOk:function(){let t=!0;return this.isStatusDocument()&&null!=this.ok&&(t=this.ok),this.error&&(t=!1),t},isError:function(){return!this.isOk()}})}(window),function(t){const n=t.Gitana;n.ResultMap=n.AbstractMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.ResultMap"},this.base(t,n)},clone:function(){return this.getFactory().resultMap(this.getDriver(),this)},buildObject:function(t){return t}})}(window),function(t){const n=t.Gitana;n.Role=n.AbstractObject.extend({constructor:function(t,n,e){this.base(t.getDriver(),e),this.objectType=function(){return"Gitana.Role"},this.roleContainer=n,this.getCluster=function(){return t}},getUri:function(){return this.roleContainer.getUri()+"/roles/"+this.getId()},getType:function(){return"role"},del:function(){return this.chainDelete(this.roleContainer,function(){return this.getUri()})},reload:function(){return this.chainReload(null,function(){return this.getUri()})},update:function(){return this.chainUpdate(null,function(){return this.getUri()})},getRoleKey:function(){return this.roleKey},getPermissions:function(){return this.object.permissions}})}(window),function(t){const n=t.Gitana;n.RoleMap=n.AbstractMap.extend({constructor:function(t,n,e){this.objectType=function(){return"Gitana.RoleMap"},this.getCluster=function(){return t},this.base(t.getDriver(),e),this.roleContainer=n},clone:function(){return this.getFactory().roleMap(this.getCluster(),this.roleContainer,this)},buildObject:function(t){return this.getFactory().role(this.getCluster(),this.roleContainer,t)}})}(window),function(t){const n=t.Gitana;n.SystemMetadata=Base.extend({constructor:function(){this.base()},updateFrom:function(t){n.deleteProperties(this,!1),n.copyInto(this,t)},get:function(t){return this[t]},getChangesetId:function(){return this.get("changeset")},getCreatedBy:function(){return this.get("created_by")},getCreatedByPrincipalId:function(){return this.get("created_by_principal_id")},getCreatedByPrincipalDomainId:function(){return this.get("created_by_principal_domain_id")},getModifiedBy:function(){return this.get("modified_by")},getModifiedByPrincipalId:function(){return this.get("modified_by_principal_id")},getModifiedByPrincipalDomainId:function(){return this.get("modified_by_principal_domain_id")},getCreatedOn:function(){return this.createdOn||(this.createdOn=new n.Timestamp(this.get("created_on"))),this.createdOn},getModifiedOn:function(){return this.modifiedOn||(this.modifiedOn=new n.Timestamp(this.get("modified_on"))),this.modifiedOn}})}(window),function(t){const n=t.Gitana;n.Team=n.AbstractObject.extend({constructor:function(t,e,i){this.__teamable=function(){let t=null;return function(e){return n.isUndefined(e)||(t=e),t}}(),this.__teamable(e),this.objectType=function(){return"Gitana.Team"},this.getCluster=function(){return t},this.base(t.getDriver(),i)},clone:function(){return this.getFactory().team(this.getCluster(),this.__teamable(),this)},getUri:function(){return this.__teamable().getUri()+"/teams/"+this.getKey()},getType:function(){return"team"},del:function(){return this.chainDelete(this.__teamable(),function(){return this.getUri()})},reload:function(){return this.chainReload(null,function(){return this.getUri()})},update:function(){return this.chainUpdate(null,function(){return this.getUri()})},addMember:function(t){const n=this;return this.chainPostEmpty(null,function(){const e=n.extractPrincipalDomainQualifiedId(t);return this.getUri()+"/members/add?id="+e})},removeMember:function(t){const n=this.extractPrincipalDomainQualifiedId(t);return this.chainPostEmpty(null,function(){return this.getUri()+"/members/remove?id="+n})},hasMember:function(t,n){const e={};return e.id=this.extractPrincipalDomainQualifiedId(t),this.chainPostResponse(null,function(){return this.getUri()+"/members/check"},e).then(function(t){n(t.belongs)})},listMembers:function(t){const e={};t&&n.copyInto(e,t);const i=new n.TeamMemberMap(this);return this.chainGet(i,function(){return this.getUri()+"/members"},e)},grant:function(t){return this.chainPostEmpty(null,function(){return this.getUri()+"/authorities/"+t+"/grant"})},revoke:function(t){return this.chainPostEmpty(null,function(){return this.getUri()+"/authorities/"+t+"/revoke"})},loadAuthorities:function(t){return this.chainGetResponse(this,function(){return this.getUri()+"/authorities"}).then(function(n){t.call(this,n.authorities)})},getKey:function(){return this.get("key")},getGroupId:function(){return this.get("groupId")},getRoleKeys:function(){return this.get("roleKeys")}})}(window),function(t){const n=t.Gitana;n.TeamMap=n.AbstractMap.extend({constructor:function(t,e,i){this.__teamable=function(){let t=null;return function(e){return n.isUndefined(e)||(t=e),t}}(),this.__teamable(e),this.objectType=function(){return"Gitana.TeamMap"},this.getCluster=function(){return t},this.base(t.getDriver(),i)},clone:function(){return this.getFactory().teamMap(this.getCluster(),this.__teamable(),this)},buildObject:function(t){return this.getFactory().team(this.getCluster(),this.__teamable(),t)}})}(window),function(t){const n=t.Gitana;n.TeamMember=n.AbstractObject.extend({constructor:function(t,n){this.base(t.getDriver(),n),this.objectType=function(){return"Gitana.TeamMember"},this.getTeam=function(){return t},this.getCluster=function(){return t.getCluster()},this.getClusterId=function(){return t.getClusterId()}}})}(window),function(t){const n=t.Gitana;n.TeamMemberMap=n.AbstractMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.TeamMemberMap"},this.getTeam=function(){return t},this.base(t.getDriver(),n)},clone:function(){return new n.TeamMemberMap(this.getTeam(),this)},buildObject:function(t){return new n.TeamMember(this.getTeam(),t)}})}(window),function(t){t.Gitana.Timestamp=Base.extend({constructor:function(t){this.base(t)},getYear:function(){return this.year},getMonth:function(){return this.month},getDay:function(){return this.day_of_month},getHour:function(){return this.hour},getMinute:function(){return this.minute},getSecond:function(){return this.second},getMillisecond:function(){return this.millisecond},getTime:function(){return this.ms},getTimestamp:function(){return this.timestamp}})}(window),function(t){Gitana.uniqueIdCounter=0,Gitana.makeArray=function(t){return Array.prototype.slice.call(t)},Gitana.stringify=function(t,n){let e=null;return Gitana.isEmpty(t)||(e=n?JSON.stringify(t,null,"  "):JSON.stringify(t)),e},Gitana.isString=function(t){return"string"==typeof t},Gitana.isNumber=function(t){return"number"==typeof t},Gitana.isBoolean=function(t){return"boolean"==typeof t},Gitana.isFunction=function(t){return"[object Function]"===Object.prototype.toString.call(t)},Gitana.isObject=function(t){return!Gitana.isUndefined(t)&&"[object Object]"===Object.prototype.toString.call(t)},Gitana.startsWith=function(t,n){return t.substr(0,n.length)===n},Gitana.copyInto=function(t,n){for(let e in n)n.hasOwnProperty(e)&&!this.isFunction(n[e])&&(t[e]=n[e])},Gitana.deleteProperties=function(t,n){const e=[];for(let n in t)e.push(n);for(let i=0;i<e.length;i++){const o=e[i];t.hasOwnProperty(o)&&(!Gitana.isFunction(t[o])||n&&Gitana.isFunction(t[o]))&&delete t[o]}},Gitana.stampInto=function(t,n){for(let e in n)n.hasOwnProperty(e)&&(t[e]=n[e])},Gitana.contains=function(t,n){let e=t.length;for(;e--;)if(t[e]===n)return!0;return!1},Gitana.isArray=function(t){return t.push&&t.slice},Gitana.isUndefined=function(t){return void 0===t},Gitana.isEmpty=function(t){return this.isUndefined(t)||null==t},Gitana.generateId=function(){return Gitana.uniqueIdCounter++,"gitana-"+Gitana.uniqueIdCounter},Gitana.isNode=function(t){return"object"==typeof Node?t instanceof Node:"object"==typeof t&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},Gitana.isElement=function(t){return"object"==typeof HTMLElement?t instanceof HTMLElement:"object"==typeof t&&1===t.nodeType&&"string"==typeof t.nodeName},Gitana.debug=function(t){this.isUndefined(console)||console.log(t)},Gitana.error=function(t){this.isUndefined(console)||console.error(t)},Gitana.getNumberOfKeys=function(t){let n=0;for(let e in t)n++;return n},Gitana.writeCookie=function(t,n,e,i,o){"undefined"!=typeof document&&function(t,n,e,i,o){e||(e="/");const s=";path="+e;let r="";if(void 0===i||-1===i);else if(0===i)r=";expires=Thu, 01 Jan 1970 00:00:01 GMT";else if(i>0){const t=new Date;t.setTime(t.getTime()+24*i*60*60*1e3),r=";expires="+t.toGMTString()}let c="";o&&(c=";domain="+o),document.cookie=t+"="+n+r+s+c+";"}(t,n,e,i,o)},Gitana.deleteCookie=function(n,e){const i=function(t){return Gitana.readCookie(t)};if("undefined"!=typeof document&&(i(n)&&Gitana.writeCookie(n,"",e,0),i(n)&&t)){let i=t.location.host;if(i){const t=i.indexOf(":");t>-1&&(i=i.substring(0,t))}Gitana.writeCookie(n,"",e,0,i)}},Gitana.readCookie=function(t){let n=null;return"undefined"!=typeof document&&(n=function(t){const n=t+"=",e=document.cookie.split(";");for(let t=0;t<e.length;t++){let i=e[t];for(;" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(n))return i.substring(n.length,i.length)}return null}(t)),n},Gitana.getCurrentQueryStringParameter=function(n){let e,i,o=t.location.search.substring(1).split("&");for(e=0;e<o.length;e++)if((i=o[e].split("="))[0]===n)return unescape(i[1]);return null},Gitana.getCurrentHashStringParameter=function(n){const e=t.location.href.substring(t.location.href.indexOf("#")+1).split("&");for(i=0;i<e.length;i++)if(val=e[i].split("="),val[0]===n)return unescape(val[1]);return null},Gitana.btoa=function(t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let e,i,o=0,s=t.length,r="";for(;o<s;o+=3)i=[(e=[t.charCodeAt(o),t.charCodeAt(o+1),t.charCodeAt(o+2)])[0]>>2,(3&e[0])<<4|e[1]>>4,(15&e[1])<<2|e[2]>>6,63&e[2]],isNaN(e[1])&&(i[2]=64),isNaN(e[2])&&(i[3]=64),r+=n.charAt(i[0])+n.charAt(i[1])+n.charAt(i[2])+n.charAt(i[3]);return r},Gitana.copyKeepers=function(t,n){if(n)for(let e in n)n.hasOwnProperty(e)&&!this.isFunction(n[e])&&(Gitana.isUndefined(t[e])||(t[e]=n[e]))}}(window),function(t){const n=t.Gitana;n.AbstractVaultObject=n.AbstractPlatformObject.extend({constructor:function(t,n){this.base(t.getPlatform(),n),this.objectType=function(){return"Gitana.Archive"},this.getVault=function(){return t},this.getVaultId=function(){return t.getId()}},ref:function(){return this.getType()+"://"+this.getPlatformId()+"/"+this.getVaultId()+"/"+this.getId()}})}(window),function(t){const n=t.Gitana;n.Archive=n.AbstractVaultObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.Archive"}},getType:function(){return n.TypedIDConstants.TYPE_ARCHIVE},getUri:function(){return"/vaults/"+this.getVaultId()+"/archives/"+this.getId()},clone:function(){return this.getFactory().archive(this.getVault(),this)},getDownloadUri:function(){return this.getProxiedUri()+"/download"},listAttachments:n.Methods.listAttachments(),attachment:function(t){return this.listAttachments().select(t)},attach:n.Methods.attach(),unattach:n.Methods.unattach(),getPreviewUri:n.Methods.getPreviewUri(),publish:function(){const t=this;return this.chainPostEmpty(null,function(){return t.getUri()+"/publish"})},unpublish:function(){const t=this;return this.chainPostEmpty(null,function(){return t.getUri()+"/unpublish"})}})}(window),function(t){const n=t.Gitana;n.ArchiveMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.ArchiveMap"},this.getVault=function(){return t},this.getVaultId=function(){return t.getId()},this.base(t.getPlatform(),n)},clone:function(){return this.getFactory().archiveMap(this.getVault(),this)},buildObject:function(t){return this.getFactory().archive(this.getVault(),t)}})}(window),function(t){const n=t.Gitana;n.Vault=n.AbstractPlatformDataStore.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.Vault"}},getType:function(){return n.TypedIDConstants.TYPE_VAULT},getUri:function(){return"/vaults/"+this.getId()},clone:function(){return this.getFactory().vault(this.getPlatform(),this)},listArchives:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().archiveMap(this);return this.chainGet(i,this.getUri()+"/archives",e)},readArchive:function(t){const n=this.getFactory().archive(this);return this.chainGet(n,this.getUri()+"/archives/"+t)},lookupArchive:function(t,n,e){const i=this.getFactory().archive(this);return this.chainGet(i,this.getUri()+"/archives/lookup?group="+t+"&artifact="+n+"&version="+e)},queryArchives:function(t,e){const i=this,o={};e&&n.copyInto(o,e);const s=this.getFactory().archiveMap(this);return this.chainPost(s,function(){return i.getUri()+"/archives/query"},o,t)},checkArchivePermissions:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/archives/permissions/check"},{},i).then(function(t){n.call(this,t.results)})},checkArchiveAuthorities:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/archives/authorities/check"},{},i).then(function(t){n.call(this,t.results)})}})}(window),function(t){const n=t.Gitana;n.VaultMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.VaultMap"},this.base(t,n)},clone:function(){return this.getFactory().vaultMap(this.getPlatform(),this)},buildObject:function(t){return this.getFactory().vault(this.getPlatform(),t)}})}(window),function(t){const n=t.Gitana;n.AbstractWebHostObject=n.AbstractPlatformObject.extend({constructor:function(t,n){this.base(t.getPlatform(),n),this.getWebHost=function(){return t},this.getWebHostId=function(){return t.getId()}},ref:function(){return this.getType()+"://"+this.getPlatformId()+"/"+this.getWebHostId()+"/"+this.getId()}})}(window),function(t){const n=t.Gitana;n.AutoClientMapping=n.AbstractWebHostObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.AutoClientMapping"}},clone:function(){return this.getFactory().autoClientMapping(this.getWebHost(),this)},getType:function(){return n.TypedIDConstants.TYPE_AUTO_CLIENT_MAPPING},getUri:function(){return"/webhosts/"+this.getWebHostId()+"/autoclientmappings/"+this.getId()},getSourceUri:function(){return this.get("uri")},getTargetApplicationId:function(){return this.get("applicationId")},getTargetApplicationKey:function(){return this.get("applicationKey")},getTargetClientKey:function(){return this.get("clientKey")},getTargetTenantId:function(){return this.get("tenantId")},getAutoManage:function(){return this.get("automanage")}})}(window),function(t){const n=t.Gitana;n.AutoClientMappingMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.AutoClientMappingMap"},this.getWebHost=function(){return t},this.getWebHostId=function(){return t.getId()},this.base(t.getPlatform(),n)},clone:function(){return this.getFactory().autoClientMappingMap(this.getWebHost(),this)},buildObject:function(t){return this.getFactory().autoClientMapping(this.getWebHost(),t)}})}(window),function(t){const n=t.Gitana;n.DeployedApplication=n.AbstractWebHostObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.DeployedApplication"}},clone:function(){return this.getFactory().deployedApplication(this.getWebHost(),this)},getType:function(){return n.TypedIDConstants.TYPE_DEPLOYED_APPLICATION},getUri:function(){return"/webhosts/"+this.getWebHostId()+"/applications/"+this.getId()},undeploy:function(){return this.chainPostEmpty(this.getWebHost(),function(){return this.getUri()+"/undeploy"})},redeploy:function(){return this.chainPostEmpty(this.getWebHost(),function(){return this.getUri()+"/redeploy"})},start:function(){return this.chainPostEmpty(this.getWebHost(),function(){return this.getUri()+"/start"})},stop:function(){return this.chainPostEmpty(this.getWebHost(),function(){return this.getUri()+"/stop"})},restart:function(){return this.chainPostEmpty(this.getWebHost(),function(){return this.getUri()+"/restart"})}})}(window),function(t){const n=t.Gitana;n.DeployedApplicationMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.DeployedApplicationMap"},this.getWebHost=function(){return t},this.getWebHostId=function(){return t.getId()},this.base(t.getPlatform(),n)},clone:function(){return this.getFactory().deployedApplicationMap(this.getWebHost(),this)},buildObject:function(t){return this.getFactory().deployedApplication(this.getWebHost(),t)}})}(window),function(t){const n=t.Gitana;n.TrustedDomainMapping=n.AbstractWebHostObject.extend({constructor:function(t,n){this.base(t,n),this.objectType=function(){return"Gitana.TrustedDomainMapping"}},clone:function(){return this.getFactory().trustedDomainMapping(this.getWebHost(),this)},getType:function(){return n.TypedIDConstants.TYPE_TRUSTED_DOMAIN_MAPPING},getUri:function(){return"/webhosts/"+this.getWebHostId()+"/trusteddomainmappings/"+this.getId()}})}(window),function(t){const n=t.Gitana;n.TrustedDomainMappingMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.TrustedDomainMappingMap"},this.getWebHost=function(){return t},this.getWebHostId=function(){return t.getId()},this.base(t.getPlatform(),n)},clone:function(){return this.getFactory().trustedDomainMappingMap(this.getWebHost(),this)},buildObject:function(t){return this.getFactory().trustedDomainMapping(this.getWebHost(),t)}})}(window),function(t){const n=t.Gitana;n.WebHost=n.AbstractPlatformDataStore.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.WebHost"},this.base(t,n)},getUri:function(){return"/webhosts/"+this.getId()},getType:function(){return n.TypedIDConstants.TYPE_WEB_HOST},clone:function(){return this.getFactory().webhost(this.getPlatform(),this)},getUrlPatterns:function(){return this.get("urlPatterns")},createAutoClientMapping:function(t,e,i,o,s){s||(s={}),n.isString(e)||(e=e.getId()),n.isString(i)||(i=i.getKey()),n.isString(o)||(o=o.getKey()),s.host=t,s.applicationId=e,s.clientKey=i,s.authGrantKey=o;const r=this.getFactory().autoClientMapping(this);return this.chainCreate(r,s,function(){return"/webhosts/"+this.getId()+"/autoclientmappings"})},listAutoClientMappings:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().autoClientMappingMap(this);return this.chainGet(i,function(){return"/webhosts/"+this.getId()+"/autoclientmappings"},e)},readAutoClientMapping:function(t){const n=this,e=this.getFactory().autoClientMapping(this);return this.chainGet(e,function(){return n.getUri()+"/autoclientmappings/"+t})},queryAutoClientMappings:function(t,e){const i=this,o={};e&&n.copyInto(o,e);const s=this.getFactory().autoClientMappingMap(this);return this.chainPost(s,function(){return i.getUri()+"/autoclientmappings/query"},o,t)},checkAutoClientMappingsPermissions:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/autoclientmappings/permissions/check"},{},i).then(function(t){n.call(this,t.results)})},checkAutoClientMappingsAuthorities:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/autoclientmappings/authorities/check"},{},i).then(function(t){n.call(this,t.results)})},createTrustedDomainMapping:function(t,e,i,o){o||(o={}),n.isString(i)||(i=i.getId()),o.host=t,o.scope=e,o.platformId=i;const s=this.getFactory().trustedDomainMapping(this);return this.chainCreate(s,o,function(){return"/webhosts/"+this.getId()+"/trusteddomainmappings"})},listTrustedDomainMappings:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().trustedDomainMappingMap(this);return this.chainGet(i,function(){return"/webhosts/"+this.getId()+"/trusteddomainmappings"},e)},readTrustedDomainMapping:function(t){const n=this,e=this.getFactory().trustedDomainMapping(this);return this.chainGet(e,function(){return n.getUri()+"/trusteddomainmappings/"+t})},queryTrustedDomainMappings:function(t,e){const i=this,o={};e&&n.copyInto(o,e);const s=this.getFactory().trustedDomainMappingMap(this);return this.chainPost(s,function(){return i.getUri()+"/trusteddomainmappings/query"},o,t)},checkTrustedDomainMappingsPermissions:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/trusteddomainmappings/permissions/check"},{},i).then(function(t){n.call(this,t.results)})},checkTrustedDomainMappingsAuthorities:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/trusteddomainmappings/authorities/check"},{},i).then(function(t){n.call(this,t.results)})},listDeployedApplications:function(t){const e={};t&&n.copyInto(e,t);const i=this.getFactory().deployedApplicationMap(this);return this.chainGet(i,function(){return"/webhosts/"+this.getId()+"/applications"},e)},readDeployedApplication:function(t){const n=this.getFactory().deployedApplication(this);return this.chainGet(n,function(){return"/webhosts/"+this.getId()+"/applications/"+t})},queryDeployedApplications:function(t,e){const i=this,o={};e&&n.copyInto(o,e);const s=this.getFactory().deployedApplicationMap(this);return this.chainPost(s,function(){return i.getUri()+"/applications/query"},o,t)},checkDeployedApplicationsPermissions:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/applications/permissions/check"},{},i).then(function(t){n.call(this,t.results)})},checkDeployedApplicationsAuthorities:function(t,n){const e=this,i={checks:t};return this.chainPostResponse(this,function(){return e.getUri()+"/applications/authorities/check"},{},i).then(function(t){n.call(this,t.results)})}})}(window),function(t){const n=t.Gitana;n.WebHostMap=n.AbstractPlatformObjectMap.extend({constructor:function(t,n){this.objectType=function(){return"Gitana.WebHostMap"},this.base(t,n)},clone:function(){return this.getFactory().webhostMap(this.getPlatform(),this)},buildObject:function(t){return this.getFactory().webhost(this.getPlatform(),t)}})}(window),function(t){Gitana.WorkQueue=function(n){n||(n=3);let e=!1;const i=[];let o=0;const s=function(){if(e)return;e=!0;let r=!0;do{if(0===i.length&&(r=!1),o>=n&&(r=!1),r){o++;const n=function(n){return function(){n(function(){o--,t.setTimeout(s)})}}(i.splice(0,1)[0]);t.setTimeout(n)}}while(r);e=!1};return function(n){i.push(n),t.setTimeout(s)}}}(window),function(t){const n={},e={};Gitana.MemoryXHRCache=function(t){return function(i,o){let s=i.method+"/"+i.url;if(i.headers)for(const t in i.headers)s+="/"+t+"="+i.headers[t];const r=(new Date).getTime();return o&&(n[s]=o,e[s]=r+t),o=n[s],(!e[s]||e[s]<r)&&(delete n[s],delete e[s],o=null),o}}}(window);